<!DOCTYPE html><html class=split lang=ja><meta charset=utf-8><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name=viewport><title>HTML Standard 日本語訳</title><meta content=#3c790a name=theme-color><link rel=stylesheet href=https://resources.whatwg.org/standard.css>
<script defer="" src=https://resources.whatwg.org/dfn.js></script>
<script data-file-issue-url=https://github.com/momdo/momdo.github.io/issues/new defer="" src=https://resources.whatwg.org/file-issue.js></script>
<script>
   function F( /* varargs... */) {
     var fragment = document.createDocumentFragment();
     for (var index = 0; index < arguments.length; index += 1) {
       if (arguments[index] instanceof Array) {
         fragment.appendChild(F.apply(this, arguments[index]));
       } else if (typeof arguments[index] == 'string') {
         fragment.appendChild(document.createTextNode(arguments[index]));
       } else {
         fragment.appendChild(arguments[index]);
       }
     }
     return fragment;
   }
   function E(name, /* optional */ attributes /*, varargs... */) {
     var element = document.createElement(name);
     var index = 1;
     if ((arguments.length > 1) && (typeof attributes != 'string') &&
         (!(attributes instanceof Node)) && (!(attributes instanceof Array))) {
       for (var attName in attributes) {
         if (typeof attributes[attName] == 'boolean') {
           if (attributes[attName])
             element.setAttribute(attName, '');
         } else if (typeof attributes[attName] == 'function') {
           element[attName] = attributes[attName];
         } else {
           element.setAttribute(attName, attributes[attName]);
         }
       }
       index = 2;
     }
     for (; index < arguments.length; index += 1) {
       if (arguments[index] instanceof Array) {
         element.appendChild(F.apply(this, arguments[index]));
       } else if (typeof arguments[index] == 'string') {
         element.appendChild(document.createTextNode(arguments[index]));
       } else {
         element.appendChild(arguments[index]);
       }
     }
     return element;
   }
   var currentAlert;
   var currentAlertTimeout;
   function showAlert(s, href) {
     if (!currentAlert) {
       currentAlert = document.createElement('div');
       currentAlert.id = 'alert';
       var x = document.createElement('button');
       x.textContent = '\u2573';
       x.onclick = closeAlert2;
       currentAlert.appendChild(x);
       currentAlert.appendChild(document.createElement('span'));
       currentAlert.onmousemove = function () {
         clearTimeout(currentAlertTimeout);
         currentAlert.className = '';
         currentAlertTimeout = setTimeout(closeAlert, 10000);
       }
       document.body.appendChild(currentAlert);
     } else {
       clearTimeout(currentAlertTimeout);
       currentAlert.className = '';
     }
     currentAlert.lastChild.textContent = '';
     currentAlert.lastChild.appendChild(F(s));
     if (href) {
       var link = document.createElement('a');
       link.href = href;
       link.textContent = href;
       currentAlert.lastChild.appendChild(F(' ', link));
     }
     currentAlertTimeout = setTimeout(closeAlert, 10000);
   }
   function closeAlert() {
     clearTimeout(currentAlertTimeout);
     if (currentAlert) {
       currentAlert.className = 'closed';
       currentAlertTimeout = setTimeout(closeAlert2, 3000);
     }
   }
   function closeAlert2() {
     clearTimeout(currentAlertTimeout);
     if (currentAlert) {
       currentAlert.parentNode.removeChild(currentAlert);
       currentAlert = null;
     }
   }
   window.addEventListener('keydown', function (event) {
     if (event.keyCode == 27) {
       if (currentAlert)
         closeAlert2();
     } else {
       closeAlert();
     }
   }, false);
   window.addEventListener('scroll', function (event) {
     closeAlert();
   }, false);

   var startedInit = 0;
   function init() {
     startedInit = 1;
   }
   if (document.documentElement.className == "")
     setTimeout(function () {
       if (!startedInit)
         showAlert("Too slow? Try reading the multipage copy of the spec instead:", "https://whatwg.org/html");
     }, 6000);

   window.addEventListener('keypress', function (event) {
     if ((event.which == 114) && (event.metaKey)) {
       if (!confirm('Are you sure you want to reload this page?'))
         event.preventDefault();
     }
   }, false);
  </script>
<script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
  </script><link rel=icon href=https://resources.whatwg.org/logo.svg>
<style>
   [hidden] { display: none; }

   .bad, .bad *:not(.X\58X) { color: gray; border-color: gray; background: transparent; }

   #alert { position: fixed; top: 20%; left: 20%; right: 20%; font-size: 2em; padding: 0.5em; z-index: 40; background: gray; background: rgba(32,32,32,0.9); color: white; border-radius: 0.5em; transition: opacity 1s linear; }
   #alert.closed { opacity: 0; }
   #alert button { position: absolute; top: -1em; right: 2em; border-radius: 0.5em 0.5em 0 0; border: none; line-height: 0.9; color: white; background: rgb(64,64,64); font-size: 0.6em; font-weight: 900; cursor: pointer; padding: 0.25em; }
   #alert :link, #alert :visited { color: white; text-decoration: underline; }
   #alert :link:hover, #alert :visited:hover { background: transparent; }

   @media print { #configUI, #alert { display: none; } }

   .fingerprint { position: absolute; right: 0; z-index: 5; }
   @media (max-width: 767px) {
     .fingerprint { max-width: 35px; }
   }

   .status { font: 1em sans-serif; width: 9em; padding: 0.3em; position: absolute; z-index: 8; top: auto; right: 0.3em; background: #EEE; color: black; box-shadow: 0 0 3px #999; overflow: hidden; margin: -2em 0 0 0; border-collapse: initial; border-spacing: initial; }
   .status.wrapped { width: 1em; height: 1em; }
   .status.wrapped > :not(input) { display: none; }
   .status > input { position: absolute; right: 0; top: 0; width: 1em; height: 1em; border: none; background: transparent; padding: 0; margin: 0; }
   .status > p { font-size: 0.6em; margin: 0; padding: 0; }
   .status > p + p { padding-top: 0.5em; }
   .status > .support { display: block; }
   .status > .support > span { padding: 0.2em 0; display: block; display: table; }
   .status > .support > span.partial { color: #666666; filter: grayscale(50%); }
   .status > .support > span.no { color: #CCCCCC; filter: grayscale(100%); }
   .status > .support > span:first-of-type { padding-top: 0.5em; }
   .status > .support > span > span { padding: 0 0.5em; display: table-cell; vertical-align: top; }
   .status > .support > span > span:first-child { width: 100%; }
   .status > .support > span > span:last-child { width: 100%; white-space: pre; padding: 0; }
   .status > .support > span::before { content: ' '; display: table-cell; min-width: 1.5em; height: 1.5em; background: no-repeat center center; background-size: contain; text-align: right; font-size: 0.75em; font-weight: bold; }
   .status > .support > .and_chr::before { background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg); }
   .status > .support > .and_ff::before { background-image: url(https://resources.whatwg.org/browser-logos/firefox.png); }
   .status > .support > .and_uc::before { background-image: url(https://resources.whatwg.org/browser-logos/uc.png); } /* UC Browser for Android */
   .status > .support > .android::before { background-image: url(https://resources.whatwg.org/browser-logos/android.svg); }
   .status > .support > .bb::before { background-image: url(https://resources.whatwg.org/browser-logos/bb.jpg); } /* Blackberry Browser */
   .status > .support > .chrome::before { background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg); }
   .status > .support > .edge::before { background-image: url(https://resources.whatwg.org/browser-logos/edge.svg); }
   .status > .support > .firefox::before { background-image: url(https://resources.whatwg.org/browser-logos/firefox.png); }
   .status > .support > .ie::before { background-image: url(https://resources.whatwg.org/browser-logos/ie.png); }
   .status > .support > .ie_mob::before { background-image: url(https://resources.whatwg.org/browser-logos/ie-mobile.svg); }
   .status > .support > .ios_saf::before { background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg); }
   .status > .support > .op_mini::before { background-image: url(https://resources.whatwg.org/browser-logos/opera-mini.png); }
   .status > .support > .op_mob::before { background-image: url(https://resources.whatwg.org/browser-logos/opera.png); }
   .status > .support > .opera::before { background-image: url(https://resources.whatwg.org/browser-logos/opera.png); }
   .status > .support > .safari::before { background-image: url(https://resources.whatwg.org/browser-logos/safari.png); }
   .status > .caniuse { text-align: right; font-style: italic; }

   @media (max-width: 767px) {
     .status.wrapped { width: 9em; height: auto; }
     .status:not(.wrapped) { width: 1em; height: 1em; }
     .status.wrapped > :not(input) { display: block; }
     .status:not(.wrapped) > :not(input) { display: none; }
   }

   .applies .yes, .yesno .yes { background: yellow; }
   .yesno .yes, .yesno .no { text-align: center; }
  </style>
<style>
   .applies thead th > * { display: block; }
   .applies thead code { display: block; }
   .applies td { text-align: center; }

   .matrix, .matrix td { border: hidden; text-align: right; }
   .matrix { margin-left: 2em; }

   .vertical-summary-table tr > th[rowspan="2"]:first-child + th,
   .vertical-summary-table tr > td[rowspan="2"]:first-child + td { border-bottom: hidden; }

   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   td.eg { border-width: thin; text-align: center; }

   #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
   #table-example-1 caption { padding-bottom: 0.5em; }
   #table-example-1 thead, #table-example-1 tbody { border: none; }
   #table-example-1 th, #table-example-1 td { border: solid thin; }
   #table-example-1 th { font-weight: normal; }
   #table-example-1 td { border-style: none solid; vertical-align: top; }
   #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
   #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
   #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
   #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
   #table-example-1 tbody td:first-child::after { content: leader(". "); }
   #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
   #table-example-1 tbody td:first-child + td { width: 10em; }
   #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
   #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

   .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
   .apple-table-examples * { font-family: "Times", serif; }
   .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
   .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
   .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
   .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
   .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
   .apple-table-examples td { text-align: right; vertical-align: top; }
   .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
   .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
   .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
   .apple-table-examples sup { line-height: 0; }

   .three-column-nowrap tr > td:first-child,
   .three-column-nowrap tr > td:first-child + td,
   .three-column-nowrap tr > td:first-child + td + td { white-space: nowrap; }

   .details-example img { vertical-align: top; }

   #base64-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 6em;
     column-count: 5;
     column-gap: 1em;
     -moz-column-width: 6em;
     -moz-column-count: 5;
     -moz-column-gap: 1em;
     -webkit-column-width: 6em;
     -webkit-column-count: 5;
     -webkit-column-gap: 1em;
   }
   #base64-table thead { display: none; }
   #base64-table * { border: none; }
   #base64-table tbody td:first-child:after { content: ':'; }
   #base64-table tbody td:last-child { text-align: right; }

   #named-character-references-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 30em;
     column-gap: 1em;
     -moz-column-width: 30em;
     -moz-column-gap: 1em;
     -webkit-column-width: 30em;
     -webkit-column-gap: 1em;
   }
   #named-character-references-table > table > tbody > tr > td:first-child + td,
   #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
   #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
   #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

   .glyph.control { color: red; }
  </style>
<style>
   #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
   @font-face {
     font-family: 'Essays1743';
     src: url('/fonts/Essays1743.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-weight: bold;
     src: url('/fonts/Essays1743-Bold.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     src: url('/fonts/Essays1743-Italic.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     font-weight: bold;
     src: url('/fonts/Essays1743-BoldItalic.ttf');
   }
  </style>
<script src=link-fixup.js></script>
<body onload=init()>
  <header id=head class="head with-buttons">
   <p><a href=https://whatwg.org/ class=logo><img alt=WHATWG src=https://resources.whatwg.org/logo.svg width=100 height=100></a></p>
   <hgroup><h1 class=allcaps>HTML</h1><h2 id=living-standard class="no-num no-toc">Living Standard — Last Updated <span class=pubdate>16 July 2016</span></h2></hgroup>
   
   
  </header>

  

  

  
  

  
  

  

  <nav><a href=microdata.html>← 5 Microdata</a> — <a href=index.html>目次</a> — <a href=browsers.html>7 ウェブページの読み込み →</a></nav><ol class=toc><li id=toc-editing><a href=interaction.html#editing>6 ユーザーとの対話処理</a><ol><li><a href=interaction.html#the-hidden-attribute>6.1 <code>hidden</code>属性</a></li><li><a href=interaction.html#inert-subtrees>6.2 不活性サブツリー</a></li><li><a href=interaction.html#activation>6.3 アクティベーション</a></li><li><a href=interaction.html#focus>6.4 フォーカス</a><ol><li><a href=interaction.html#introduction-7>6.4.1 導入</a></li><li><a href=interaction.html#data-model>6.4.2 データモデル</a></li><li><a href=interaction.html#the-tabindex-attribute>6.4.3 <code>tabindex</code>属性</a></li><li><a href=interaction.html#focus-processing-model>6.4.4 処理モデル</a></li><li><a href=interaction.html#sequential-focus-navigation>6.4.5 シーケンシャルフォーカスナビゲーション</a></li><li><a href=interaction.html#focus-management-apis>6.4.6 フォーカス管理API</a></li></ol></li><li><a href=interaction.html#assigning-keyboard-shortcuts>6.5 キーボードショートカットの割り当て</a><ol><li><a href=interaction.html#introduction-8>6.5.1 導入</a></li><li><a href=interaction.html#the-accesskey-attribute>6.5.2 <code>accesskey</code>属性</a></li><li><a href=interaction.html#keyboard-shortcuts-processing-model>6.5.3 処理モデル</a></li></ol></li><li><a href=interaction.html#editing-2>6.6 編集</a><ol><li><a href=interaction.html#contenteditable>6.6.1 編集可能な文書領域を作成する：<code>contenteditable</code>コンテンツ属性</a></li><li><a href=interaction.html#making-entire-documents-editable:-the-designmode-idl-attribute>6.6.2 文書全体を編集可能にする：<code>designMode</code> IDL属性</a></li><li><a href=interaction.html#best-practices-for-in-page-editors>6.6.3 ページ内編集者のためのベストプラクティス</a></li><li><a href=interaction.html#editing-apis>6.6.4 編集API</a></li><li><a href=interaction.html#spelling-and-grammar-checking>6.6.5 スペルと文法チェック</a></li></ol></li><li><a href=interaction.html#dnd>6.7 ドラッグアンドドロップ</a><ol><li><a href=interaction.html#event-drag>6.7.1 導入</a></li><li><a href=interaction.html#the-drag-data-store>6.7.2 ドラッグデータストア</a></li><li><a href=interaction.html#the-datatransfer-interface>6.7.3 <code>DataTransfer</code>インターフェイス</a><ol><li><a href=interaction.html#the-datatransferitemlist-interface>6.7.3.1 <code>DataTransferItemList</code>インターフェイス</a></li><li><a href=interaction.html#the-datatransferitem-interface>6.7.3.2 <code>DataTransferItem</code>インターフェイス</a></li></ol></li><li><a href=interaction.html#the-dragevent-interface>6.7.4 <code>DragEvent</code>インターフェイス</a></li><li><a href=interaction.html#drag-and-drop-processing-model>6.7.5 処理モデル</a></li><li><a href=interaction.html#dndevents>6.7.6 イベントの概要</a></li><li><a href=interaction.html#the-draggable-attribute>6.7.7 <code>draggable</code>属性</a></li><li><a href=interaction.html#the-dropzone-attribute>6.7.8 <code>dropzone</code>属性</a></li><li><a href=interaction.html#security-risks-in-the-drag-and-drop-model>6.7.9 Security risks in the drag-and-drop model</a></li></ol></li></ol></li></ol><h2 id=editing>6 <dfn>ユーザーとの対話処理</dfn></h2>


  <h3 id=the-hidden-attribute>6.1 <dfn><code>hidden</code></dfn>属性</h3><div class=status><input onclick=toggleStatus(this) value=⋰ type=button><p class=support><strong>Support:</strong> <span class="chrome yes"><span>Chrome</span> <span>6+</span></span><span class="and_chr yes"><span>Chrome for Android</span> <span>51+</span></span><span class="ios_saf yes"><span>iOS Safari</span> <span>5.0-5.1+</span></span><span class="and_uc yes"><span>UC Browser for Android</span> <span>9.9+</span></span><span class="firefox yes"><span>Firefox</span> <span>4+</span></span><span class="ie yes"><span>IE</span> <span>11+</span></span><span class="op_mini yes"><span>Opera Mini</span> <span>all+</span></span><span class="samsung yes"><span>Samsung Internet</span> <span>4+</span></span><span class="android yes"><span>Android Browser</span> <span>4+</span></span><span class="safari yes"><span>Safari</span> <span>5.1+</span></span><span class="edge yes"><span>Edge</span> <span>12+</span></span><span class="opera yes"><span>Opera</span> <span>11.1+</span></span><p class=caniuse>Source: <a href="http://caniuse.com/#feat=hidden">caniuse.com</a></div>

  <p>すべての<a id=the-hidden-attribute:html-elements href=infrastructure.html#html-elements>HTML要素</a>は<code id=the-hidden-attribute:the-hidden-attribute><a href=#the-hidden-attribute>hidden</a></code>コンテンツ属性設定を持ってもよい。<code id=the-hidden-attribute:the-hidden-attribute-2><a href=#the-hidden-attribute>hidden</a></code>属性は<a id=the-hidden-attribute:boolean-attribute href=infrastructure.html#boolean-attribute>真偽属性</a>である。要素で指定される場合、それは、要素がまだないこと、またはもはやページの現在の状態には直接関係がない、または、ユーザーが直接アクセスするのとは対照的に、ページの他の部分で再利用するコンテンツを宣言するために使用されていることを示す。ユーザーエージェントは、<code id=the-hidden-attribute:the-hidden-attribute-3><a href=#the-hidden-attribute>hidden</a></code>が指定された属性を持つ要素をレンダリングすべきでない。この要件は、スタイルレイヤーを通して間接的に実装されてもよい。たとえば、HTML+CSSユーザーエージェントは、<a href=rendering.html#hiddenCSS>レンダリングの節で提案される規則を使用して</a>この要件を実装することができる。</p>

  <p class=note>この属性は通常CSSを使用して実装されているため、CSSを使用して上書きすることもできる。たとえば、'display: block'をすべての要素に適用する規則は、<code id=the-hidden-attribute:the-hidden-attribute-4><a href=#the-hidden-attribute>hidden</a></code>属性の影響を相殺するだろう。したがって著者は、期待通りに属性がスタイル付けされていることを確認し、そのスタイルシートを書く際に注意する必要がある。</p>

  <div class=example>

   <p>以下の骨格の例において、属性は、ユーザーがログインするまでウェブゲームのメイン画面を非表示にするために使用される：</p>

   <pre>  &lt;h1&gt;The Example Game&lt;/h1&gt;
  &lt;section id="login"&gt;
   &lt;h2&gt;Login&lt;/h2&gt;
   &lt;form&gt;
    ...
    &lt;!-- calls login() once the user's credentials have been checked --&gt;
   &lt;/form&gt;
   &lt;script&gt;
    function login() {
      // switch screens
      document.getElementById('login').hidden = true;
      document.getElementById('game').hidden = false;
    }
   &lt;/script&gt;
  &lt;/section&gt;
  &lt;section id="game" hidden&gt;
   ...
  &lt;/section&gt;</pre>

  </div>

  <p><code id=the-hidden-attribute:the-hidden-attribute-5><a href=#the-hidden-attribute>hidden</a></code>属性は、別のプレゼンテーションに合法的に示すことができたコンテンツを隠すために使用されてはならない。たとえば、タブ付きインターフェイスは単にオーバーフロープレゼンテーションの一種であるため、タブ付きダイアログでパネルを隠すために<code id=the-hidden-attribute:the-hidden-attribute-6><a href=#the-hidden-attribute>hidden</a></code>を使用することは誤りである。―それはスクロールバーをもつ1つの大きなページ内のすべてのフォームコントロールを示すのと同様である。ちょうど1つのプレゼンテーションからコンテンツを非表示にするためにこの属性を使用することも同様に誤りである。―何かが<code id=the-hidden-attribute:the-hidden-attribute-7><a href=#the-hidden-attribute>hidden</a></code>とマークされる場合、それは、たとえばスクリーンリーダーなどを含む、すべてのプレゼンテーションから隠されている。</p>

  
  

  <p>自身が<code id=the-hidden-attribute:the-hidden-attribute-8><a href=#the-hidden-attribute>hidden</a></code>でない要素は、<code id=the-hidden-attribute:the-hidden-attribute-9><a href=#the-hidden-attribute>hidden</a></code>である要素へ<a id=the-hidden-attribute:hyperlink href=semantics.html#hyperlink>ハイパーリンク</a>されてはならない。自身が<code id=the-hidden-attribute:the-hidden-attribute-10><a href=#the-hidden-attribute>hidden</a></code>でない<code id=the-hidden-attribute:the-label-element><a href=forms.html#the-label-element>label</a></code>および<code id=the-hidden-attribute:the-output-element><a href=forms.html#the-output-element>output</a></code>要素の<code>for</code>属性も同様に、<code id=the-hidden-attribute:the-hidden-attribute-11><a href=#the-hidden-attribute>hidden</a></code>である要素を参照してはならない。どちらの場合も、このような参照はユーザーの混乱を引き起こすだろう。</p>

  <p>しかし、要素およびスクリプトは、他のコンテキストで<code id=the-hidden-attribute:the-hidden-attribute-12><a href=#the-hidden-attribute>hidden</a></code>である要素を参照してもよい。</p>

  <div class=example>

   <p>たとえば、<code id=the-hidden-attribute:the-hidden-attribute-13><a href=#the-hidden-attribute>hidden</a></code>属性でマークされたセクションにリンクする<code id=the-hidden-attribute:attr-hyperlink-href><a href=semantics.html#attr-hyperlink-href>href</a></code>属性を使用するのは誤りだろう。コンテンツが適切または関連しない場合、それにリンクする理由はない。</p>

   <p>しかし、自身が<code id=the-hidden-attribute:the-hidden-attribute-14><a href=#the-hidden-attribute>hidden</a></code>である説明を参照するために、ARIA <code id=the-hidden-attribute:attr-aria-describedby><a data-x-internal=attr-aria-describedby href=http://momdo.github.io/wai-aria-1.1/#aria-describedby>aria-describedby</a></code>属性を使用することは構わない。説明を非表示にすることはそれらが単独で有用でないことを意味する一方で、それらは、それらが説明する画像から参照される特定のコンテキストにおいて有用である方法で記述することもできる。</p>

   <p>同様に、<code id=the-hidden-attribute:the-hidden-attribute-15><a href=#the-hidden-attribute>hidden</a></code>属性を持つ<code id=the-hidden-attribute:the-canvas-element><a href=scripting.html#the-canvas-element>canvas</a></code>要素は、オフスクリーンバッファとしてスクリプト化されたグラフィックスエンジンによって使用されるかもしれず、フォームコントロールは、<code id=the-hidden-attribute:attr-fae-form><a href=forms.html#attr-fae-form>form</a></code>属性を使用する隠し<code id=the-hidden-attribute:the-form-element><a href=forms.html#the-form-element>form</a></code>要素を参照するかもしれない。</p>

  </div>

  <p><code id=the-hidden-attribute:the-hidden-attribute-16><a href=#the-hidden-attribute>hidden</a></code>属性によって非表示にされたセクション内の要素は依然としてアクティブである。たとえば、そのようなセクションでのスクリプトやフォームコントロールは、依然として実行および送信する。それらのプレゼンテーションのみがユーザーに変更される。</p>

  

  <p><dfn id=dom-hidden><code>hidden</code></dfn> IDL属性は、同じ名前のコンテンツ属性を<a id=the-hidden-attribute:reflect href=infrastructure.html#reflect>反映</a>しなければならない。</p>

  



  <h3 id=inert-subtrees>6.2 不活性サブツリー</h3>

  <p class=note>この節は、"inert"という名前のいかなるコンテンツ属性を定義または作成<strong>しない</strong>。この節は、単に<a href=#inert id=inert-subtrees:inert>不活性</a>の抽象的な<em>概念</em>を定義する。</p>

  <p>（特に要素やテキストノード）あるノードは<dfn id=inert>不活性</dfn>としてマークすることができる。ノードが<a href=#inert id=inert-subtrees:inert-2>不活性</a>であるとき、あたかもノードがユーザーインタラクションイベントを対象する目的のために不在であるかのように、ユーザーエージェントは動作しなければならず、テキスト検索ユーザーインターフェイス（一般に"ページ内検索"として知られる）の目的に対してノードを無視してもよく、そのノード内のテキストの選択からユーザーを防いでもよい。しかし、ユーザーエージェントは、ユーザーが検索とテキスト選択に制限を上書きできるようにすべきである。</p>

  <p class=example>たとえば、<code id=inert-subtrees:the-body-element><a href=semantics.html#the-body-element>body</a></code>の中央に位置する単一の<a href=#inert id=inert-subtrees:inert-3>不活性</a>段落からなるページを考えてみる。ユーザーが<code id=inert-subtrees:the-body-element-2><a href=semantics.html#the-body-element>body</a></code>上から<a href=#inert id=inert-subtrees:inert-4>不活性</a>段落へポインティングデバイスを移動させ、段落上をクリックする場合、<code id=inert-subtrees:event-mouseover><a data-x-internal=event-mouseover href=https://w3c.github.io/uievents/#event-type-mouseover>mouseover</a></code>イベントは発火せず、<code id=inert-subtrees:event-mousemove><a data-x-internal=event-mousemove href=https://w3c.github.io/uievents/#event-type-mousemove>mousemove</a></code>および<code id=inert-subtrees:event-click><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code>イベントは段落よりむしろ<code id=inert-subtrees:the-body-element-3><a href=semantics.html#the-body-element>body</a></code>要素で発火するだろう。</p>

  <p class=note>ノードが不活性である場合、ノードは一般にフォーカスできない。<a href=forms.html#concept-command id=inert-subtrees:concept-command>コマンド</a>である不活性ノードはまた、無効であるだろう。</p>

  <p><a id=inert-subtrees:browsing-context-container href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>が<a href=#inert id=inert-subtrees:inert-5>不活性</a>としてマークされる間に、その<a id=inert-subtrees:nested-browsing-context href=browsers.html#nested-browsing-context>ネストされたブラウジングコンテキスト</a>の<a id=inert-subtrees:active-document href=browsers.html#active-document>アクティブ文書</a>、およびその<code id=inert-subtrees:document><a href=dom.html#document>Document</a></code>におけるすべてのノードは、<a href=#inert id=inert-subtrees:inert-6>不活性</a>としてマークされなければならない。</p>

  <p><code id=inert-subtrees:document-2><a href=dom.html#document>Document</a></code>全体は、<dfn id=blocked-by-a-modal-dialog>モーダルダイアログダイアログによってブロックされる</dfn><var>subject</var>としてマークすることができる。<code id=inert-subtrees:document-3><a href=dom.html#document>Document</a></code>がそのようにマークされている一方で、<var>subject</var>要素およびその子孫を除いて、<a href=https://triple-underscore.github.io/DOM4-ja.html#in-a-document id=inert-subtrees:in-a-document data-x-internal=in-a-document><code>Document</code>内の</a>すべてのノードは、<a href=#inert id=inert-subtrees:inert-7>不活性</a>とマークされなければならない。（この段落で除外される要素は、さらに他の手段を介して<a href=#inert id=inert-subtrees:inert-8>不活性</a>にマークすることができる。モーダルダイアログの一部であることは<a href=#inert id=inert-subtrees:inert-9>不活性</a>とマークされることからノードを"守る"ことはない。）</p>

  <p>一度に1つのみ要素が<a href=#blocked-by-a-modal-dialog id=inert-subtrees:blocked-by-a-modal-dialog>モーダルダイアログによってブロック</a>されているとして<code id=inert-subtrees:document-4><a href=dom.html#document>Document</a></code>をマークすることができる。新しい<code id=inert-subtrees:the-dialog-element><a href=forms.html#the-dialog-element>dialog</a></code>が<code id=inert-subtrees:document-5><a href=dom.html#document>Document</a></code>を<a href=#blocked-by-a-modal-dialog id=inert-subtrees:blocked-by-a-modal-dialog-2>ブロック</a>するために作成された場合、前の要素がもしあれば、<code id=inert-subtrees:document-6><a href=dom.html#document>Document</a></code>のブロックを中止する。</p>

  <p class=note><code id=inert-subtrees:the-dialog-element-2><a href=forms.html#the-dialog-element>dialog</a></code>要素の<code id=inert-subtrees:dom-dialog-showmodal><a href=forms.html#dom-dialog-showmodal>showModal()</a></code>メソッドは、このメカニズムを利用する。</p>




  <h3 id=activation>6.3 アクティベーション</h3>

  <p>HTMLの特定の要素は、ユーザーがアクティブにすることができることを意味する、<a href=#activation-behaviour id=activation:activation-behaviour>アクティベーション動作</a>を持つ。下記で説明するように、これは、アクティベーション機構に依存するイベントのシーケンスを引き起こし、通常<code id=activation:event-click><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code>イベントで完了させる。</p>

  

  <p>The user agent should allow the user to manually trigger elements that have an <a href=#activation-behaviour id=activation:activation-behaviour-2>activation
  behaviour</a>, for instance using keyboard or voice input, or through mouse clicks. When the
  user triggers an element with a defined <a href=#activation-behaviour id=activation:activation-behaviour-3>activation behaviour</a> in a manner other than
  clicking it, the default action of the interaction event must be to <a href=#run-synthetic-click-activation-steps id=activation:run-synthetic-click-activation-steps>run synthetic click
  activation steps</a> on the element.</p> 

  <p>Each element has a <var>click in progress</var> flag, initially set to false.</p>

  <p>When a user agent is to <dfn id=run-synthetic-click-activation-steps>run synthetic click activation steps</dfn> on an element, the user
  agent must run the following steps:</p>

  <ol><li><p>If the element's <var>click in progress</var> flag is set to true, then abort
   these steps.</li><li><p>Set the <var>click in progress</var> flag on the element to true.</li><li><p><a href=#run-pre-click-activation-steps id=activation:run-pre-click-activation-steps>Run pre-click activation steps</a> on the element.</li><li><p><a id=activation:fire-a-click-event href=webappapis.html#fire-a-click-event>Fire a <code>click</code> event</a> at the element. If the
   <a href=#run-synthetic-click-activation-steps id=activation:run-synthetic-click-activation-steps-2>run synthetic click activation steps</a> algorithm was invoked because the <code id=activation:dom-click><a href=#dom-click>click()</a></code> method was invoked, then the <code id=activation:dom-event-istrusted><a data-x-internal=dom-event-istrusted href=https://triple-underscore.github.io/DOM4-ja.html#dom-event-istrusted>isTrusted</a></code> attribute must be initialised to false.</li><li>

    <p>If this <code id=activation:event-click-2><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code> event is not canceled, <a href=#run-post-click-activation-steps id=activation:run-post-click-activation-steps>run post-click
    activation steps</a> on the element.</p>

    <p>If the event <em>is</em> canceled, the user agent must <a href=#run-canceled-activation-steps id=activation:run-canceled-activation-steps>run canceled activation
    steps</a> on the element instead.</p>

   </li><li><p>Set the <var>click in progress</var> flag on the element to false.</li></ol>

  <p>When a pointing device is clicked, the user agent must <a href=#run-authentic-click-activation-steps id=activation:run-authentic-click-activation-steps>run authentic click activation
  steps</a> instead of firing the <code id=activation:event-click-3><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code>
  event. When a user agent is to
  <dfn id=run-authentic-click-activation-steps>run authentic click activation steps</dfn> for a given event <var>event</var>, it must
  follow these steps:</p>

  <ol><li><p>Let <var>target</var> be the element designated by the user (the target of <var>event</var>).</li><li><p>If <var>target</var> is a <code id=activation:the-canvas-element><a href=scripting.html#the-canvas-element>canvas</a></code> element, run the <a id=activation:canvas-mouseevent-rerouting-steps href=scripting.html#canvas-mouseevent-rerouting-steps>canvas
   <code>MouseEvent</code> rerouting steps</a>. If this changes <var>event</var>'s
   target, then let <var>target</var> be the new target.</li><li><p>Set the <var>click in progress</var> flag on <var>target</var> to
   true.</li><li><p>Let <var>e</var> be the <a href=#nearest-activatable-element id=activation:nearest-activatable-element>nearest activatable element</a> of <var>target</var> (defined below), if any.</li><li><p>If there is an element <var>e</var>, <a href=#run-pre-click-activation-steps id=activation:run-pre-click-activation-steps-2>run pre-click activation steps</a>
   on it.</li><li>

    <p><a href=infrastructure.html#concept-event-dispatch id=activation:concept-event-dispatch>Dispatch</a> <var>event</var> (the
    required <code id=activation:event-click-4><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code> event) at <var>target</var>.</p> 

    <p>If there is an element <var>e</var> and the <code id=activation:event-click-5><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code>
    event is not canceled, <a href=#run-post-click-activation-steps id=activation:run-post-click-activation-steps-2>run post-click activation steps</a> on element <var>e</var>.</p>

    <p>If there is an element <var>e</var> and the event <em>is</em> canceled, <a href=#run-canceled-activation-steps id=activation:run-canceled-activation-steps-2>run
    canceled activation steps</a> on element <var>e</var>.</p>

   </li><li><p>Set the <var>click in progress</var> flag on <var>target</var> to
   false.</li></ol>

  <p class=note>The algorithms above don't run for arbitrary synthetic events dispatched by author
  script. The <code id=activation:dom-click-2><a href=#dom-click>click()</a></code> method can be used to make the <a href=#run-synthetic-click-activation-steps id=activation:run-synthetic-click-activation-steps-3>run
  synthetic click activation steps</a> algorithm happen programmatically.</p>

  <p class=note>Click-focusing behaviour (e.g. the focusing of a text field when user clicks in
  one) typically happens before the click, when the mouse button is first depressed, and is
  therefore not discussed here.</p> 

  <p>Given an element <var>target</var>, the <dfn id=nearest-activatable-element>nearest activatable element</dfn> is the
  element returned by the following algorithm:</p>

  <ol><li><p>If <var>target</var> has a defined <a href=#activation-behaviour id=activation:activation-behaviour-4>activation behaviour</a>, then return
   <var>target</var> and abort these steps.</li><li><p>If <var>target</var> has a parent element, then set <var>target</var> to
   that parent element and return to the first step.</li><li><p>Otherwise, there is no <a href=#nearest-activatable-element id=activation:nearest-activatable-element-2>nearest activatable element</a>.</li></ol>

  <p>When a user agent is to <dfn id=run-pre-click-activation-steps>run pre-click activation steps</dfn> on an element, it must run
  the <dfn id=pre-click-activation-steps>pre-click activation steps</dfn> defined for that element, if any.</p>

  <p>When a user agent is to <dfn id=run-canceled-activation-steps>run canceled activation steps</dfn> on an element, it must run the
  <dfn id=canceled-activation-steps>canceled activation steps</dfn> defined for that element, if any.</p>

  <p>When a user agent is to <dfn id=run-post-click-activation-steps>run post-click activation steps</dfn> on an element, it must run
  the <dfn id=activation-behaviour>activation behaviour</dfn> defined for that element, if any. Activation behaviours can
  refer to the <code id=activation:event-click-6><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code> event that was fired by the steps above
  leading up to this point.</p>

  <p id=allowed-to-show-a-popup>An algorithm is <dfn id=triggered-by-user-activation>triggered by user activation</dfn> if any of
  the following conditions is true:</p>

  <ul><li><p>The <a href=webappapis.html#concept-task id=activation:concept-task>task</a> in which the algorithm is running is currently
   processing an <a href=#activation-behaviour id=activation:activation-behaviour-5>activation behaviour</a> whose <code id=activation:event-click-7><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code>
   event was <a href=infrastructure.html#concept-events-trusted id=activation:concept-events-trusted>trusted</a>.</li><li>
    <p>The <a href=webappapis.html#concept-task id=activation:concept-task-2>task</a> in which the algorithm is running is currently
    running the event listener for a <a href=infrastructure.html#concept-events-trusted id=activation:concept-events-trusted-2>trusted</a> event
    whose type is in the following list:</p>

    <ul class=brief><li><code id=activation:event-change><a href=indices.html#event-change>change</a></code></li><li><code id=activation:event-click-8><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code></li><li><code id=activation:event-dblclick><a data-x-internal=event-dblclick href=https://w3c.github.io/uievents/#event-type-dblclick>dblclick</a></code></li><li><code id=activation:event-mouseup><a data-x-internal=event-mouseup href=https://w3c.github.io/uievents/#event-type-mouseup>mouseup</a></code></li><li><code id=activation:event-reset><a href=indices.html#event-reset>reset</a></code></li><li><code id=activation:event-submit><a href=indices.html#event-submit>submit</a></code></li></ul>

   </li><li>
    <p>The <a href=webappapis.html#concept-task id=activation:concept-task-3>task</a> in which the algorithm is running was <a href=webappapis.html#queue-a-task id=activation:queue-a-task>queued</a> by an algorithm that was <a href=#triggered-by-user-activation id=activation:triggered-by-user-activation>triggered by user
    activation</a>, and the chain of such algorithms started within a user-agent defined
    timeframe.</p>

    <p class=example>For example, if a user clicked a button, it might be acceptable for a popup
    to result from that after 4 seconds, but it would likely not be acceptable for a popup to result
    from that after 4 hours.</p>
   </li></ul>

  



  

  <dl class=domintro><dt><var>element</var> . <code id=activation:dom-click-3><a href=#dom-click>click</a></code>()<dd>

    <p>あたかも要素をクリックされたかのように動作する。</p>

   </dl>

  

  <p>The <dfn id=dom-click><code>click()</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the element is a form control that is <a href=forms.html#concept-fe-disabled id=activation:concept-fe-disabled>disabled</a>, abort these steps.</li><li><p><a href=#run-synthetic-click-activation-steps id=activation:run-synthetic-click-activation-steps-4>Run synthetic click activation steps</a> on the element.</li></ol>

  




  <h3 id=focus>6.4 フォーカス</h3>

  
  
  
  

  

  <h4 id=introduction-7>6.4.1 導入</h4>

  <p><i>この節は非規範的である。</i></p>

  <p>HTMLユーザーインターフェイスは典型的に、フォームコントロール、スクロール可能領域、リンク、ダイアログボックス、ブラウザータブなど、複数のインタラクティブウィジットから成る。これらウィジェットは、他（たとえば、リンク、フォームコントロール）を含むもの（たとえば、ブラウザータブ、ダイアログボックス）をもつ、階層構造を形成する。</p>

  <p>キーボードを使用するインターフェイスと情報交換する場合、アクティブなウィジェットから、<a href=#focused id=introduction-7:focused>フォーカスされる</a>と呼ばれる、インタラクティブなウィジェットの階層構造を通して、キー入力はシステムから流れる。</p>

  <div class=example>

   <p>グラフィカル環境で動作するブラウザータブにおいて動作するHTMLアプリケーションを考えてみる。このアプリケーションが、いくつかのテキストフィールドおよびリンクをもつページを持ち、それ自身がテキストフィールドとボタンを持った、モーダルダイアログを表示していると想定する。</p>

   <p>このシナリオにおいて、その子の間でHTMLアプリケーションを含むブラウザータブを持つだろう、フォーカス可能なウィジェットの階層構造は、ブラウザーウィンドウを含むかもしれない。タブ自身は、ダイアログと同様に、その子として、様々なリンクおよびテキストフィールドを持つだろう。ダイアログ自身は、その子として、テキストフィールドおよびボタンを持つだろう。</p>

   <p><img width=800 src=https://html.spec.whatwg.org/multipage/images/focus-tree.png height=450 alt=""> 

   <p>この例で<span>フォーカス</span>をもつウィジェットがダイアログボックスでテキストフィールドであった場合、キー入力は、グラフィカルシステムから①ウェブブラウザー、②タブ、③ダイアログ、そして最後に④テキストフィールドへ流される。</p>

  </div>

  <p>キーボード<em>イベント</em>は、常にこの<a href=#focused id=introduction-7:focused-2>フォーカスされた</a>要素で対象にされる。</p>


  <h4 id=data-model>6.4.2 データモデル</h4>

  <p>用語<dfn id=focusable-area>フォーカス可能領域</dfn>は、キーボード入力の対象になることができるインターフェイスの領域を参照するために使用される。フォーカス可能領域は、要素、要素の一部、またはユーザーエージェントによって処理される他の領域となることができる。</p>

  <p>各<a href=#focusable-area id=data-model:focusable-area>フォーカス可能領域</a>は、DOMで<a href=#focusable-area id=data-model:focusable-area-2>フォーカス可能領域</a>の位置を表す<code id=data-model:node><a data-x-internal=node href=https://triple-underscore.github.io/DOM4-ja.html#interface-node>Node</a></code>オブジェクトである、<dfn id=dom-anchor>DOMアンカー</dfn>を持つ。（<a href=#focusable-area id=data-model:focusable-area-3>フォーカス可能領域</a>が<code id=data-model:node-2><a data-x-internal=node href=https://triple-underscore.github.io/DOM4-ja.html#interface-node>Node</a></code>自身である場合、それはそれ自身の<a href=#dom-anchor id=data-model:dom-anchor>DOM anchor</a>である。）<a href=#focusable-area id=data-model:focusable-area-5>フォーカス可能領域</a>を表すために他のDOMオブジェクトが存在しない場合、<a href=#dom-anchor id=data-model:dom-anchor-2>DOMアンカー</a>は、<a href=#focusable-area id=data-model:focusable-area-4>フォーカス可能領域</a>に適するようないくつかのAPIで使用される。</p>

  <p>以下のテーブルは、どのオブジェクトが<a href=#focusable-area id=data-model:focusable-area-6>フォーカス可能領域</a>となることができるかを説明する。左の列におけるセルは、<a href=#focusable-area id=data-model:focusable-area-7>フォーカス可能領域</a>となることができるオブジェクトを説明する。右の列におけるセルは、この要素に対する<a href=#dom-anchor id=data-model:dom-anchor-3>DOMアンカー</a>を説明する。（両方の列をまたぐセルは、非規範的な例である。）</p>

  <table id=table-fa><thead><tr><th id=th-fa-area><a href=#focusable-area id=data-model:focusable-area-8>フォーカス可能領域</a>
     </th><th id=th-fa-dom-rep><a href=#dom-anchor id=data-model:dom-anchor-4>DOMアンカー</a>
    </th></tr><tr><th colspan=2 id=th-fa-examples> 例

   <tbody></th></tr><tr><th headers=th-fa-area id=td-fa-1 class=data-header>
     <a href=scripting.html#concept-element-disabled id=data-model:concept-element-disabled>実際に無効</a>でない、<a href=#expressly-inert-control id=data-model:expressly-inert-control>明確に不活性</a>でない、および<a id=data-model:being-rendered href=rendering.html#being-rendered>描画されている</a>または<a id=data-model:being-used-as-relevant-canvas-fallback-content href=scripting.html#being-used-as-relevant-canvas-fallback-content>関連するキャンバスフォールバックコンテンツとして使用されている</a>かのいずれかである、その<a href=#specially-focusable id=data-model:specially-focusable>タブインデックスフォーカスフラグ</a>設定を持つ要素 
     <td headers="td-fa-1 th-fa-dom-rep">
     要素自身。
    </td></th></tr><tr><td colspan=2 headers="td-fa-1 th-fa-examples">
     <p class=example><code id=data-model:the-iframe-element><a href=embedded-content.html#the-iframe-element>iframe</a></code>、<code id="data-model:text-(type=text)-state-and-search-state-(type=search)"><a href="forms.html#text-(type=text)-state-and-search-state-(type=search)">&lt;input type=text&gt;</a></code>、時に<code id=data-model:the-a-element><a href=semantics.html#the-a-element>&lt;a href=""&gt;</a></code> （プラットフォーム慣習に依存する）。

   <tbody></td></tr><tr><th headers=th-fa-area id=td-fa-2 class=data-header>
     <a id=data-model:being-rendered-2 href=rendering.html#being-rendered>描画されている</a>および<a href=#expressly-inert-control id=data-model:expressly-inert-control-2>明示的に不活性</a>でない<code id=data-model:the-img-element><a href=embedded-content.html#the-img-element>img</a></code>要素に関連する<a id=data-model:image-map href=embedded-content.html#image-map>イメージマップ</a>における<code id=data-model:the-area-element><a href=embedded-content.html#the-area-element>area</a></code>要素の形状。
     <td headers="td-fa-2 th-fa-dom-rep">
     <code id=data-model:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code>要素
    </td></th></tr><tr><td colspan=2 headers="td-fa-2 th-fa-examples">
     <div class=example>
      <p>次の例において、それぞれ画像の、<code id=data-model:the-area-element-2><a href=embedded-content.html#the-area-element>area</a></code>要素は2つの形状を作成する。最初の形状の<a href=#dom-anchor id=data-model:dom-anchor-5>DOMアンカー</a>は、最初の<code id=data-model:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code>要素であり、2つめの形状の<a href=#dom-anchor id=data-model:dom-anchor-6>DOM anchor</a>は、2つめの<code id=data-model:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code>要素である。</p>
      <pre>&lt;map id=wallmap&gt;&lt;area alt="Enter Door" coords="10,10,100,200" href="door.html"&gt;&lt;/map&gt;
...
&lt;img src="images/innerwall.jpeg" alt="There is a white wall here, with a door." usemap="#wallmap"&gt;
...
&lt;img src="images/outerwall.jpeg" alt="There is a red wall here, with a door." usemap="#wallmap"&gt;</pre>
     </div>

   <tbody></td></tr><tr><th headers=th-fa-area id=td-fa-3 class=data-header>
     要素のサブウィジェットを提供されるユーザーエージェントは、<a id=data-model:being-rendered-3 href=rendering.html#being-rendered>描画されている</a>かつ<a href=scripting.html#concept-element-disabled id=data-model:concept-element-disabled-2>実際に無効</a>または<a href=#expressly-inert-control id=data-model:expressly-inert-control-3>明確に不活性</a>でない。
     <td headers="td-fa-3 th-fa-dom-rep">
     <a href=#focusable-area id=data-model:focusable-area-9>フォーカス可能領域</a>がサブウィジェットとなる要素。
    </td></th></tr><tr><td colspan=2 headers="td-fa-3 th-fa-examples">
     <p class=example><code id=data-model:the-video-element><a href=embedded-content.html#the-video-element>video</a></code>要素に対する<a href=embedded-content.html#expose-a-user-interface-to-the-user id=data-model:expose-a-user-interface-to-the-user>ユーザーに公開されるユーザーインターフェイスにおけるコントロール</a>、<code id="data-model:number-state-(type=number)"><a href="forms.html#number-state-(type=number)">&lt;input type=number&gt;</a></code>のスピンコントロールバージョンにおけるアップ・ダウンボタン、<code id="data-model:range-state-(type=range)"><a href="forms.html#range-state-(type=range)">&lt;input type=range multiple&gt;</a></code>における2つの範囲コントロールウィジェット、キーボード入力を用いた開くまたは閉じるために要素を有効にした<code id=data-model:the-details-element><a href=forms.html#the-details-element>details</a></code>要素のレンダリングの一部。</p>

   <tbody></td></tr><tr><th headers=th-fa-area id=td-fa-4 class=data-header>
     <a id=data-model:being-rendered-4 href=rendering.html#being-rendered>レンダリングされている</a>かつ<a href=#expressly-inert-control id=data-model:expressly-inert-control-4>明確に不活性</a>でない要素のスクロール可能な領域。 
     <td headers="td-fa-4 th-fa-dom-rep">
     スクロール可能な領域のスクロールが作成されたボックスに対する要素
    </td></th></tr><tr><td colspan=2 headers="td-fa-4 th-fa-examples">
     <p class=example>The CSS <a id="data-model:'overflow'" href=https://drafts.csswg.org/css-overflow/#propdef-overflow data-x-internal="'overflow'">'overflow'</a> property's 'scroll' value typically creates
     a scrollable region.</p>

   <tbody></td></tr><tr><th headers=th-fa-area id=td-fa-5 class=data-header>
     <a href=browsers.html#concept-document-bc id=data-model:concept-document-bc>ブラウジングコンテキスト</a>を持ちかつ<a href=#inert id=data-model:inert>不活性</a>でない<code id=data-model:document><a href=dom.html#document>Document</a></code>の<a id=data-model:viewport href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>ビューポート</a>。
     <td headers="td-fa-5 th-fa-dom-rep">
     <a id=data-model:viewport-2 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>ビューポート</a>が作成された<code id=data-model:document-2><a href=dom.html#document>Document</a></code>。
    </td></th></tr><tr><td colspan=2 headers="td-fa-5 th-fa-examples">
     <p class=example><code id=data-model:the-iframe-element-2><a href=embedded-content.html#the-iframe-element>iframe</a></code>のコンテンツ。</p>

   <tbody></td></tr><tr><th headers=th-fa-area id=td-fa-6 class=data-header>
     特にアクセシビリティーを支援する、またはよりプラットフォーム慣習にマッチする、任意の他の要素または要素の一部。
     <td headers="td-fa-6 th-fa-dom-rep">
     要素。
    </td></th></tr><tr><td colspan=2 headers="td-fa-6 th-fa-examples">
     <p class=example>ユーザーエージェントがリスト項目弾丸をフォーカス可能にすることができ、その結果ユーザーはより簡単にリストをそうさすることができる。</p>
     <p class=example>同様に、ユーザーエージェントが<code id=data-model:attr-title><a href=dom.html#attr-title>title</a></code>属性をもつすべての要素をフォーカス可能にすることができ、その結果要素の助言情報はアクセスされることができる。</p>

  </td></tr></table>

  <p id=bc-focus-ergo-bcc-focus class=note><a id=data-model:browsing-context-container href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>（たとえば<code id=data-model:the-iframe-element-3><a href=embedded-content.html#the-iframe-element>iframe</a></code>）は、<a href=#focusable-area id=data-model:focusable-area-10>フォーカス可能領域</a>であるが、<a id=data-model:browsing-context-container-2 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>に送られるキーイベントは、<a id=data-model:nested-browsing-context href=browsers.html#nested-browsing-context>ネストされたブラウジングコンテキスト</a>の<a id=data-model:active-document href=browsers.html#active-document>アクティブ文書</a>に送られる。同様に、逐次的フォーカスナビゲーションにおいて<a id=data-model:browsing-context-container-3 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>は本質的にその<a id=data-model:nested-browsing-context-2 href=browsers.html#nested-browsing-context>ネストされるブラウジングコンテキスト</a>の<a id=data-model:active-document-2 href=browsers.html#active-document>アクティブ文書</a>に対するプレースホルダーとして単に動作する。</p>

  <hr>

  <p>次は<dfn id=control-group>コントロールグループ</dfn>を作成する：

  <ul class=brief><li><a href=browsers.html#concept-document-bc id=data-model:concept-document-bc-2>ブラウジングコンテキスト</a>を持つ<code id=data-model:document-3><a href=dom.html#document>Document</a></code>オブジェクト。</li><li>指定された<code id=data-model:attr-dialog-open><a href=forms.html#attr-dialog-open>open</a></code>属性を持ちかつ<a id=data-model:being-rendered-5 href=rendering.html#being-rendered>描画されている</a><code id=data-model:the-dialog-element><a href=forms.html#the-dialog-element>dialog</a></code>要素</li></ul>

  <p>対応する<code id=data-model:document-4><a href=dom.html#document>Document</a></code>オブジェクトまたは<code id=data-model:the-dialog-element-2><a href=forms.html#the-dialog-element>dialog</a></code>要素が作成した<a href=#control-group id=data-model:control-group>コントロールグループ</a>の<dfn id=control-group-owner-object>所有者オブジェクト</dfn>である。（<a href=#control-group-owner-object id=data-model:control-group-owner-object>コントロールグループ所有者オブジェクト<a href=#control-group-owner-object id=data-model:control-group-owner-object>と<a href=#control-group id=data-model:control-group-2>コントロールグループ<a href=#control-group id=data-model:control-group-2>のマッピングは常に1:1がある。）</p>

  <p>各<a href=#focusable-area id=data-model:focusable-area-11>フォーカス可能領域</a>は、次のとおり<a href=#control-group id=data-model:control-group-3>コントロールグループ</a>に属する。<a href=#focusable-area id=data-model:focusable-area-12>フォーカス可能領域</a>の<a href=#dom-anchor id=data-model:dom-anchor-7>DOMアンカー</a>が<a href=#control-group-owner-object id=data-model:control-group-owner-object-2>コントロールグループ所有者オブジェクト</a>である場合、その<a href=#focusable-area id=data-model:focusable-area-13>フォーカス可能領域</a>は、その<a href=#control-group-owner-object id=data-model:control-group-owner-object-3>コントロールグループ所有者オブジェクト</a>の<a href=#control-group id=data-model:control-group-4>コントロールグループ</a>に所属する。そうでなければ、<a href=#focusable-area id=data-model:focusable-area-14>フォーカス可能領域</a>は、その<a href=#dom-anchor id=data-model:dom-anchor-8>DOMアンカー</a>の最も近い祖先<a href=#control-group-owner-object id=data-model:control-group-owner-object-4>コントロールグループ所有者オブジェクト</a>の<a href=#control-group id=data-model:control-group-5>コントロールグループ</a>に所属する。</p>

  <div class=example>

   <p>このように、<a id=data-model:viewport-3 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>ビューポート</a>は常に<a id=data-model:viewport-4 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>ビューポート</a>が作成された<code id=data-model:document-5><a href=dom.html#document>Document</a></code>の<a href=#control-group id=data-model:control-group-6>コントロールグループ</a>に属し、<code id=data-model:the-input-element><a href=forms.html#the-input-element>input</a></code>コントロールはその最も近い祖先<code id=data-model:the-dialog-element-3><a href=forms.html#the-dialog-element>dialog</a></code>または<code id=data-model:document-6><a href=dom.html#document>Document</a></code>の<a href=#control-group id=data-model:control-group-7>コントロールグループ</a>に属し、イメージマップの形状は<code id=data-model:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code>要素（<code id=data-model:the-area-element-3><a href=embedded-content.html#the-area-element>area</a></code>要素でない―これは1つの<code id=data-model:the-area-element-4><a href=embedded-content.html#the-area-element>area</a></code>要素が異なる<a href=#control-group id=data-model:control-group-8>コントロールグループ</a>で複数の形状を作るかもしれないことを意味する）の最も近い祖先<code id=data-model:the-dialog-element-4><a href=forms.html#the-dialog-element>dialog</a></code>または<code id=data-model:document-7><a href=dom.html#document>Document</a></code>に属する。</p>

  </div>

  <p class=note><a href=#focusable-area id=data-model:focusable-area-15>フォーカス可能領域</a>がないようにするために、<a href=#control-group id=data-model:control-group-9>コントロールグループ</a>が空にすることは可能である。</p>

  <p>要素は、要素が<a href=#inert id=data-model:inert-2>不活性</a>だが、要素が<a href=#control-group-owner-object id=data-model:control-group-owner-object-5>コントロールグループ所有者オブジェクト</a>でなく、かつ要素の最も近い祖先<a href=#control-group-owner-object id=data-model:control-group-owner-object-6>コントロールグループ所有者オブジェクト</a>が<a href=#inert id=data-model:inert-3>不活性</a>でない場合、<dfn id=expressly-inert-control>明示的に不活性</dfn>である。</p>

  <p>各空でない<a href=#control-group id=data-model:control-group-10>コントロールグループ</a>における1つの<a href=#focusable-area id=data-model:focusable-area-16>フォーカス可能領域</a>は、<dfn id=focused-area-of-the-control-group>コントロールグループの被フォーカス可能領域</dfn>と呼ばれる。どのコントロールがそのように呼ばれるかは時間とともに変化し、この仕様におけるアルゴリズムに基づく。<a href=#control-group id=data-model:control-group-11>コントロールグループ</a>が空である場合、コントロールグループは<a href=#focused-area-of-the-control-group id=data-model:focused-area-of-the-control-group>被フォーカス領域</a>を持たない。</p>

  <p>各<a href=#control-group-owner-object id=data-model:control-group-owner-object-7>コントロールグループ所有者オブジェクト</a>はまた、<dfn id=dialog-group>ダイアロググループ</dfn>の<dfn id=dialog-group-manager>管理者</dfn>として動作することができる。</p>

  <p><code id=data-model:attr-dialog-open-2><a href=forms.html#attr-dialog-open>open</a></code>属性を指定されかつ<a id=data-model:being-rendered-6 href=rendering.html#being-rendered>レンダリングされている</a>（すなわち、<a href=#control-group-owner-object id=data-model:control-group-owner-object-8>コントロールグループ所有者オブジェクト</a>である）かつ<a href=#expressly-inert-dialog id=data-model:expressly-inert-dialog>明示的に不活性</a>でない各<code id=data-model:the-dialog-element-5><a href=forms.html#the-dialog-element>dialog</a></code>要素は、<a href=#dialog-group-manager id=data-model:dialog-group-manager>管理者</a>が<code id=data-model:the-dialog-element-6><a href=forms.html#the-dialog-element>dialog</a></code>要素の最も近い祖先<a href=#control-group-owner-object id=data-model:control-group-owner-object-9>コントロールグループ所有者オブジェクト</a>である<a href=#dialog-group id=data-model:dialog-group>ダイアロググループ</a>に属する。</p>

  <p><code id=data-model:the-dialog-element-7><a href=forms.html#the-dialog-element>dialog</a></code>は、それが<a href=#inert id=data-model:inert-4>不活性</a>だがその最も近い祖先<a href=#control-group-owner-object id=data-model:control-group-owner-object-10>コントロールグループ所有者オブジェクト</a>が不活性でない場合、<dfn id=expressly-inert-dialog>明示的に不活性</dfn>である。</p>

  <p>その最も近い祖先<a href=#control-group-owner-object id=data-model:control-group-owner-object-12>コントロールグループ所有者オブジェクト</a>として<code id=data-model:the-dialog-element-8><a href=forms.html#the-dialog-element>dialog</a></code>要素が特定の<a href=#control-group-owner-object id=data-model:control-group-owner-object-11>コントロールグループ所有者オブジェクト</a>を持たない場合、その<a href=#control-group-owner-object id=data-model:control-group-owner-object-13>コントロールグループ所有者オブジェクト</a>は一切の<a href=#dialog-group id=data-model:dialog-group-2>ダイアロググループ</a>を持たない。</p>

  <p>各<a href=#dialog-group id=data-model:dialog-group-3>ダイアロググループ</a>は、<dfn id=focused-dialog-of-the-dialog-group>ダイアロググループのフォーカスされたダイアログ</dfn>と呼ばれる<code id=data-model:the-dialog-element-9><a href=forms.html#the-dialog-element>dialog</a></code>を持つことができる。どの<code id=data-model:the-dialog-element-10><a href=forms.html#the-dialog-element>dialog</a></code>がそのように呼ばれるかは時間とともに変化し、この仕様におけるアルゴリズムに基づく。</p>

  <hr>

  <p><a href=#control-group id=data-model:control-group-12>コントロールグループ</a>における<a href=#focusable-area id=data-model:focusable-area-17>フォーカス可能領域</a>は、その領域の<a href=#dom-anchor id=data-model:dom-anchor-9>DOMアンカー</a>の<a id=data-model:tree-order href=https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order data-x-internal=tree-order>ツリー順</a>に関連して並べられる。<a href=#control-group id=data-model:control-group-13>コントロールグループ</a>で同じ<a href=#dom-anchor id=data-model:dom-anchor-10>DOMアンカー</a>をもつ<a href=#focusable-area id=data-model:focusable-area-18>フォーカス可能領域</a>は、ボックスツリーの深さ優先走査でそのCSSボックスの関連する位置に関連して並べられる。<a href=references.html#refsCSS>[CSS]</a></p>

  <p><a href=#dialog-group id=data-model:dialog-group-4>ダイアロググループ</a>における要素は、<a id=data-model:tree-order-2 href=https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order data-x-internal=tree-order>ツリー順</a>で並べられる。</p>

  <hr>

  <p>特定の時間で<dfn id=currently-focused-area-of-a-top-level-browsing-context>トップレベルブラウジングコンテキストの現在の被フォーカス領域</dfn>は、<a href=#focusable-area id=data-model:focusable-area-19>フォーカス可能領域</a>またはこのアルゴリズムによって返される<code id=data-model:the-dialog-element-11><a href=forms.html#the-dialog-element>dialog</a></code>である。</p>

  <ol><li><p><var>candidate</var>を<a id=data-model:top-level-browsing-context href=browsers.html#top-level-browsing-context>トップレベルブラウジングコンテキスト</a>の <code id=data-model:document-8><a href=dom.html#document>Document</a></code>にする。</li><li>

    <p><var>candidate</var>が指定された<a href=#focused-dialog-of-the-dialog-group id=data-model:focused-dialog-of-the-dialog-group>ダイアロググループの被フォーカスダイアログ</a>をともなう<a href=#dialog-group id=data-model:dialog-group-5>ダイアロググループ</a>を持つ場合、<var>candidate</var>を指定された<a href=#focused-dialog-of-the-dialog-group id=data-model:focused-dialog-of-the-dialog-group-2>ダイアロググループの被フォーカスダイアログ</a>にし、このステップを再実行する。</p>

    <p>そうでなければ、<var>candidate</var>が空でない<a href=#control-group id=data-model:control-group-14>コントロールグループ</a>を持ち、かつ指定された<a href=#focused-area-of-the-control-group id=data-model:focused-area-of-the-control-group-2>コントロールグループの被フォーカス領域</a>が<a id=data-model:browsing-context-container-4 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>である場合、<var>candidate</var>をその<a id=data-model:browsing-context-container-5 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>の<a id=data-model:nested-browsing-context-3 href=browsers.html#nested-browsing-context>ネストされるブラウジングコンテキスト</a>の<a id=data-model:active-document-3 href=browsers.html#active-document>アクティブ文書</a>にし、このステップを再実行する。</p>

    <p>そうでなければ、<var>candidate</var>が空でない<a href=#control-group id=data-model:control-group-15>コントロールグループ</a>を持つ場合、<var>candidate</var>を指定された<a href=#focused-area-of-the-control-group id=data-model:focused-area-of-the-control-group-3>コントロールグループの被フォーカス領域</a>にする。</p>

   </li><li><p><var>candidate</var>を返す。</li></ol>

  <p><a href=#focusable-area id=data-model:focusable-area-20>フォーカス可能領域</a>の<a href=#dom-anchor id=data-model:dom-anchor-11>DOMアンカー</a>である要素は、<a href=#focusable-area id=data-model:focusable-area-21>フォーカス可能領域</a>が<a href=#currently-focused-area-of-a-top-level-browsing-context id=data-model:currently-focused-area-of-a-top-level-browsing-context>トップレベルブラウジングコンテキストの被フォーカス領域</a>になる場合に<dfn id=gains-focus>利得フォーカス</dfn>と呼ばれる。要素が<a href=#currently-focused-area-of-a-top-level-browsing-context id=data-model:currently-focused-area-of-a-top-level-browsing-context-2>トップレベルブラウジングコンテキストの現在の被フォーカス領域</a>に属する<a href=#focusable-area id=data-model:focusable-area-22>フォーカス可能領域</a>の<a href=#dom-anchor id=data-model:dom-anchor-12>DOMアンカー</a>である場合、要素は<dfn id=focused>被フォーカス</dfn>である。</p>

  

  <p>The <dfn id=focus-chain>focus chain</dfn> of a <a href=#focusable-area id=data-model:focusable-area-23>focusable area</a> or <a href=#control-group-owner-object id=data-model:control-group-owner-object-14>control group owner
  object</a> <var>subject</var> is the ordered list constructed as follows:</p>

  <ol><li><p>Let <var>current object</var> be <var>subject</var>.</li><li><p>Let <var>output</var> be an empty list.</li><li><p><i>Loop</i>: Append <var>current object</var> to <var>output</var>.</li><li>

    <p>If <var>current object</var> is an <code id=data-model:the-area-element-5><a href=embedded-content.html#the-area-element>area</a></code> element's shape, append
    that <code id=data-model:the-area-element-6><a href=embedded-content.html#the-area-element>area</a></code> element to <var>output</var>.</p>

    <p>Otherwise, if <var>current object</var> is a <a href=#focusable-area id=data-model:focusable-area-24>focusable area</a> whose <a href=#dom-anchor id=data-model:dom-anchor-13>DOM
    anchor</a> is an element that is not <var>current object</var> itself, append that
    <a href=#dom-anchor id=data-model:dom-anchor-14>DOM anchor</a> element to <var>output</var>.</p>

   </li><li>

    <p>If <var>current object</var> is a <code id=data-model:the-dialog-element-12><a href=forms.html#the-dialog-element>dialog</a></code> object in a <a href=#dialog-group id=data-model:dialog-group-6>dialog group</a>,
    let <var>current object</var> be that <a href=#dialog-group id=data-model:dialog-group-7>dialog group</a>'s <a href=#dialog-group-manager id=data-model:dialog-group-manager-2>manager</a>, and return to the step labeled <i>loop</i>.</p>

    <p>Otherwise, if <var>current object</var> is a <a href=#focusable-area id=data-model:focusable-area-25>focusable area</a>, let <var>current
    object</var> be that <a href=#focusable-area id=data-model:focusable-area-26>focusable area</a>'s <a href=#control-group id=data-model:control-group-16>control group</a>'s <a href=#control-group-owner-object id=data-model:control-group-owner-object-15>owner object</a>, and return to the step labeled
    <i>loop</i>.</p>

    <p>Otherwise, if <var>current object</var> is a <code id=data-model:document-9><a href=dom.html#document>Document</a></code> in a <a id=data-model:nested-browsing-context-4 href=browsers.html#nested-browsing-context>nested browsing
    context</a>, let <var>current object</var> be its <a id=data-model:browsing-context-container-6 href=browsers.html#browsing-context-container>browsing context container</a>,
    and return to the step labeled <i>loop</i>.</p>

   </li><li>

    <p>Return <var>output</var>.</p>

    <p class=note>The chain starts with <var>subject</var> and (if <var>subject</var> is or can be the <a href=#currently-focused-area-of-a-top-level-browsing-context id=data-model:currently-focused-area-of-a-top-level-browsing-context-3>currently focused area of a top-level browsing
    context</a>) continues up the focus hierarchy up to the <code id=data-model:document-10><a href=dom.html#document>Document</a></code> of the
    <a id=data-model:top-level-browsing-context-2 href=browsers.html#top-level-browsing-context>top-level browsing context</a>.</p>

   </li></ol>

  


  <h4 id=the-tabindex-attribute>6.4.3 <code id=the-tabindex-attribute:attr-tabindex><a href=#attr-tabindex>tabindex</a></code>属性</h4>

  <p><dfn id=attr-tabindex><code>tabindex</code></dfn>コンテンツ属性は、著者が、要素が<a href=#focusable-area id=the-tabindex-attribute:focusable-area>フォーカスできる</a>ことを仮定するかどうか、それが順次フォーカスナビゲーションを使用して到達することを仮定するかどうか、何が<a href=#sequential-focus-navigation id=the-tabindex-attribute:sequential-focus-navigation>シーケンシャルフォーカスナビゲーション</a>のための要素の相対的な順序になるかを指示できる。名前"tab index"は、フォーカス可能な要素を通してナビゲートする"tab"キーの一般的な使用方法から来ている。用語"tabbing"は、順次フォーカスナビゲーションを使用して到達することができるフォーカス可能な要素を前方に移動することを指す。</p>

  <p>属性が省略される場合、ユーザーエージェントはデフォルトを適用する。（<a id=the-tabindex-attribute:being-rendered href=rendering.html#being-rendered>描画されている</a>要素を<a href=scripting.html#concept-element-disabled id=the-tabindex-attribute:concept-element-disabled>利用不能にする</a>ことなしにまたは<a href=#inert id=the-tabindex-attribute:inert>不活性に</a>することなしにフォーカス可能にさせる方法は存在しない。）</p>

  <p><code id=the-tabindex-attribute:attr-tabindex-2><a href=#attr-tabindex>tabindex</a></code>属性が指定される場合、<a id=the-tabindex-attribute:valid-integer href=infrastructure.html#valid-integer>妥当な整数</a>である値を持たなければならない。正の数は<a href=#sequential-focus-navigation-order id=the-tabindex-attribute:sequential-focus-navigation-order>シーケンシャルフォーカスナビゲーション順</a>で要素の<a href=#focusable-area id=the-tabindex-attribute:focusable-area-2>フォーカス可能領域</a>の関連位置を指定し、負の数は<a href=#sequential-focus-navigation id=the-tabindex-attribute:sequential-focus-navigation-2>シーケンシャルフォーカスナビゲーショ</a>によって到達不能となるコントロールを示す。</p>

  <p>0または-1以外の値を使用している場合、開発者は、これが正しく行うために複雑になるよう、自身の<code id=the-tabindex-attribute:attr-tabindex-3><a href=#attr-tabindex>tabindex</a></code>属性に対して用心すべきである。</p>

  

  <p>Each element can have a <dfn id=specially-focusable>tabindex focus flag</dfn> set, as defined
  below. This flag is a factor that contributes towards determining whether an element is a
  <a href=#focusable-area id=the-tabindex-attribute:focusable-area-3>focusable area</a>, as described in the previous section.</p>

  <p>If the <code id=the-tabindex-attribute:attr-tabindex-4><a href=#attr-tabindex>tabindex</a></code> attribute is specified on an element, it
  must be parsed using the <a id=the-tabindex-attribute:rules-for-parsing-integers href=infrastructure.html#rules-for-parsing-integers>rules for parsing integers</a>. The attribute's values, or lack
  thereof, must be interpreted as follows:</p>

  <dl><dt>If the attribute is omitted or parsing the value returns an error<dd>

    <p>The user agent should follow platform conventions to determine if the element's
    <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable>tabindex focus flag</a> is set and, if so, whether the element and any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-4>focusable areas</a> that have the element as their <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor>DOM anchor</a> can
    be reached using <a href=#sequential-focus-navigation id=the-tabindex-attribute:sequential-focus-navigation-3>sequential focus navigation</a>, and if so, what their relative
    position in the <a href=#sequential-focus-navigation-order id=the-tabindex-attribute:sequential-focus-navigation-order-2>sequential focus navigation order</a> is to be.</p>

    <p>Modulo platform conventions, it is suggested that for the following elements, the
    <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable-2>tabindex focus flag</a> be set:</p>

    <ul><li><code id=the-tabindex-attribute:the-a-element><a href=semantics.html#the-a-element>a</a></code> elements that have an <code id=the-tabindex-attribute:attr-hyperlink-href><a href=semantics.html#attr-hyperlink-href>href</a></code>
     attribute</li><li><code id=the-tabindex-attribute:the-link-element><a href=semantics.html#the-link-element>link</a></code> elements that have an <code id=the-tabindex-attribute:attr-link-href><a href=semantics.html#attr-link-href>href</a></code> attribute</li><li><code id=the-tabindex-attribute:the-button-element><a href=forms.html#the-button-element>button</a></code> elements</li><li><code id=the-tabindex-attribute:the-input-element><a href=forms.html#the-input-element>input</a></code> elements whose <code id=the-tabindex-attribute:attr-input-type><a href=forms.html#attr-input-type>type</a></code> attribute are
     not in the <a href="forms.html#hidden-state-(type=hidden)" id="the-tabindex-attribute:hidden-state-(type=hidden)">Hidden</a> state</li><li><code id=the-tabindex-attribute:the-select-element><a href=forms.html#the-select-element>select</a></code>要素</li><li><code id=the-tabindex-attribute:the-textarea-element><a href=forms.html#the-textarea-element>textarea</a></code>要素</li><li><code id=the-tabindex-attribute:the-menuitem-element><a href=forms.html#the-menuitem-element>menuitem</a></code> elements</li><li>Elements with a <code id=the-tabindex-attribute:the-draggable-attribute><a href=#the-draggable-attribute>draggable</a></code> attribute set, if that would
     enable the user agent to allow the user to begin a drag operations for those elements without
     the use of a pointing device</li><li><a href=https://w3c.github.io/editing/execCommand.html#editing-host id=the-tabindex-attribute:editing-host data-x-internal=editing-host>Editing hosts</a></li><li><a href=browsers.html#browsing-context-container id=the-tabindex-attribute:browsing-context-container>Browsing context containers</a></li></ul>

    <p class=note>One valid reason to ignore the platform conventions and always allow an element
    to be focused (by setting its <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable-3>tabindex focus flag</a>) would be if the user's only
    mechanism for activating an element is through a keyboard action that triggers the focused
    element.</p>

   <dt id=negative-tabindex>If the value is a negative integer<dd>

    <p>The user agent must set the element's <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable-4>tabindex focus flag</a>, but should omit the
    element from the <a href=#sequential-focus-navigation-order id=the-tabindex-attribute:sequential-focus-navigation-order-3>sequential focus navigation order</a>.</p>

    <p class=note>One valid reason to ignore the requirement that sequential focus navigation not
    allow the author to lead to the element would be if the user's only mechanism for moving the
    focus is sequential focus navigation. For instance, a keyboard-only user would be unable to
    click on a text field with a negative <code id=the-tabindex-attribute:attr-tabindex-5><a href=#attr-tabindex>tabindex</a></code>, so that
    user's user agent would be well justified in allowing the user to tab to the control
    regardless.</p>

   <dt>If the value is a zero<dd>

    <p>The user agent must set the element's <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable-5>tabindex focus flag</a>, should allow the
    element and any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-5>focusable areas</a> that have the element as their
    <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-2>DOM anchor</a> to be reached using <a href=#sequential-focus-navigation id=the-tabindex-attribute:sequential-focus-navigation-4>sequential focus navigation</a>, following
    platform conventions to determine the element's relative position in the <a href=#sequential-focus-navigation-order id=the-tabindex-attribute:sequential-focus-navigation-order-4>sequential focus
    navigation order</a>.</p>

   <dt>If the value is greater than zero<dd>

    <p>The user agent must set the element's <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable-6>tabindex focus flag</a>, should allow the
    element and any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-6>focusable areas</a> that have the element as their
    <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-3>DOM anchor</a> to be reached using sequential focus navigation, and should place the element
    — referenced as <var>candidate</var> below — and the aforementioned <a href=#focusable-area id=the-tabindex-attribute:focusable-area-7>focusable areas</a> in the <a href=#sequential-focus-navigation id=the-tabindex-attribute:sequential-focus-navigation-5>sequential focus navigation</a>
    order so that, relative to other <a href=#focusable-area id=the-tabindex-attribute:focusable-area-8>focusable areas</a> in the
    <a href=#sequential-focus-navigation-order id=the-tabindex-attribute:sequential-focus-navigation-order-5>sequential focus navigation order</a>, they are:</p>

    <ul><li>before any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-9>focusable area</a> whose <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-4>DOM anchor</a> is an element whose <code id=the-tabindex-attribute:attr-tabindex-6><a href=#attr-tabindex>tabindex</a></code> attribute has been omitted or whose value, when parsed,
     returns an error,</li><li>before any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-10>focusable area</a> whose <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-5>DOM anchor</a> is an element whose <code id=the-tabindex-attribute:attr-tabindex-7><a href=#attr-tabindex>tabindex</a></code> attribute has a value equal to or less than zero,</li><li>after any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-11>focusable area</a> whose <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-6>DOM anchor</a> is an element whose <code id=the-tabindex-attribute:attr-tabindex-8><a href=#attr-tabindex>tabindex</a></code> attribute has a value greater than zero but less than
     the value of the <code id=the-tabindex-attribute:attr-tabindex-9><a href=#attr-tabindex>tabindex</a></code> attribute on <var>candidate</var>,</li><li>after any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-12>focusable area</a> whose <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-7>DOM anchor</a> is an element whose <code id=the-tabindex-attribute:attr-tabindex-10><a href=#attr-tabindex>tabindex</a></code> attribute has a value equal to the value of the <code id=the-tabindex-attribute:attr-tabindex-11><a href=#attr-tabindex>tabindex</a></code> attribute on <var>candidate</var> but that is
     earlier in the document in <a id=the-tabindex-attribute:tree-order href=https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order data-x-internal=tree-order>tree order</a> than <var>candidate</var>,</li><li>before any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-13>focusable area</a> whose <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-8>DOM anchor</a> is an element whose <code id=the-tabindex-attribute:attr-tabindex-12><a href=#attr-tabindex>tabindex</a></code> attribute has a value equal to the value of the <code id=the-tabindex-attribute:attr-tabindex-13><a href=#attr-tabindex>tabindex</a></code> attribute on <var>candidate</var> but that is
     later in the document in <a id=the-tabindex-attribute:tree-order-2 href=https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order data-x-internal=tree-order>tree order</a> than <var>candidate</var>, and</li><li>before any <a href=#focusable-area id=the-tabindex-attribute:focusable-area-14>focusable area</a> whose <a href=#dom-anchor id=the-tabindex-attribute:dom-anchor-9>DOM anchor</a> is an element whose <code id=the-tabindex-attribute:attr-tabindex-14><a href=#attr-tabindex>tabindex</a></code> attribute has a value greater than the value of the
     <code id=the-tabindex-attribute:attr-tabindex-15><a href=#attr-tabindex>tabindex</a></code> attribute on <var>candidate</var>.</li></ul>

   </dl>

  <p>An element that has its <a href=#specially-focusable id=the-tabindex-attribute:specially-focusable-7>tabindex focus flag</a> set but does not otherwise have an
  <a href=#activation-behaviour id=the-tabindex-attribute:activation-behaviour>activation behaviour</a> defined has an <a href=#activation-behaviour id=the-tabindex-attribute:activation-behaviour-2>activation behaviour</a> that does
  nothing.</p>

  <p class=note>This means that an element that is only focusable because of its <code id=the-tabindex-attribute:attr-tabindex-16><a href=#attr-tabindex>tabindex</a></code> attribute will fire a <code id=the-tabindex-attribute:event-click><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code> event in response to a non-mouse activation (e.g. hitting the
  "enter" key while the element is <a href=#focused id=the-tabindex-attribute:focused>focused</a>).</p>

  <p>An element with the <code id=the-tabindex-attribute:attr-tabindex-17><a href=#attr-tabindex>tabindex</a></code> attribute specified is
  <a id=the-tabindex-attribute:interactive-content-2 href=dom.html#interactive-content-2>interactive content</a>.</p>

  <p>The <dfn id=dom-tabindex><code>tabIndex</code></dfn> IDL attribute must
  <a id=the-tabindex-attribute:reflect href=infrastructure.html#reflect>reflect</a> the value of the <code id=the-tabindex-attribute:attr-tabindex-18><a href=#attr-tabindex>tabindex</a></code> content
  attribute. Its default value is 0 for elements that are focusable and −1 for elements that
  are not focusable.</p>

  


  

  <h4 id=focus-processing-model>6.4.4 <span id=processing-model-5></span>Processing model</h4>

  <p>The <dfn id=focusing-steps>focusing steps</dfn> for an object <var>new focus target</var> that is
  either a <a href=#focusable-area id=focus-processing-model:focusable-area>focusable area</a>, or an element that is not a <a href=#focusable-area id=focus-processing-model:focusable-area-2>focusable area</a>, or a
  <a id=focus-processing-model:browsing-context href=browsers.html#browsing-context>browsing context</a>, are as follows. They can optionally be run with a <i>fallback target</i>.</p>

  <ol><li>

    <p>If <var>new focus target</var> is neither a <code id=focus-processing-model:the-dialog-element><a href=forms.html#the-dialog-element>dialog</a></code> element that has an
    <code id=focus-processing-model:attr-dialog-open><a href=forms.html#attr-dialog-open>open</a></code> attribute specified and that is <a id=focus-processing-model:being-rendered href=rendering.html#being-rendered>being
    rendered</a> (i.e. that is a <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object>control group owner object</a>), nor a <a href=#focusable-area id=focus-processing-model:focusable-area-3>focusable
    area</a>, then run the first matching set of steps from the following list:</p>

    <dl class=switch><dt>If <var>new focus target</var> is an <code id=focus-processing-model:the-area-element><a href=embedded-content.html#the-area-element>area</a></code> element with one or more
     shapes that are <a href=#focusable-area id=focus-processing-model:focusable-area-4>focusable areas</a><dd>

      <p>Let <var>new focus target</var> be the shape corresponding to the first
      <code id=focus-processing-model:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element in <a id=focus-processing-model:tree-order href=https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order data-x-internal=tree-order>tree order</a> that uses the image map to which the <code id=focus-processing-model:the-area-element-2><a href=embedded-content.html#the-area-element>area</a></code>
      element belongs.</p>

     <dt>If <var>new focus target</var> is an element with one or more scrollable regions
     that are <a href=#focusable-area id=focus-processing-model:focusable-area-5>focusable areas</a><dd>

      <p>Let <var>new focus target</var> be the element's first scrollable region,
      according to a pre-order, depth-first traversal of the box tree. <a href=references.html#refsCSS>[CSS]</a></p>

     <dt>If <var>new focus target</var> is the <a id=focus-processing-model:document-element href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>document element</a> of its
     <code id=focus-processing-model:document><a href=dom.html#document>Document</a></code><dd>

      <p>Let <var>new focus target</var> be the <code id=focus-processing-model:document-2><a href=dom.html#document>Document</a></code>'s <a id=focus-processing-model:viewport href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>.</p>

     <dt>If <var>new focus target</var> is a <a id=focus-processing-model:browsing-context-2 href=browsers.html#browsing-context>browsing context</a><dd>

      <p>Let <var>new focus target</var> be the <a id=focus-processing-model:browsing-context-3 href=browsers.html#browsing-context>browsing context</a>'s
      <a id=focus-processing-model:active-document href=browsers.html#active-document>active document</a>.</p>

     <dt>If <var>new focus target</var> is a <a id=focus-processing-model:browsing-context-container href=browsers.html#browsing-context-container>browsing context container</a><dd>

      <p>Let <var>new focus target</var> be the <a id=focus-processing-model:browsing-context-container-2 href=browsers.html#browsing-context-container>browsing context container</a>'s <a id=focus-processing-model:nested-browsing-context href=browsers.html#nested-browsing-context>nested browsing context</a>'s
      <a id=focus-processing-model:active-document-2 href=browsers.html#active-document>active document</a>.</p>

     <dt>そうでなければ<dd>

      <p>If no <i>fallback target</i> was specified, abort the <a href=#focusing-steps id=focus-processing-model:focusing-steps>focusing steps</a>.</p>

      <p>Otherwise, let <var>new focus target</var> be the <i>fallback target</i>.</p>

     </dl>

   </li><li>

    <p>If <var>new focus target</var> is a <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object-2>control group owner object</a> that is
    not a <a href=#focusable-area id=focus-processing-model:focusable-area-6>focusable area</a>, but does have a <a href=#dialog-group id=focus-processing-model:dialog-group>dialog group</a>, and that <a href=#dialog-group id=focus-processing-model:dialog-group-2>dialog group</a>
    has a designated <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group>focused dialog</a>, then
    let <var>new focus target</var> be the <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-2>focused dialog of the dialog
    group</a>, and redo this step.</p>

    <p>Otherwise, if <var>new focus target</var> is a <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object-3>control group owner
    object</a> that is not a <a href=#focusable-area id=focus-processing-model:focusable-area-7>focusable area</a>, and its <a href=#control-group id=focus-processing-model:control-group>control group</a> is not empty,
    then designate <var>new focus target</var> as the <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group>focused area of the control
    group</a>, and redo this step.</p>

    
    <p>Otherwise, if <var>new focus target</var> is a <a id=focus-processing-model:browsing-context-container-3 href=browsers.html#browsing-context-container>browsing context
    container</a>, then let <var>new focus target</var> be the <a id=focus-processing-model:nested-browsing-context-2 href=browsers.html#nested-browsing-context>nested browsing
    context</a>'s <a id=focus-processing-model:active-document-3 href=browsers.html#active-document>active document</a>, and redo this step.</p>

    <p class=note>A <code id=focus-processing-model:the-dialog-element-2><a href=forms.html#the-dialog-element>dialog</a></code> element can be both a <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object-4>control group owner
    object</a> and a <a href=#focusable-area id=focus-processing-model:focusable-area-8>focusable area</a>, if it has both an <code id=focus-processing-model:attr-dialog-open-2><a href=forms.html#attr-dialog-open>open</a></code> attribute specified and a <code id=focus-processing-model:attr-tabindex><a href=#attr-tabindex>tabindex</a></code> attribute specified and is <a id=focus-processing-model:being-rendered-2 href=rendering.html#being-rendered>being
    rendered</a>.</p>

   </li><li><p>If <var>new focus target</var> is a <a href=#focusable-area id=focus-processing-model:focusable-area-9>focusable area</a> and its <a href=#dom-anchor id=focus-processing-model:dom-anchor>DOM
   anchor</a> is <a href=#inert id=focus-processing-model:inert>inert</a>, then abort these steps.</li><li><p>If <var>new focus target</var> is the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context>currently focused area of a
   top-level browsing context</a>, then abort these steps.</li><li><p>Let <var>old chain</var> be the <a href=#focus-chain id=focus-processing-model:focus-chain>focus chain</a> of the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-2>currently focused area of the
   top-level browsing context</a> in which <var>new focus target</var> finds
   itself.</li><li><p>Let <var>new chain</var> be the <a href=#focus-chain id=focus-processing-model:focus-chain-2>focus chain</a> of <var>new
   focus target</var>.</li><li><p>Run the <a href=#focus-update-steps id=focus-processing-model:focus-update-steps>focus update steps</a> with <var>old chain</var>, <var>new chain</var>, and <var>new focus target</var> respectively.</li></ol>

  <p>User agents must <a id=focus-processing-model:immediately href=infrastructure.html#immediately>immediately</a> run the <a href=#focusing-steps id=focus-processing-model:focusing-steps-2>focusing steps</a> for a <a href=#focusable-area id=focus-processing-model:focusable-area-10>focusable area</a>,
  <code id=focus-processing-model:the-dialog-element-3><a href=forms.html#the-dialog-element>dialog</a></code>, or <a id=focus-processing-model:browsing-context-4 href=browsers.html#browsing-context>browsing context</a> <var>candidate</var> whenever the
  user attempts to move the focus to <var>candidate</var>.</p>

  <p>The <dfn id=unfocusing-steps>unfocusing steps</dfn> for an object <var>old focus target</var> that is
  either a <a href=#focusable-area id=focus-processing-model:focusable-area-11>focusable area</a> or an element that is not a <a href=#focusable-area id=focus-processing-model:focusable-area-12>focusable area</a> are as
  follows:</p>

  <ol><li><p>If <var>old focus target</var> is <a href=#inert id=focus-processing-model:inert-2>inert</a>, then abort these
   steps.</li><li>

    <p>If <var>old focus target</var> is an <code id=focus-processing-model:the-area-element-3><a href=embedded-content.html#the-area-element>area</a></code> element and one of its shapes is the
    <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-3>currently focused area of a top-level browsing context</a>, or, if <var>old focus
    target</var> is an element with one or more scrollable regions, and one of them is the
    <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-4>currently focused area of a top-level browsing context</a>, then let <var>old focus
    target</var> be that <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-5>currently focused area of a top-level browsing context</a>.</p>

   </li><li><p>Let <var>old chain</var> be the <a href=#focus-chain id=focus-processing-model:focus-chain-3>focus chain</a> of the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-6>currently
   focused area of a top-level browsing context</a>.</li><li><p>If <var>old focus target</var> is not one of the entries in <var>old
   chain</var>, then abort these steps.</li><li>

    <p>If <var>old focus target</var> is a <code id=focus-processing-model:the-dialog-element-4><a href=forms.html#the-dialog-element>dialog</a></code> in a <a href=#dialog-group id=focus-processing-model:dialog-group-3>dialog group</a>, and
    the <a href=#dialog-group-manager id=focus-processing-model:dialog-group-manager>dialog group manager</a> has a non-empty <a href=#control-group id=focus-processing-model:control-group-2>control group</a>, then let
    <var>new focus target</var> be the designated <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-2>focused area of that focus group</a>.</p>

    <p>Otherwise, if <var>old focus target</var> is a <a href=#focusable-area id=focus-processing-model:focusable-area-13>focusable area</a>, then let <var>new
    focus target</var> be the first <a href=#focusable-area id=focus-processing-model:focusable-area-14>focusable area</a> of its <a href=#control-group id=focus-processing-model:control-group-3>control group</a>
    (if the <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object-5>control group owner object</a> is a <code id=focus-processing-model:document-3><a href=dom.html#document>Document</a></code>, this will always be
    a <a id=focus-processing-model:viewport-2 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>).</p>

    <p>Otherwise, let <var>new focus target</var> be null.</p>

   </li><li><p>If <var>new focus target</var> is not null, then run the <a href=#focusing-steps id=focus-processing-model:focusing-steps-3>focusing
   steps</a> for <var>new focus target</var>.</li></ol>

  <p>When the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-7>currently focused area of a top-level browsing context</a> is somehow
  unfocused without another element being explicitly focused in its stead, the user agent must
  <a id=focus-processing-model:immediately-2 href=infrastructure.html#immediately>immediately</a> run the <a href=#unfocusing-steps id=focus-processing-model:unfocusing-steps>unfocusing steps</a> for that object.</p>

  <p class=note>The <a href=#unfocusing-steps id=focus-processing-model:unfocusing-steps-2>unfocusing steps</a> do not always result in the focus changing, even
  when applied to the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-8>currently focused area of a top-level browsing context</a>. For
  example, if the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-9>currently focused area of a top-level browsing context</a> is a
  <a id=focus-processing-model:viewport-3 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>, then it will usually keep its focus regardless until another
  <a href=#focusable-area id=focus-processing-model:focusable-area-15>focusable area</a> is explicitly focused with the <a href=#focusing-steps id=focus-processing-model:focusing-steps-4>focusing steps</a>.</p>

  <hr>

  <p>When a <a href=#focusable-area id=focus-processing-model:focusable-area-16>focusable area</a> is added to an empty <a href=#control-group id=focus-processing-model:control-group-4>control group</a>, it must be designated
  the <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-3>focused area of the control group</a>.</p>

  <p>When a <a href=#dialog-group id=focus-processing-model:dialog-group-4>dialog group</a> is formed, if the <a href=#dialog-group-manager id=focus-processing-model:dialog-group-manager-2>dialog group manager</a> has an empty
  <a href=#control-group id=focus-processing-model:control-group-5>control group</a>, the first non-<a href=#inert id=focus-processing-model:inert-3>inert</a> <code id=focus-processing-model:the-dialog-element-5><a href=forms.html#the-dialog-element>dialog</a></code> in the <a href=#dialog-group id=focus-processing-model:dialog-group-5>dialog
  group</a>, if any, or else the first <code id=focus-processing-model:the-dialog-element-6><a href=forms.html#the-dialog-element>dialog</a></code> in the <a href=#dialog-group id=focus-processing-model:dialog-group-6>dialog group</a> regardless of
  <a href=#inert id=focus-processing-model:inert-4>inertness</a>, must be designated the <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-3>focused dialog of the dialog
  group</a>.</p>

  <p><dfn id=focus-fixup-rule-one>Focus fixup rule one</dfn>: When the designated <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-4>focused area of a control group</a> is removed from that <a href=#control-group id=focus-processing-model:control-group-6>control group</a> in
  some way (e.g. it stops being a <a href=#focusable-area id=focus-processing-model:focusable-area-17>focusable area</a>, it is removed from the DOM, it
  becomes <a href=#expressly-inert-control id=focus-processing-model:expressly-inert-control>expressly inert</a>, etc), and the <a href=#control-group id=focus-processing-model:control-group-7>control
  group</a> is still not empty: designate the first non-<a href=#inert id=focus-processing-model:inert-5>inert</a> <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-5>focused area</a> in that <a href=#control-group id=focus-processing-model:control-group-8>control group</a> to be the new
  <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-6>focused area of the control group</a>, if any; if they are all <a href=#inert id=focus-processing-model:inert-6>inert</a>, then
  designate the first <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-7>focused area</a> in that
  <a href=#control-group id=focus-processing-model:control-group-9>control group</a> to be the new <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-8>focused area of the control group</a> regardless
  of <a href=#inert id=focus-processing-model:inert-7>inertness</a>. If such a removal instead results in the <a href=#control-group id=focus-processing-model:control-group-10>control
  group</a> being empty, then there is simply no longer a <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-9>focused area of the control
  group</a>.</p>

  <p class=example>For example, this might happen because an element is removed from its
  <code id=focus-processing-model:document-4><a href=dom.html#document>Document</a></code>, or has a <code id=focus-processing-model:the-hidden-attribute><a href=#the-hidden-attribute>hidden</a></code> attribute added. It might
  also happen to an <code id=focus-processing-model:the-input-element><a href=forms.html#the-input-element>input</a></code> element when the element gets <a href=forms.html#concept-fe-disabled id=focus-processing-model:concept-fe-disabled>disabled</a>.</p>

  <p><dfn id=focus-fixup-rule-two>Focus fixup rule two</dfn>: When a <a href=#dialog-group id=focus-processing-model:dialog-group-7>dialog group</a> has no designated <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-4>focused
  dialog of the dialog group</a>, and its <a href=#dialog-group-manager id=focus-processing-model:dialog-group-manager-3>dialog group manager</a>'s <a href=#control-group id=focus-processing-model:control-group-11>control
  group</a> changes from being non-empty to being empty, the first non-<a href=#inert id=focus-processing-model:inert-8>inert</a>
  <code id=focus-processing-model:the-dialog-element-7><a href=forms.html#the-dialog-element>dialog</a></code> in the <a href=#dialog-group id=focus-processing-model:dialog-group-8>dialog group</a>, if any, or else the first <code id=focus-processing-model:the-dialog-element-8><a href=forms.html#the-dialog-element>dialog</a></code> in
  the <a href=#dialog-group id=focus-processing-model:dialog-group-9>dialog group</a> regardless of <a href=#inert id=focus-processing-model:inert-9>inertness</a>, must be designated
  the <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-5>focused dialog of the dialog group</a>.</p>

  <p><dfn id=focus-fixup-rule-three>Focus fixup rule three</dfn>: When the designated <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-6>focused dialog of a dialog group</a> is removed from that <a href=#dialog-group id=focus-processing-model:dialog-group-10>dialog group</a> in
  some way (e.g. it stops <a id=focus-processing-model:being-rendered-3 href=rendering.html#being-rendered>being rendered</a>, it loses its <code id=focus-processing-model:attr-dialog-open-3><a href=forms.html#attr-dialog-open>open</a></code> attribute, it becomes <a href=#expressly-inert-dialog id=focus-processing-model:expressly-inert-dialog>expressly inert</a>, etc), and there is still a <a href=#dialog-group id=focus-processing-model:dialog-group-11>dialog group</a> (because the
  <code id=focus-processing-model:the-dialog-element-9><a href=forms.html#the-dialog-element>dialog</a></code> in question was not the last <code id=focus-processing-model:the-dialog-element-10><a href=forms.html#the-dialog-element>dialog</a></code> in that <a href=#dialog-group id=focus-processing-model:dialog-group-12>dialog group</a>):
  if the <a href=#dialog-group id=focus-processing-model:dialog-group-13>dialog group</a>'s <a href=#dialog-group-manager id=focus-processing-model:dialog-group-manager-4>manager</a>'s <a href=#control-group id=focus-processing-model:control-group-12>control
  group</a> is non-empty, let there be no designated <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-7>focused dialog of the dialog group</a>
  any more; otherwise (in the case that the <a href=#control-group id=focus-processing-model:control-group-13>control group</a> is empty), designate the first
  non-<a href=#inert id=focus-processing-model:inert-10>inert</a> <code id=focus-processing-model:the-dialog-element-11><a href=forms.html#the-dialog-element>dialog</a></code> in the <a href=#dialog-group id=focus-processing-model:dialog-group-14>dialog group</a> to be the <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-8>focused
  dialog of the dialog group</a>, or, if they are all <a href=#inert id=focus-processing-model:inert-11>inert</a>, designate the first
  <code id=focus-processing-model:the-dialog-element-12><a href=forms.html#the-dialog-element>dialog</a></code> in the <a href=#dialog-group id=focus-processing-model:dialog-group-15>dialog group</a> to be the <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-9>focused dialog of the dialog
  group</a> regardless of <a href=#inert id=focus-processing-model:inert-12>inertness</a>.</p>

  <p>When the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-10>currently focused area of a top-level browsing context</a> was a <a href=#focusable-area id=focus-processing-model:focusable-area-18>focusable
  area</a> but stops being a <a href=#focusable-area id=focus-processing-model:focusable-area-19>focusable area</a>, or when it was a <code id=focus-processing-model:the-dialog-element-13><a href=forms.html#the-dialog-element>dialog</a></code> in a
  <a href=#dialog-group id=focus-processing-model:dialog-group-16>dialog group</a> and stops being part of that <a href=#dialog-group id=focus-processing-model:dialog-group-17>dialog group</a>, or when it
  starts being <a href=#inert id=focus-processing-model:inert-13>inert</a>, the user agent must run the following steps:</p>

  <ol><li><p>Let <var>old focus target</var> be whatever the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-11>currently focused area of the top-level browsing
   context</a> was immediately before this algorithm became applicable (e.g. before the element
   was disabled, or the dialog was closed, or whatever caused this algorithm to run).</li><li><p>Let <var>old chain</var> be the <a href=#focus-chain id=focus-processing-model:focus-chain-4>focus chain</a> of the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-12>currently focused area of the
   top-level browsing context</a> at the same time.</li><li><p>Make sure that the changes implied by the focus fixup rules <a href=#focus-fixup-rule-one id=focus-processing-model:focus-fixup-rule-one>one</a>, <a href=#focus-fixup-rule-two id=focus-processing-model:focus-fixup-rule-two>two</a>, and <a href=#focus-fixup-rule-three id=focus-processing-model:focus-fixup-rule-three>three</a> above are applied.</li><li><p>Let <var>new focus target</var> be the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-13>currently focused area of a
   top-level browsing context</a>.</li><li><p>If <var>old focus target</var> and <var>new focus target</var> are the
   same, abort these steps.</li><li><p>Let <var>new chain</var> be the <a href=#focus-chain id=focus-processing-model:focus-chain-5>focus chain</a> of <var>new
   focus target</var>.</li><li><p>Run the <a href=#focus-update-steps id=focus-processing-model:focus-update-steps-2>focus update steps</a> with <var>old chain</var>, <var>new chain</var>, and <var>new focus target</var> respectively.</li></ol>

  <hr>

  <p>The <dfn id=focus-update-steps>focus update steps</dfn>, given an <var>old chain</var>, a <var>new chain</var>, and a <var>new focus target</var> respectively, are as
  follows:</p>

  <ol><li><p>If the last entry in <var>old chain</var> and the last entry in <var>new chain</var> are the same, pop the last entry from <var>old chain</var>
   and the last entry from <var>new chain</var> and redo this step.</li><li>

    <p>For each entry <var>entry</var> in <var>old chain</var>, in order, run
    these substeps:</p>

    <ol><li id=unfocus-causes-change-event><p>If <var>entry</var> is an <code id=focus-processing-model:the-input-element-2><a href=forms.html#the-input-element>input</a></code>
     element, and the <code id=focus-processing-model:event-change><a href=indices.html#event-change>change</a></code> event <a href=forms.html#concept-input-apply id=focus-processing-model:concept-input-apply>applies</a> to the element, and the element does not have a
     defined <a href=#activation-behaviour id=focus-processing-model:activation-behaviour>activation behaviour</a>, and the user has changed the element's <a href=forms.html#concept-fe-value id=focus-processing-model:concept-fe-value>value</a> or its list of <a href=forms.html#concept-input-type-file-selected id=focus-processing-model:concept-input-type-file-selected>selected files</a> while the control was focused
     without committing that change (such that it is different to what it was when the control was
     first focused), then <a id=focus-processing-model:fire-a-simple-event href=webappapis.html#fire-a-simple-event>fire a simple event</a> that bubbles named <code id=focus-processing-model:event-change-2><a href=indices.html#event-change>change</a></code> at the element.</p>

     </li><li>

      <p>If <var>entry</var> is an element, let <var>blur event target</var> be
      <var>entry</var>.</p>

      <p>If <var>entry</var> is a <code id=focus-processing-model:document-5><a href=dom.html#document>Document</a></code> object, let <var>blur
      event target</var> be that <code id=focus-processing-model:document-6><a href=dom.html#document>Document</a></code> object's <code id=focus-processing-model:window><a href=browsers.html#window>Window</a></code> object.</p>

      <p>Otherwise, let <var>blur event target</var> be null.</p>

     </li><li><p>If <var>entry</var> is the last entry in <var>old chain</var>, and
     <var>entry</var> is an <code id=focus-processing-model:element><a data-x-internal=element href=https://triple-underscore.github.io/DOM4-ja.html#interface-element>Element</a></code>, and the last entry in <var>new
     chain</var> is also an <code id=focus-processing-model:element-2><a data-x-internal=element href=https://triple-underscore.github.io/DOM4-ja.html#interface-element>Element</a></code>, then let <var>related blur target</var>
     be the last entry in <var>new chain</var>. Otherwise, let <var>related blur
     target</var> be null.</li><li>

      <p>If <var>blur event target</var> is not null, <a href=#fire-a-focus-event id=focus-processing-model:fire-a-focus-event>fire a focus event</a>
      named <code id=focus-processing-model:event-blur><a href=indices.html#event-blur>blur</a></code> at <var>blur event target</var>, with
      <var>related blur target</var> as the related target.</p>

      <p class=note>In some cases, e.g. if <var>entry</var> is an <code id=focus-processing-model:the-area-element-4><a href=embedded-content.html#the-area-element>area</a></code>
      element's shape, a scrollable region, or a <a id=focus-processing-model:viewport-4 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>, no event is fired.</p>

     </li></ol>

   </li><li><p>Apply any relevant platform-specific conventions for focusing <var>new focus
   target</var>. (For example, some platforms select the contents of a text field when that field is
   focused.)</li><li>

    <p>For each entry <var>entry</var> in <var>new chain</var>, in reverse
    order, run these substeps:</p>

    <ol><li><p>If <var>entry</var> is a <code id=focus-processing-model:the-dialog-element-14><a href=forms.html#the-dialog-element>dialog</a></code> element: Let <var>entry</var> be the designated <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-10>focused dialog of its dialog group</a>.</li><li>

      <p>If <var>entry</var> is a <a href=#focusable-area id=focus-processing-model:focusable-area-20>focusable area</a>: Designate <var>entry</var> as the
      <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-10>focused area of the control group</a>. If its <a href=#control-group id=focus-processing-model:control-group-14>control group</a>'s <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object-6>owner object</a> is also a <a href=#dialog-group-manager id=focus-processing-model:dialog-group-manager-5>dialog group
      manager</a>, then let there be no designated <a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-11>focused dialog</a> in that <a href=#dialog-group id=focus-processing-model:dialog-group-18>dialog group</a>.</p>

      <p class=note>It is possible for <var>entry</var> to be both a <code id=focus-processing-model:the-dialog-element-15><a href=forms.html#the-dialog-element>dialog</a></code>
      element and a <a href=#focusable-area id=focus-processing-model:focusable-area-21>focusable area</a>, in which case it is its own <a href=#control-group-owner-object id=focus-processing-model:control-group-owner-object-7>control group
      owner object</a>.</p>

     </li><li>

      <p>If <var>entry</var> is an element, let <var>focus event target</var> be
      <var>entry</var>.</p>

      <p>If <var>entry</var> is a <code id=focus-processing-model:document-7><a href=dom.html#document>Document</a></code> object, let <var>focus
      event target</var> be that <code id=focus-processing-model:document-8><a href=dom.html#document>Document</a></code> object's <code id=focus-processing-model:window-2><a href=browsers.html#window>Window</a></code> object.</p>

      <p>Otherwise, let <var>focus event target</var> be null.</p>

     </li><li><p>If <var>entry</var> is the last entry in <var>new chain</var>, and
     <var>entry</var> is an <code id=focus-processing-model:element-3><a data-x-internal=element href=https://triple-underscore.github.io/DOM4-ja.html#interface-element>Element</a></code>, and the last entry in <var>old
     chain</var> is also an <code id=focus-processing-model:element-4><a data-x-internal=element href=https://triple-underscore.github.io/DOM4-ja.html#interface-element>Element</a></code>, then let <var>related focus target</var>
     be the last entry in <var>old chain</var>. Otherwise, let <var>related
     focus target</var> be null.</li><li>

      <p>If <var>focus event target</var> is not null, <a href=#fire-a-focus-event id=focus-processing-model:fire-a-focus-event-2>fire a focus event</a>
      named <code id=focus-processing-model:event-focus><a href=indices.html#event-focus>focus</a></code> at <var>focus event target</var>, with
      <var>related focus target</var> as the related target.</p>

      <p class=note>In some cases, e.g. if <var>entry</var> is an <code id=focus-processing-model:the-area-element-5><a href=embedded-content.html#the-area-element>area</a></code>
      element's shape, a scrollable region, or a <a id=focus-processing-model:viewport-5 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>, no event is fired.</p>

     </li></ol>

   </li></ol>

  <p>When a user agent is required to <dfn id=fire-a-focus-event>fire a focus event</dfn> named <var>e</var> at
  an element <var>t</var> and with a given related target <var>r</var>, the user
  agent must create a <a href=infrastructure.html#concept-events-trusted id=focus-processing-model:concept-events-trusted>trusted</a> <code id=focus-processing-model:focusevent><a data-x-internal=focusevent href=https://w3c.github.io/uievents/#interface-FocusEvent>FocusEvent</a></code>
  object, initialise it to have the given name <var>e</var>, to not bubble, to not be
  cancelable, and to have the <code id=focus-processing-model:dom-focusevent-relatedtarget><a data-x-internal=dom-focusevent-relatedtarget href=https://w3c.github.io/uievents/#widl-FocusEvent-relatedTarget>relatedTarget</a></code>
  attribute initialised to <var>r</var>, the <code id=focus-processing-model:dom-uievent-view><a data-x-internal=dom-uievent-view href=https://w3c.github.io/uievents/#widl-UIEvent-view>view</a></code> attribute initialised to the <code id=focus-processing-model:window-3><a href=browsers.html#window>Window</a></code> object of the <code id=focus-processing-model:document-9><a href=dom.html#document>Document</a></code> object of <var>t</var>, and the <code id=focus-processing-model:dom-uievent-detail><a data-x-internal=dom-uievent-detail href=https://w3c.github.io/uievents/#widl-UIEvent-detail>detail</a></code> attribute initialised to 0, and must then <a href=infrastructure.html#concept-event-dispatch id=focus-processing-model:concept-event-dispatch>dispatch</a> the newly created <code id=focus-processing-model:focusevent-2><a data-x-internal=focusevent href=https://w3c.github.io/uievents/#interface-FocusEvent>FocusEvent</a></code> object
  at the specified target element <var>t</var>.</p>

  <hr>

  <p>When a key event is to be routed in a <a id=focus-processing-model:top-level-browsing-context href=browsers.html#top-level-browsing-context>top-level browsing context</a>, the user agent
  must run the following steps:</p>

  <ol><li><p>Let <var>target area</var> be the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-14>currently focused area of the top-level browsing
   context</a>.</li><li><p>If <var>target area</var> is a <a href=#focusable-area id=focus-processing-model:focusable-area-22>focusable area</a>, let <var>target
   node</var> be <var>target area</var>'s <a href=#dom-anchor id=focus-processing-model:dom-anchor-2>DOM anchor</a>. Otherwise, <var>target area</var> is a <code id=focus-processing-model:the-dialog-element-16><a href=forms.html#the-dialog-element>dialog</a></code>; let <var>target node</var> be
   <var>target area</var>.</li><li>

    <p>If <var>target node</var> is a <code id=focus-processing-model:document-10><a href=dom.html#document>Document</a></code> that has a <a href=dom.html#the-body-element-2 id=focus-processing-model:the-body-element-2>body element</a>, then let <var>target node</var> be <a id=focus-processing-model:the-body-element-2-2 href=dom.html#the-body-element-2>the body
    element</a> of that <code id=focus-processing-model:document-11><a href=dom.html#document>Document</a></code>.</p>

    <p>Otherwise, if <var>target node</var> is a <code id=focus-processing-model:document-12><a href=dom.html#document>Document</a></code> object that has a non-null
    <a id=focus-processing-model:document-element-2 href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>document element</a>, then let <var>target node</var> be that <a id=focus-processing-model:document-element-3 href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>document
    element</a>.</p>

   </li><li>

    <p>If <var>target node</var> is not <a href=#inert id=focus-processing-model:inert-14>inert</a>, fire the event at <var>target node</var>.</p>

    <p class=note>It is possible for the <a href=#currently-focused-area-of-a-top-level-browsing-context id=focus-processing-model:currently-focused-area-of-a-top-level-browsing-context-15>currently focused area of a top-level browsing
    context</a> to be <a href=#inert id=focus-processing-model:inert-15>inert</a>, for example if a <a href=forms.html#dom-dialog-showmodal id=focus-processing-model:dom-dialog-showmodal>modal dialog is shown</a>, and then that <code id=focus-processing-model:the-dialog-element-17><a href=forms.html#the-dialog-element>dialog</a></code>
    element is made <a href=#inert id=focus-processing-model:inert-16>inert</a>. It is likely to be the result of a logic error in the
    application, though.</p>

   </li><li><p>If the event was not canceled, then let <var>target area</var> handle the key
   event. This might include <a href=#run-synthetic-click-activation-steps id=focus-processing-model:run-synthetic-click-activation-steps>running synthetic
   click activation steps</a> for <var>target node</var>.</li></ol>

  <hr>

  <p>The <dfn id=has-focus-steps>has focus steps</dfn>, given a <code id=focus-processing-model:document-13><a href=dom.html#document>Document</a></code> object <var>target</var>, are
  as follows:</p>

  <ol><li><p><var>candidate</var>を<a id=focus-processing-model:top-level-browsing-context-2 href=browsers.html#top-level-browsing-context>トップレベルブラウジングコンテキスト</a>の <code id=focus-processing-model:document-14><a href=dom.html#document>Document</a></code>にする。</li><li><p>If <var>candidate</var> is <var>target</var>, return true and abort these steps.</li><li>

    <p><var>candidate</var>が指定された<a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-12>ダイアロググループの被フォーカスダイアログ</a>をともなう<a href=#dialog-group id=focus-processing-model:dialog-group-19>ダイアロググループ</a>を持つ場合、<var>candidate</var>を指定された<a href=#focused-dialog-of-the-dialog-group id=focus-processing-model:focused-dialog-of-the-dialog-group-13>ダイアロググループの被フォーカスダイアログ</a>にし、このステップを再実行する。</p>

    <p>Otherwise, if <var>candidate</var> has a non-empty <a href=#control-group id=focus-processing-model:control-group-15>control group</a>, and the
    designated <a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-11>focused area of the control group</a> is a <a id=focus-processing-model:browsing-context-container-4 href=browsers.html#browsing-context-container>browsing context
    container</a>, and the <a id=focus-processing-model:active-document-4 href=browsers.html#active-document>active document</a> of that <a id=focus-processing-model:browsing-context-container-5 href=browsers.html#browsing-context-container>browsing context
    container</a>'s <a id=focus-processing-model:nested-browsing-context-3 href=browsers.html#nested-browsing-context>nested browsing context</a> is <var>target</var>, then
    return true and abort these steps.</p>

    <p>そうでなければ、<var>candidate</var>が空でない<a href=#control-group id=focus-processing-model:control-group-16>コントロールグループ</a>を持ち、かつ指定された<a href=#focused-area-of-the-control-group id=focus-processing-model:focused-area-of-the-control-group-12>コントロールグループの被フォーカス領域</a>が<a id=focus-processing-model:browsing-context-container-6 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>である場合、<var>candidate</var>をその<a id=focus-processing-model:browsing-context-container-7 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>の<a id=focus-processing-model:nested-browsing-context-4 href=browsers.html#nested-browsing-context>ネストされるブラウジングコンテキスト</a>の<a id=focus-processing-model:active-document-5 href=browsers.html#active-document>アクティブ文書</a>にし、このステップを再実行する。</p>

    <p>Otherwise, return false and abort these steps.</p>

   </li></ol>



  <h4 id=sequential-focus-navigation>6.4.5 <dfn>シーケンシャルフォーカスナビゲーション</dfn></h4>

  <p>Each <a href=#control-group id=sequential-focus-navigation:control-group>control group</a> has a <dfn id=sequential-focus-navigation-order>sequential focus navigation order</dfn>, which orders some
  or all of the <a href=#focusable-area id=sequential-focus-navigation:focusable-area>focusable areas</a> in the <a href=#control-group id=sequential-focus-navigation:control-group-2>control group</a>
  relative to each other. The order in the <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order>sequential focus navigation order</a> does not
  have to be related to the order in the <a href=#control-group id=sequential-focus-navigation:control-group-3>control group</a> itself. If a <a href=#focusable-area id=sequential-focus-navigation:focusable-area-2>focusable area</a> is
  omitted from the <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-2>sequential focus navigation order</a> of its <a href=#control-group id=sequential-focus-navigation:control-group-4>control group</a>, then
  it is unreachable via <a href=#sequential-focus-navigation id=sequential-focus-navigation:sequential-focus-navigation>sequential focus navigation</a>.</p>

  <p>There can also be a <dfn id=sequential-focus-navigation-starting-point>sequential focus navigation starting point</dfn>. It is initially
  unset. The user agent may set it when the user indicates that it should be moved.</p>

  <p class=example>For example, the user agent could set it to the position of the user's click if
  the user clicks on the document contents.</p>

  <p>When the user requests that focus move from the <a href=#currently-focused-area-of-a-top-level-browsing-context id=sequential-focus-navigation:currently-focused-area-of-a-top-level-browsing-context>currently focused area of a top-level
  browsing context</a> to the next or previous <a href=#focusable-area id=sequential-focus-navigation:focusable-area-3>focusable area</a> (e.g. as the default action
  of pressing the <kbd>tab</kbd> key), or when the user requests that focus sequentially move to a
  <a id=sequential-focus-navigation:top-level-browsing-context href=browsers.html#top-level-browsing-context>top-level browsing context</a> in the first place (e.g. from the browser's location bar),
  the user agent must use the following algorithm:</p>

  <ol><li><p>Let <var>starting point</var> be the <a href=#currently-focused-area-of-a-top-level-browsing-context id=sequential-focus-navigation:currently-focused-area-of-a-top-level-browsing-context-2>currently focused area of a top-level
   browsing context</a>, if the user requested to move focus sequentially from there, or else the
   <a id=sequential-focus-navigation:top-level-browsing-context-2 href=browsers.html#top-level-browsing-context>top-level browsing context</a> itself, if the user instead requested to move focus from
   outside the <a id=sequential-focus-navigation:top-level-browsing-context-3 href=browsers.html#top-level-browsing-context>top-level browsing context</a>.</li><li><p>If there is a <a href=#sequential-focus-navigation-starting-point id=sequential-focus-navigation:sequential-focus-navigation-starting-point>sequential focus navigation starting point</a> defined and it is
   inside <var>starting point</var>, then let <var>starting point</var> be the <a href=#sequential-focus-navigation-starting-point id=sequential-focus-navigation:sequential-focus-navigation-starting-point-2>sequential
   focus navigation starting point</a> instead.</li><li>

    <p>Let <var>direction</var> be <i>forward</i> if the user requested the <em>next</em>
    control, and <i>backward</i> if the user requested the previous control.</p>

    <p class=note>Typically, pressing <kbd>tab</kbd> requests the next control, and pressing
    <kbd><kbd>shift</kbd>+<kbd>tab</kbd></kbd> requests the previous control.</p>

   </li><li>

    <p><i>Loop</i>: Let <var>selection mechanism</var> be <i>sequential</i> if the <var>starting
    point</var> is a <a id=sequential-focus-navigation:browsing-context href=browsers.html#browsing-context>browsing context</a> or if <var>starting point</var> is in its
    <a href=#control-group id=sequential-focus-navigation:control-group-5>control group</a>'s <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-3>sequential focus navigation order</a>.</p>

    <p>Otherwise, <var>starting point</var> is not in its <a href=#control-group id=sequential-focus-navigation:control-group-6>control group</a>'s
    <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-4>sequential focus navigation order</a>; let <var>selection mechanism</var> be
    <i>DOM</i>.</p>

   </li><li><p>Let <var>candidate</var> be the result of running the <a href=#sequential-navigation-search-algorithm id=sequential-focus-navigation:sequential-navigation-search-algorithm>sequential navigation search
   algorithm</a> with <var>starting point</var>, <var>direction</var>, and <var>selection
   mechanism</var> as the arguments.</li><li><p>If <var>candidate</var> is not null, then run the <a href=#focusing-steps id=sequential-focus-navigation:focusing-steps>focusing steps</a> for
   <var>candidate</var> and abort these steps.</li><li><p>Otherwise, unset the <a href=#sequential-focus-navigation-starting-point id=sequential-focus-navigation:sequential-focus-navigation-starting-point-3>sequential focus navigation starting point</a>.</li><li>

    <p>If <var>starting point</var> is the <a id=sequential-focus-navigation:top-level-browsing-context-4 href=browsers.html#top-level-browsing-context>top-level browsing context</a>, or a
    <a href=#focusable-area id=sequential-focus-navigation:focusable-area-4>focusable area</a> in the <a id=sequential-focus-navigation:top-level-browsing-context-5 href=browsers.html#top-level-browsing-context>top-level browsing context</a>, the user agent
    should transfer focus to its own controls appropriately (if any), honouring
    <var>direction</var>, and then abort these steps.</p>

    <p class=example>For example, if <var>direction</var> is <i>backward</i>, then the last
    focusable control before the browser's rendering area would be the control to focus.</p>

    <p>If the user agent has no focusable controls — a kiosk-mode browser, for instance
    — 
    then the user agent may instead restart these steps with the <var>starting point</var> being the
    <a id=sequential-focus-navigation:top-level-browsing-context-6 href=browsers.html#top-level-browsing-context>top-level browsing context</a> itself.</p>

    

   </li><li><p>Otherwise, <var>starting point</var> is a <a href=#focusable-area id=sequential-focus-navigation:focusable-area-5>focusable area</a> in a
   <a id=sequential-focus-navigation:nested-browsing-context href=browsers.html#nested-browsing-context>nested browsing context</a>. Let <var>starting point</var> be that
   <a id=sequential-focus-navigation:nested-browsing-context-2 href=browsers.html#nested-browsing-context>nested browsing context</a>'s <a id=sequential-focus-navigation:browsing-context-container href=browsers.html#browsing-context-container>browsing context container</a>, and return to the
   step labeled <i>loop</i>.</p>
    
   </li></ol>


  <p>The <dfn id=sequential-navigation-search-algorithm>sequential navigation search algorithm</dfn> consists of the following steps. This
  algorithm takes three arguments: <var>starting point</var>, <var>direction</var>,
  and <var>selection mechanism</var>.</p>

  <ol><li>

    <p>Pick the appropriate cell from the following table, and follow the instructions in that
    cell.</p>

    <p>The appropriate cell is the one that is from the column whose header describes <var>direction</var> and from the first row whose header describes <var>starting point</var> and <var>selection mechanism</var>.</p>

    <table><thead><tr><th>
       </th><th> <var>direction</var> is <i>forward</i>
       </th><th> <var>direction</var> is <i>backward</i>
     <tbody></th></tr><tr><th><var>starting point</var> is a <a id=sequential-focus-navigation:browsing-context-2 href=browsers.html#browsing-context>browsing context</a>
       <td>Let <var>candidate</var> be the first <a href=#suitable-sequentially-focusable-area id=sequential-focus-navigation:suitable-sequentially-focusable-area>suitable sequentially focusable area</a> in <var>starting point</var>'s <a id=sequential-focus-navigation:active-document href=browsers.html#active-document>active document</a>'s <a href=#primary-control-group id=sequential-focus-navigation:primary-control-group>primary control group</a>, if any; or else null
       
       </td><td>Let <var>candidate</var> be the last <a href=#suitable-sequentially-focusable-area id=sequential-focus-navigation:suitable-sequentially-focusable-area-2>suitable sequentially focusable area</a> in <var>starting point</var>'s <a id=sequential-focus-navigation:active-document-2 href=browsers.html#active-document>active document</a>'s <a href=#primary-control-group id=sequential-focus-navigation:primary-control-group-2>primary control group</a>, if any; or else null
      
      </td></th></tr><tr><th><var>selection mechanism</var> is <i>DOM</i>
       <td>Let <var>candidate</var> be the first <a href=#suitable-sequentially-focusable-area id=sequential-focus-navigation:suitable-sequentially-focusable-area-3>suitable sequentially focusable area</a> in the <a href=#home-control-group id=sequential-focus-navigation:home-control-group>home control group</a> following <var>starting point</var>, if any; or else null
       
       </td><td>Let <var>candidate</var> be the last <a href=#suitable-sequentially-focusable-area id=sequential-focus-navigation:suitable-sequentially-focusable-area-4>suitable sequentially focusable area</a> in the <a href=#home-control-group id=sequential-focus-navigation:home-control-group-2>home control group</a> preceding <var>starting point</var>, if any; or else null
      
      </td></th></tr><tr><th><var>selection mechanism</var> is <i>sequential</i>
       <td>Let <var>candidate</var> be the first <a href=#suitable-sequentially-focusable-area id=sequential-focus-navigation:suitable-sequentially-focusable-area-5>suitable sequentially focusable area</a> in the <a href=#home-sequential-focus-navigation-order id=sequential-focus-navigation:home-sequential-focus-navigation-order>home sequential focus navigation order</a> following <var>starting point</var>, if any; or else null
       
       </td><td>Let <var>candidate</var> be the last <a href=#suitable-sequentially-focusable-area id=sequential-focus-navigation:suitable-sequentially-focusable-area-6>suitable sequentially focusable area</a> in the <a href=#home-sequential-focus-navigation-order id=sequential-focus-navigation:home-sequential-focus-navigation-order-2>home sequential focus navigation order</a> preceding <var>starting point</var>, if any; or else null

    

    </td></th></tr></table>

    <p>A <dfn id=suitable-sequentially-focusable-area>suitable sequentially focusable area</dfn> is a <a href=#focusable-area id=sequential-focus-navigation:focusable-area-6>focusable area</a> whose <a href=#dom-anchor id=sequential-focus-navigation:dom-anchor>DOM
    anchor</a> is not <a href=#inert id=sequential-focus-navigation:inert>inert</a> and that is in its <a href=#control-group id=sequential-focus-navigation:control-group-7>control group</a>'s <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-5>sequential
    focus navigation order</a>.</p>

    <p>The <dfn id=primary-control-group>primary control group</dfn> of a <a href=#control-group-owner-object id=sequential-focus-navigation:control-group-owner-object>control group owner object</a> <var>X</var> is the <a href=#control-group id=sequential-focus-navigation:control-group-8>control group</a> of <var>X</var> if <var>X</var> has no <a href=#dialog-group id=sequential-focus-navigation:dialog-group>dialog group</a> or if its <a href=#dialog-group id=sequential-focus-navigation:dialog-group-2>dialog group</a> has no
    designated <a href=#focused-dialog-of-the-dialog-group id=sequential-focus-navigation:focused-dialog-of-the-dialog-group>focused dialog of the dialog group</a>, otherwise, it is the <a href=#primary-control-group id=sequential-focus-navigation:primary-control-group-3>primary
    control group</a> of <var>X</var>'s <a href=#dialog-group id=sequential-focus-navigation:dialog-group-3>dialog group</a>'s designated
    <a href=#focused-dialog-of-the-dialog-group id=sequential-focus-navigation:focused-dialog-of-the-dialog-group-2>focused dialog of the dialog group</a>.</p>

    <p>The <dfn id=home-control-group>home control group</dfn> is the <a href=#control-group id=sequential-focus-navigation:control-group-9>control group</a> to which <var>starting point</var> belongs.</p>

    <p>The <dfn id=home-sequential-focus-navigation-order>home sequential focus navigation order</dfn> is the <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-6>sequential focus
    navigation order</a> to which <var>starting point</var> belongs.</p>

    <p class=note>The <a href=#home-sequential-focus-navigation-order id=sequential-focus-navigation:home-sequential-focus-navigation-order-3>home sequential focus navigation order</a> is the <a href=#home-control-group id=sequential-focus-navigation:home-control-group-3>home
    control group</a>'s <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-7>sequential focus navigation order</a>, but is only used when the
    <var>starting point</var> is in that <a href=#sequential-focus-navigation-order id=sequential-focus-navigation:sequential-focus-navigation-order-8>sequential focus navigation order</a>
    (when it's not, <var>selection mechanism</var> will be <i>DOM</i>).</p>

   </li><li>

    <p>If <var>candidate</var> is a <a id=sequential-focus-navigation:browsing-context-container-2 href=browsers.html#browsing-context-container>browsing context container</a>, then let <var>new candidate</var> be the result of running the <a href=#sequential-navigation-search-algorithm id=sequential-focus-navigation:sequential-navigation-search-algorithm-2>sequential navigation search
    algorithm</a> with <var>candidate</var>'s <a id=sequential-focus-navigation:nested-browsing-context-3 href=browsers.html#nested-browsing-context>nested browsing context</a> as
    the first argument, <var>direction</var> as the second, and <i>sequential</i> 
    as the third.</p>

    <p>If <var>new candidate</var> is null, then let <var>starting point</var>
    be <var>candidate</var>, and return to the top of this algorithm. Otherwise, let <var>candidate</var> be <var>new candidate</var>.</p>

   </li><li><p><var>candidate</var>を返す。</li></ol>

  



  <h4 id=focus-management-apis>6.4.6 フォーカス管理API</h4>

  <dl class=domintro><dt><var>document</var> . <code id=focus-management-apis:dom-document-activeelement><a href=#dom-document-activeelement>activeElement</a></code><dd>

    <p>キーイベントが送られるまたは送る文書における最も深い要素を返す。大まかに言って、これは文書における被フォーカス要素である。</p>

    <p>このAPIのために、<a id=focus-management-apis:child-browsing-context href=browsers.html#child-browsing-context>子ブラウジングコンテキスト</a>が被フォーカスである場合、その<a id=focus-management-apis:browsing-context-container href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>は<a id=focus-management-apis:parent-browsing-context href=browsers.html#parent-browsing-context>親ブラウジングコンテキスト</a>で<a href=#bc-focus-ergo-bcc-focus>被フォーカス</a>である。たとえば、ユーザーが<code id=focus-management-apis:the-iframe-element><a href=embedded-content.html#the-iframe-element>iframe</a></code>でフォーカスをテキストフィールドに移動する場合、<code id=focus-management-apis:the-iframe-element-2><a href=embedded-content.html#the-iframe-element>iframe</a></code>は<code id=focus-management-apis:the-iframe-element-3><a href=embedded-content.html#the-iframe-element>iframe</a></code>の<a id=focus-management-apis:node-document href=https://triple-underscore.github.io/DOM4-ja.html#concept-node-document data-x-internal=node-document>node document</a>において<code id=focus-management-apis:dom-document-activeelement-2><a href=#dom-document-activeelement>activeElement</a></code> APIによって返される要素である。</p>

   <dt><var>document</var> . <code id=focus-management-apis:dom-document-hasfocus><a href=#dom-document-hasfocus>hasFocus</a></code>()<dd>

    <p>キーイベントが文書を通してまたは文書に向かって送られる場合にtrueを返し、そうでなければfalseを返す。大まかに言って、これは文書、この内側でネストされた文書、被フォーカスに対応する。</p>

   <dt><var>window</var> . <code id=focus-management-apis:dom-window-focus><a href=#dom-window-focus>focus</a></code>()<dd>

    

    <p>可能であれば、フォーカスをウィンドウの<a id=focus-management-apis:browsing-context href=browsers.html#browsing-context>ブラウジングコンテキスト</a>に移動する。</p>

   <dt><var>element</var> . <code id=focus-management-apis:dom-focus><a href=#dom-focus>focus</a></code>()<dd>

    <p>フォーカスを要素に移動する。</p>

    <p>要素が<a id=focus-management-apis:browsing-context-container-2 href=browsers.html#browsing-context-container>ブラウジングコンテキストコンテナ</a>である場合、代わりに<a id=focus-management-apis:nested-browsing-context href=browsers.html#nested-browsing-context>ネストされたブラウジングコンテキスト</a>にフォーカスを移動する。</p>

   <dt><var>element</var> . <code id=focus-management-apis:dom-blur><a href=#dom-blur>blur</a></code>()<dd>

    <p>フォーカスを<a id=focus-management-apis:viewport href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>ビューポート</a>に移動する。このメソッドの使用が妨げられ、<a id=focus-management-apis:viewport-2 href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>ビューポート</a>にフォーカスしたい場合、<code id=focus-management-apis:document><a href=dom.html#document>Document</a></code>の<a id=focus-management-apis:document-element href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>文書要素</a>上の<code id=focus-management-apis:dom-focus-2><a href=#dom-focus>focus()</a></code>メソッドを呼び出す。</p>

    <p>見苦しいフォーカスリングを発見する場合、フォーカスリングを非表示にするためにこの方法を使用してはならない。代わりに、'outline'プロパティを上書きするためにCSS規則を使用し、要素がフォーカスされるものを表示する別の方法を提供する。代替フォーカススタイルが利用可能にならないか、ページが主にキーボードを使用してページをナビゲートする人に対して著しく使用可能にならないか、ページをナビゲートするのに役立つフォーカスアウトラインを使う人の刺客を減少させないかどうかに注意する。</p>

    

    <div class=example>

     <p>たとえば、リンクからアウトラインを隠し、代わりにフォーカスを示すために黄色の背景を使用するために、次を使うことができる：</p>

     <pre>:link:focus, :visited:focus { outline: none; background: yellow; color: black; }</pre>

    </div>

   </dl>

  

  <p>The <dfn id=dom-document-activeelement><code>activeElement</code></dfn> attribute on
  <code id=focus-management-apis:document-2><a href=dom.html#document>Document</a></code> objects must return the value returned by the following steps:</p>

  <ol><li><p>Let <var>candidate</var> be the <code id=focus-management-apis:document-3><a href=dom.html#document>Document</a></code> on which the method was
   invoked.</li><li><p><var>candidate</var>が指定された<a href=#focused-dialog-of-the-dialog-group id=focus-management-apis:focused-dialog-of-the-dialog-group>ダイアロググループの被フォーカスダイアログ</a>をともなう<a href=#dialog-group id=focus-management-apis:dialog-group>ダイアロググループ</a>を持つ場合、<var>candidate</var>を指定された<a href=#focused-dialog-of-the-dialog-group id=focus-management-apis:focused-dialog-of-the-dialog-group-2>ダイアロググループの被フォーカスダイアログ</a>にし、このステップを再実行する。</li><li><p>If <var>candidate</var> has a non-empty <a href=#control-group id=focus-management-apis:control-group>control group</a>, let <var>candidate</var> be the designated <a href=#focused-area-of-the-control-group id=focus-management-apis:focused-area-of-the-control-group>focused area of the control
   group</a>.</p>

   </li><li><p>If <var>candidate</var> is a <a href=#focusable-area id=focus-management-apis:focusable-area>focusable area</a>, let <var>candidate</var> be <var>candidate</var>'s <a href=#dom-anchor id=focus-management-apis:dom-anchor>DOM anchor</a>.</li><li>

    <p>If <var>candidate</var> is a <code id=focus-management-apis:document-4><a href=dom.html#document>Document</a></code> that has a <a href=dom.html#the-body-element-2 id=focus-management-apis:the-body-element-2>body element</a>, then let <var>candidate</var> be <a id=focus-management-apis:the-body-element-2-2 href=dom.html#the-body-element-2>the body
    element</a> of that <code id=focus-management-apis:document-5><a href=dom.html#document>Document</a></code>.</p>

    <p>Otherwise, if <var>candidate</var> is a <code id=focus-management-apis:document-6><a href=dom.html#document>Document</a></code> with a non-null <a id=focus-management-apis:document-element-2 href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>document
    element</a>, then let <var>candidate</var> be that <a id=focus-management-apis:document-element-3 href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>document element</a>.</p>

    <p>Otherwise, if <var>candidate</var> is a <code id=focus-management-apis:document-7><a href=dom.html#document>Document</a></code>, then let <var>candidate</var> be null.</p>

   </li><li><p><var>candidate</var>を返す。</li></ol>

  <p>The <dfn id=dom-document-hasfocus><code>hasFocus()</code></dfn> method on the
  <code id=focus-management-apis:document-8><a href=dom.html#document>Document</a></code> object, when invoked, must return the result of running the <a href=#has-focus-steps id=focus-management-apis:has-focus-steps>has focus
  steps</a> with the <code id=focus-management-apis:document-9><a href=dom.html#document>Document</a></code> object as the argument.</p>

  <p>The <dfn id=dom-window-focus><code>focus()</code></dfn> method on the <code id=focus-management-apis:window><a href=browsers.html#window>Window</a></code>
  object, when invoked, must run the <a href=#focusing-steps id=focus-management-apis:focusing-steps>focusing steps</a> with the <code id=focus-management-apis:window-2><a href=browsers.html#window>Window</a></code>
  object's <a id=focus-management-apis:browsing-context-2 href=browsers.html#browsing-context>browsing context</a>. Additionally, if this <a id=focus-management-apis:browsing-context-3 href=browsers.html#browsing-context>browsing context</a> is a
  <a id=focus-management-apis:top-level-browsing-context href=browsers.html#top-level-browsing-context>top-level browsing context</a>, user agents are encouraged to trigger some sort of
  notification to indicate to the user that the page is attempting to gain focus.</p>

  <p>The <dfn id=dom-window-blur><code>blur()</code></dfn> method on the <code id=focus-management-apis:window-3><a href=browsers.html#window>Window</a></code>
  object, when invoked, provides a hint to the user agent that the script believes the user probably
  is not currently interested in the contents of the <a id=focus-management-apis:browsing-context-4 href=browsers.html#browsing-context>browsing context</a> of the
  <code id=focus-management-apis:window-4><a href=browsers.html#window>Window</a></code> object on which the method was invoked, but that the contents might become
  interesting again in the future.</p>

  <p>User agents are encouraged to ignore calls to this <code id=focus-management-apis:dom-window-blur><a href=#dom-window-blur>blur()</a></code>
  method entirely.</p>

  <p class=note>Historically, the <code id=focus-management-apis:dom-window-blur-2><a href=#dom-window-blur>focus()</a></code> and <code id=focus-management-apis:dom-window-blur-3><a href=#dom-window-blur>blur()</a></code> methods actually affected the system-level focus of the
  system widget (e.g. tab or window) that contained the <a id=focus-management-apis:browsing-context-5 href=browsers.html#browsing-context>browsing context</a>, but hostile
  sites widely abuse this behaviour to the user's detriment.</p>

  <p>The <dfn id=dom-focus><code>focus()</code></dfn> method on elements, when invoked, must
  run the following algorithm:</p>

  <ol><li><p>If the element is marked as <i id=focus-management-apis:locked-for-focus><a href=#locked-for-focus>locked for focus</a></i>, then abort these steps.</li><li><p>Mark the element as <dfn id=locked-for-focus>locked for focus</dfn>.</li><li><p>Run the <a href=#focusing-steps id=focus-management-apis:focusing-steps-2>focusing steps</a> for the element.</li><li><p>Unmark the element as <i id=focus-management-apis:locked-for-focus-2><a href=#locked-for-focus>locked for focus</a></i>.</li></ol>

  <p>The <dfn id=dom-blur><code>blur()</code></dfn> method, when invoked, should run the
  <a href=#unfocusing-steps id=focus-management-apis:unfocusing-steps>unfocusing steps</a> for the element on which the method was called. User agents may
  selectively or uniformly ignore calls to this method for usability reasons.</p>

  <p class=example>For example, if the <code id=focus-management-apis:dom-blur-2><a href=#dom-blur>blur()</a></code> method is unwisely
  being used to remove the focus ring for aesthetics reasons, the page would become unusable by
  keyboard users. Ignoring calls to this method would thus allow keyboard users to interact with the
  page.</p>

  





  <h3 id=assigning-keyboard-shortcuts>6.5 キーボードショートカットの割り当て</h3>

  <h4 id=introduction-8>6.5.1 導入</h4>

  <p><i>この節は非規範的である。</i></p>

  <p>アクティブまたはフォーカスさせることができる各要素は<code id=introduction-8:the-accesskey-attribute><a href=#the-accesskey-attribute>accesskey</a></code>属性を使用して、それをアクティブにするための単一のキーの組み合わせを割り当てることができる。</p>

  <p>正確なショートカットは、ユーザーエージェントによって決定され、ユーザーのキーボードに関する情報に基づき、どのキーボードショートカットが既にプラットフォーム上に存在し、他にどのようなショートカットがページ上で指定され、ガイドとして<code id=introduction-8:the-accesskey-attribute-2><a href=#the-accesskey-attribute>accesskey</a></code>属性に提供された情報を使用する。</p>

  <p>関連するキーボードショートカットが多種多様な入力デバイスで利用可能であることを確実にするために、著者は<code id=introduction-8:the-accesskey-attribute-3><a href=#the-accesskey-attribute>accesskey</a></code>属性で多数の選択肢を提供できる。</p>

  <p>各選択肢は、文字または数字のような、単一の文字で構成される。</p>

  <p>ユーザーエージェントは、キーボードショートカットの一覧をユーザーに提供できるが、著者は行うことも推奨される。<code id=introduction-8:dom-accesskeylabel><a href=#dom-accesskeylabel>accessKeyLabel</a></code> IDL属性は、ユーザーエージェントによって割り当てられた実際のキーの組み合わせを表す文字列を返す。</p>

  <div class=example>

   <p>この例において、著者はショートカットキーを使用して呼び出すことができるボタンを提供してきた。フルキーボードをサポートするために、著者は可能なキーとして"C"を提供している。テンキーのみを搭載したデバイスをサポートするために、著者は別の可能なキーとして"1"を提供している。</p>

   <pre>&lt;input type=button value=Collect onclick="collect()"
       <strong>accesskey="C 1"</strong> id=c&gt;</pre>

  </div>

  <div class=example>

   <p>ショートカットキーが何であるかをユーザーに伝えるために、著者は明示的にボタンのラベルにキーの組み合わせを追加するために選択しているここでのこのスクリプトを持つ。</p>

   <pre>function addShortcutKeyLabel(button) {
<strong>  if (button.accessKeyLabel != '')
    button.value += ' (' + button.accessKeyLabel + ')';</strong>
}
addShortcutKeyLabel(document.getElementById('c'));</pre>

   <p>異なるプラットフォーム上のブラウザーは、たとえ同じキーの組み合わせであっても、そのプラットフォーム上で普及している規則に基づいて異なるラベルを表示する。たとえば、キーの組み合わせが、Controlキー、Shiftキー、および文字Cである場合、Macのブラウザーが"<samp>^⇧C</samp>"を表示するかもしれない一方で、Windowsのブラウザーは"<samp>Ctrl+Shift+C</samp>"を表示するかもしれない。一方でEmacsのブラウザーは単に"<samp>C-C</samp>"を表示するかもしれない。同様に、キーの組み合わせがAltキーとEscキーである場合、Windowsは"<samp>Alt+Esc</samp>"を使用するかもしれず、Macは"<samp>⌥⎋</samp>"を使用するかもしれず、Emacsのブラウザーは、"<samp>M-ESC</samp>"または"<samp>ESC ESC</samp>"を使用するかもしれない。</p>

   <p>したがって、一般に、<code id=introduction-8:dom-accesskeylabel-2><a href=#dom-accesskeylabel>accessKeyLabel</a></code> IDL属性から返された値を解析しようとするのは賢明ではない。</p>

  </div>


  <h4 id=the-accesskey-attribute>6.5.2 <dfn><code>accesskey</code></dfn>属性</h4>

  <p>すべての<a id=the-accesskey-attribute:html-elements href=infrastructure.html#html-elements>HTML要素</a>は、<code id=the-accesskey-attribute:the-accesskey-attribute><a href=#the-accesskey-attribute>accesskey</a></code>コンテンツ属性の設定を持ってもよい。<code id=the-accesskey-attribute:the-accesskey-attribute-2><a href=#the-accesskey-attribute>accesskey</a></code>属性値は、要素をアクティブまたはフォーカスするキーボードショートカットを作成するためのガイドとして、ユーザーエージェントによって使用される。</p>

  <p>指定される場合、値は<a id=the-accesskey-attribute:case-sensitive href=infrastructure.html#case-sensitive>大文字・小文字区別</a>である<a id=the-accesskey-attribute:ordered-set-of-unique-space-separated-tokens href=infrastructure.html#ordered-set-of-unique-space-separated-tokens>一意なスペース区切りトークンの順序付き集合</a>でなければならず、その各々が正確に1つのUnicodeコードポイントの長さでなければならない。</p>

  <div class=example>

   <p>次の例において、サイトを熟知するキーボードユーザーがより迅速に関連するページに移動できるよう、さまざまなリンクがアクセスキーとともに与えられる：</p>

   <pre>&lt;nav&gt;
 &lt;p&gt;
  &lt;a title="Consortium Activities" accesskey="A" href="/Consortium/activities"&gt;Activities&lt;/a&gt; |
  &lt;a title="Technical Reports and Recommendations" accesskey="T" href="/TR/"&gt;Technical Reports&lt;/a&gt; |
  &lt;a title="Alphabetical Site Index" accesskey="S" href="/Consortium/siteindex"&gt;Site Index&lt;/a&gt; |
  &lt;a title="About This Site" accesskey="B" href="/Consortium/"&gt;About Consortium&lt;/a&gt; |
  &lt;a title="Contact Consortium" accesskey="C" href="/Consortium/contact"&gt;Contact&lt;/a&gt;
 &lt;/p&gt;
&lt;/nav&gt;</pre>

  </div>

  <div class=example>

   <p>次の例において、検索フィールドは2つの可能なアクセスキー、"s"と"0"（この順番で）が与えられる。テンキー付きの小さなデバイス上のユーザーエージェントは単なる簡素なキー<kbd><kbd>0</kbd></kbd>を選ぶかもしれないが、フルキーボードを搭載したデバイスでのユーザーエージェントは、ショートカットキーとして<kbd><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>S</kbd></kbd>を選ぶかもしれない：</p>

   <pre>&lt;form action="/search"&gt;
 &lt;label&gt;Search: &lt;input type="search" name="q" accesskey="s 0"&gt;&lt;/label&gt;
 &lt;input type="submit"&gt;
&lt;/form&gt;</pre>

  </div>

  <div class=example>

   <p>次の例において、ボタンは説明可能なアクセスキーを持つ。このスクリプトは次に、ユーザーエージェントが選択したキーの組み合わせを通知するためにボタンのラベルの更新を試みる。</p>

   <pre>&lt;input type=submit accesskey="N @ 1" value="Compose"&gt;
...
&lt;script&gt;
 function labelButton(button) {
   if (button.accessKeyLabel)
     button.value += ' (' + button.accessKeyLabel + ')';
 }
 var inputs = document.getElementsByTagName('input');
 for (var i = 0; i &lt; inputs.length; i += 1) {
   if (inputs[i].type == "submit")
     labelButton(inputs[i]);
 }
&lt;/script&gt;</pre>

   <p>あるユーザーエージェントにおいて、ボタンのラベルは"<samp>Compose（⌘N）</samp>"になるかもしれない。別のものにおいて、これは"<samp>Compose（Alt+⇧+1）</samp>"になるかもしれない。ユーザーエージェントがキーを割り当てない場合、単に"<samp>Compose</samp>"になる。正確な文字列は<a href=#assigned-access-key id=the-accesskey-attribute:assigned-access-key>割り当てられるアクセスキー</a>が何であるか、およびどのようにユーザーエージェントがそのキーの組み合わせを表すかに依存する。</p>

  </div>


  

  <h4 id=keyboard-shortcuts-processing-model>6.5.3 <span id=processing-model-6></span>Processing
  model</h4>

  <p>An element's <dfn id=assigned-access-key>assigned access key</dfn> is a key combination derived from the element's
  <code id=keyboard-shortcuts-processing-model:the-accesskey-attribute><a href=#the-accesskey-attribute>accesskey</a></code> content attribute. Initially, an element must not
  have an <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key>assigned access key</a>.</p>

  <p>Whenever an element's <code id=keyboard-shortcuts-processing-model:the-accesskey-attribute-2><a href=#the-accesskey-attribute>accesskey</a></code> attribute is set, changed,
  or removed, the user agent must update the element's <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-2>assigned access key</a> by running
  the following steps:</p>

  <ol><li><p>If the element has no <code id=keyboard-shortcuts-processing-model:the-accesskey-attribute-3><a href=#the-accesskey-attribute>accesskey</a></code> attribute, then skip
   to the <i>fallback</i> step below.</li><li><p>Otherwise, <a href=infrastructure.html#split-a-string-on-spaces id=keyboard-shortcuts-processing-model:split-a-string-on-spaces>split the attribute's value on
   spaces</a>, and let <var>keys</var> be the resulting tokens.</li><li>

    <p>For each value in <var>keys</var> in turn, in the order the tokens appeared in the
    attribute's value, run the following substeps:</p>

    <ol><li><p>If the value is not a string exactly one Unicode code point in length, then skip the
     remainder of these steps for this value.</li><li><p>If the value does not correspond to a key on the system's keyboard, then skip the
     remainder of these steps for this value.</li><li><p>If the user agent can find a mix of zero or more modifier keys that, combined with the
     key that corresponds to the value given in the attribute, can be used as the access key, then
     the user agent may assign that combination of keys as the element's <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-3>assigned access
     key</a> and abort these steps.
     
     <a id=keyboard-shortcuts-processing-model:fingerprinting-vector title="There is a potential fingerprinting vector here." href=introduction.html#fingerprinting-vector class=fingerprint><img alt="(This is a fingerprinting vector.)" src=https://html.spec.whatwg.org/multipage/images/fingerprint.png width=46 height=64></a>
     </li></ol>

   </li><li><p><i>Fallback</i>: Optionally, the user agent may assign a key combination of its choosing
   as the element's <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-4>assigned access key</a> and then abort these steps.</li><li><p>If this step is reached, the element has no <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-5>assigned access key</a>.</li></ol>

  <p>Once a user agent has selected and assigned an access key for an element, the user agent should
  not change the element's <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-6>assigned access key</a> unless the <code id=keyboard-shortcuts-processing-model:the-accesskey-attribute-4><a href=#the-accesskey-attribute>accesskey</a></code> content attribute is changed or the element is moved to
  another <code id=keyboard-shortcuts-processing-model:document><a href=dom.html#document>Document</a></code>.</p>

  <p>When the user presses the key combination corresponding to the <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-7>assigned access key</a>
  for an element, if the element <a href=forms.html#concept-command id=keyboard-shortcuts-processing-model:concept-command>defines a command</a>, the
  command's <a href=forms.html#command-facet-hiddenstate id=keyboard-shortcuts-processing-model:command-facet-hiddenstate>Hidden State</a> facet is false (visible),
  the command's <a href=forms.html#command-facet-disabledstate id=keyboard-shortcuts-processing-model:command-facet-disabledstate>Disabled State</a> facet is also false
  (enabled), the element is <a id=keyboard-shortcuts-processing-model:in-a-document href=https://triple-underscore.github.io/DOM4-ja.html#in-a-document data-x-internal=in-a-document>in a document</a> that has a <a href=browsers.html#concept-document-bc id=keyboard-shortcuts-processing-model:concept-document-bc>browsing context</a>, and neither the element nor any of its
  ancestors has a <code id=keyboard-shortcuts-processing-model:the-hidden-attribute><a href=#the-hidden-attribute>hidden</a></code> attribute specified, then the user agent
  must trigger the <a href=forms.html#command-facet-action id=keyboard-shortcuts-processing-model:command-facet-action>Action</a> of the command.</p>

  <p class=note>User agents <a href=forms.html#expose-commands-in-ui>might expose</a> elements that have
  an <code id=keyboard-shortcuts-processing-model:the-accesskey-attribute-5><a href=#the-accesskey-attribute>accesskey</a></code> attribute in other ways as well, e.g. in a menu
  displayed in response to a specific key combination.</p> 

  <hr>

  <p>The <dfn id=dom-accesskey><code>accessKey</code></dfn> IDL attribute must
  <a id=keyboard-shortcuts-processing-model:reflect href=infrastructure.html#reflect>reflect</a> the <code id=keyboard-shortcuts-processing-model:the-accesskey-attribute-6><a href=#the-accesskey-attribute>accesskey</a></code> content attribute.</p>

  <p>The <dfn id=dom-accesskeylabel><code>accessKeyLabel</code></dfn> IDL attribute must return
  a string that represents the element's <a href=#assigned-access-key id=keyboard-shortcuts-processing-model:assigned-access-key-8>assigned access key</a>, if any. If the element
  does not have one, then the IDL attribute must return the empty string.</p>

  



  <h3 id=editing-2>6.6 編集</h3>

  <h4 id=contenteditable>6.6.1 編集可能な文書領域を作成する：<code id=contenteditable:attr-contenteditable><a href=#attr-contenteditable>contenteditable</a></code>コンテンツ属性</h4><div class=status><input onclick=toggleStatus(this) value=⋰ type=button><p class=support><strong>Support:</strong> <span class="chrome yes"><span>Chrome</span> <span>4+</span></span><span class="and_chr yes"><span>Chrome for Android</span> <span>51+</span></span><span class="ios_saf yes"><span>iOS Safari</span> <span>5.0-5.1+</span></span><span class="and_uc yes"><span>UC Browser for Android</span> <span>9.9+</span></span><span class="firefox yes"><span>Firefox</span> <span>3.5+</span></span><span class="ie yes"><span>IE</span> <span>5.5+</span></span><span class="op_mini no"><span>Opera Mini</span> <span>None</span></span><span class="samsung yes"><span>Samsung Internet</span> <span>4+</span></span><span class="android yes"><span>Android Browser</span> <span>3+</span></span><span class="safari yes"><span>Safari</span> <span>3.1+</span></span><span class="edge yes"><span>Edge</span> <span>12+</span></span><span class="opera yes"><span>Opera</span> <span>9+</span></span><p class=caniuse>Source: <a href="http://caniuse.com/#feat=contenteditable">caniuse.com</a></div>

  <pre class=idl>[NoInterfaceObject]
interface <dfn id=elementcontenteditable>ElementContentEditable</dfn> {
  [<a id=contenteditable:cereactions href=scripting.html#cereactions>CEReactions</a>] attribute DOMString <a href=#dom-contenteditable id=contenteditable:dom-contenteditable>contentEditable</a>;
  readonly attribute boolean <a href=#dom-iscontenteditable id=contenteditable:dom-iscontenteditable>isContentEditable</a>;
};</pre>

  <p><dfn id=attr-contenteditable><code>contenteditable</code></dfn>コンテンツ属性は、キーワードが空文字列、<code>true</code>、おとび<code>false</code>となる<a id=contenteditable:enumerated-attribute href=infrastructure.html#enumerated-attribute>列挙属性</a>である。空の文字列および<i>true</i>キーワードは、<code>true</code>状態に対応する。<i>false</i>キーワードは、<code>false</code>状態に対応する。さらに、<i>inherit</i>状態という第3の状態が存在する。これは<i id=contenteditable:missing-value-default><a href=infrastructure.html#missing-value-default>欠損値のデフォルト</a></i>（および<i id=contenteditable:invalid-value-default><a href=infrastructure.html#invalid-value-default>不正な値のデフォルト</a></i>）である。</p>

  <p><i>true</i>状態は、要素が編集可能であることを示す。<i>inherit</i>状態は、その親が存在する場合、要素が編集可能であることを示す。<i>false</i>状態は、要素が編集可能でないことを示す。</p>

  <div class=example>
   <p>たとえば、ユーザーがHTMLを使用する記事を書くことが期待される、新しい記事を公開するために<code id=contenteditable:the-form-element><a href=forms.html#the-form-element>form</a></code>および<code id=contenteditable:the-textarea-element><a href=forms.html#the-textarea-element>textarea</a></code>を持つページを考えてみる：</p>

   <pre>&lt;form method=POST&gt;
 &lt;fieldset&gt;
  &lt;legend&gt;New article&lt;/legend&gt;
  &lt;textarea name=article&gt;&amp;lt;p&gt;Hello world.&amp;lt;/p&gt;&lt;/textarea&gt;
 &lt;/fieldset&gt;
 &lt;p&gt;&lt;button&gt;Publish&lt;/button&gt;&lt;/p&gt;
&lt;/form&gt;</pre>

   <p>スクリプトを有効にする場合、<code id=contenteditable:the-textarea-element-2><a href=forms.html#the-textarea-element>textarea</a></code>要素は、<code id=contenteditable:attr-contenteditable-2><a href=#attr-contenteditable>contenteditable</a></code>属性を使用して、代わりにリッチテキストフィールドに置き換えることができる：</p>

   <pre>&lt;form method=POST&gt;
 &lt;fieldset&gt;
  &lt;legend&gt;New article&lt;/legend&gt;
  &lt;textarea id=textarea name=article&gt;&amp;lt;p&gt;Hello world.&amp;lt;/p&gt;&lt;/textarea&gt;
  &lt;div id=div style="white-space: pre-wrap" hidden&gt;&lt;p&gt;Hello world.&lt;/p&gt;&lt;/div&gt;
  &lt;script&gt;
   let textarea = document.getElementById("textarea");
   let div = document.getElementById("div");
   textarea.hidden = true;
   div.hidden = false;
   div.contentEditable = "true";
   div.oninput = (e) =&gt; {
     textarea.value = div.innerHTML;
   };
  &lt;/script&gt;
 &lt;/fieldset&gt;
 &lt;p&gt;&lt;button&gt;Publish&lt;/button&gt;&lt;/p&gt;
&lt;/form&gt;</pre>

   <p>たとえば挿入リンクを挿入する機能は、<code id=contenteditable:execCommand><a data-x-internal=execCommand href=https://w3c.github.io/editing/execCommand.html#execcommand%28%29>document.execCommand()</a></code>APIを使用する、または<code id=contenteditable:selection><a data-x-internal=selection href=https://w3c.github.io/selection-api/#idl-def-Selection>Selection</a></code>APIおよび他のDOM APIを使用して実装することができる。<a href=references.html#refsEXECCOMMAND>[EXECCOMMAND]</a> <a href=references.html#refsSELECTION>[SELECTION]</a> <a href=references.html#refsDOM>[DOM]</a></p>
  </div>

  <div class=example>
   <p><code id=contenteditable:attr-contenteditable-3><a href=#attr-contenteditable>contenteditable</a></code>属性はまた、大きな効果を使用することができる：</p>

   <pre>&lt;!doctype html&gt;
&lt;html lang=en&gt;
&lt;title&gt;Live CSS editing!&lt;/title&gt;
&lt;style style=white-space:pre contenteditable&gt;
html { margin:.2em; font-size:2em; color:lime; background:purple }
head, title, style { display:block }
body { display:none }
&lt;/style&gt;</pre>
  </div>

  <dl class=domintro><dt><var>element</var> . <code id=contenteditable:dom-contenteditable-2><a href=#dom-contenteditable>contentEditable</a></code> [ = <var>value</var> ]<dd>

    <p><code id=contenteditable:attr-contenteditable-4><a href=#attr-contenteditable>contenteditable</a></code>属性の状態に基づいて、"<code>true</code>"、"<code>false</code>"、または"<code>inherit</code>"を返す。</p>

    <p>その状態を変更する設定が可能である。</p>

    <p>新しい値がこれらの文字列のいずれかでない場合、<a id=contenteditable:syntaxerror href=https://triple-underscore.github.io/WebIDL-ja.html#syntaxerror data-x-internal=syntaxerror>"<code>SyntaxError</code>"</a> <code id=contenteditable:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>を投げる。</p>

   <dt><var>element</var> . <code id=contenteditable:dom-iscontenteditable-2><a href=#dom-iscontenteditable>isContentEditable</a></code><dd>

    <p>要素が編集可能な場合にtrueを返す。そうでなければfalseを返す。</p>

   </dl>

  

  <p>The <dfn id=dom-contenteditable><code>contentEditable</code></dfn> IDL attribute, on
  getting, must return the string "<code>true</code>" if the content attribute is set to
  the true state, "<code>false</code>" if the content attribute is set to the false state,
  and "<code>inherit</code>" otherwise. On setting, if the new value is an <a id=contenteditable:ascii-case-insensitive href=infrastructure.html#ascii-case-insensitive>ASCII
  case-insensitive</a> match for the string "<code>inherit</code>" then the content
  attribute must be removed, if the new value is an <a id=contenteditable:ascii-case-insensitive-2 href=infrastructure.html#ascii-case-insensitive>ASCII case-insensitive</a> match for
  the string "<code>true</code>" then the content attribute must be set to the string
  "<code>true</code>", if the new value is an <a id=contenteditable:ascii-case-insensitive-3 href=infrastructure.html#ascii-case-insensitive>ASCII case-insensitive</a> match for
  the string "<code>false</code>" then the content attribute must be set to the string
  "<code>false</code>", and otherwise the attribute setter must throw a
  <a id=contenteditable:syntaxerror-2 href=https://triple-underscore.github.io/WebIDL-ja.html#syntaxerror data-x-internal=syntaxerror>"<code>SyntaxError</code>"</a> <code id=contenteditable:domexception-2><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.</p>

  <p>The <dfn id=dom-iscontenteditable><code>isContentEditable</code></dfn> IDL attribute, on
  getting, must return true if the element is either an <a id=contenteditable:editing-host href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or
  <a id=contenteditable:editable href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a>, and false otherwise.</p>

  



  <h4 id=making-entire-documents-editable:-the-designmode-idl-attribute>6.6.2 文書全体を編集可能にする：<code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode><a href=#designMode>designMode</a></code> IDL属性</h4>

  

  <p>Documents have a <dfn id=designMode><code>designMode</code></dfn>, which can be either enabled or
  disabled.</p>

  

  <dl class=domintro><dt><var>document</var> . <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-2><a href=#designMode>designMode</a></code> [ = <var>value</var> ]<dd>

    <p>文書が編集可能である場合に"<code>on</code>"を返し、ない場合に"<code>off</code>"を返す。</p>

    <p>文書の現在の状態を変更する設定が可能である。これは、文書をフォーカスし、その文書で文書の選択をリセットする。</p>

   </dl>

  

  <p>The <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-3><a href=#designMode>designMode</a></code> IDL attribute on the
  <code id=making-entire-documents-editable:-the-designmode-idl-attribute:document><a href=dom.html#document>Document</a></code> object takes two values, "<code>on</code>" and "<code>off</code>". On setting, the new value must be compared in an <a id=making-entire-documents-editable:-the-designmode-idl-attribute:ascii-case-insensitive href=infrastructure.html#ascii-case-insensitive>ASCII
  case-insensitive</a> manner to these two values; if it matches the "<code>on</code>"
  value, then <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-4><a href=#designMode>designMode</a></code> must be enabled, and if it
  matches the "<code>off</code>" value, then <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-5><a href=#designMode>designMode</a></code> must be disabled. Other values must be
  ignored.</p>

  <p>On getting, if <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-6><a href=#designMode>designMode</a></code> is enabled, the IDL
  attribute must return the value "<code>on</code>"; otherwise it is disabled, and the
  attribute must return the value "<code>off</code>".</p>

  <p>The last state set must persist until the document is destroyed or the state is changed.
  Initially, documents must have their <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-7><a href=#designMode>designMode</a></code>
  disabled.</p>

  <p>When the <code id=making-entire-documents-editable:-the-designmode-idl-attribute:designMode-8><a href=#designMode>designMode</a></code> changes from being disabled to
  being enabled, the user agent must <a id=making-entire-documents-editable:-the-designmode-idl-attribute:immediately href=infrastructure.html#immediately>immediately</a> reset the document's <a id=making-entire-documents-editable:-the-designmode-idl-attribute:active-range href=https://w3c.github.io/editing/execCommand.html#active-range data-x-internal=active-range>active range</a>'s
  start and end boundary points to be at the start of the <code id=making-entire-documents-editable:-the-designmode-idl-attribute:document-2><a href=dom.html#document>Document</a></code> and then run the
  <a href=#focusing-steps id=making-entire-documents-editable:-the-designmode-idl-attribute:focusing-steps>focusing steps</a> for the <a id=making-entire-documents-editable:-the-designmode-idl-attribute:document-element href=https://triple-underscore.github.io/DOM4-ja.html#document-element data-x-internal=document-element>document element</a> of the <code id=making-entire-documents-editable:-the-designmode-idl-attribute:document-3><a href=dom.html#document>Document</a></code>, if
  non-null.</p>

  


  <h4 id=best-practices-for-in-page-editors>6.6.3 ページ内編集者のためのベストプラクティス</h4>

  <p>著者は、もともと値'pre-wrap'へこれら編集のメカニズムを介して作成された<a href=https://w3c.github.io/editing/execCommand.html#editing-host id=best-practices-for-in-page-editors:editing-host data-x-internal=editing-host>編集ホスト</a>およびマークアップ上の<a id="best-practices-for-in-page-editors:'white-space'" href=https://triple-underscore.github.io/css-text-ja.html#white-space-property data-x-internal="'white-space'">'white-space'</a>プロパティを設定することを奨める。デフォルトのHTML空白処理は、あまりWYSIWYG編集に向かず、そして<a id="best-practices-for-in-page-editors:'white-space'-2" href=https://triple-underscore.github.io/css-text-ja.html#white-space-property data-x-internal="'white-space'">'white-space'</a>がデフォルト値のままである場合、いくつかのコーナーの場合において、行の折り返しは正しく動作しない。</p>

  <div class=example>

   <p>デフォルト'normal'値が代わりに使用される場合に発生する問題の例として、単語の間に2つのスペース（ここでは"␣"によって表される）とともに、"<kbd>yellow␣␣ball</kbd>"と入力したユーザーの場合を考える。<a id="best-practices-for-in-page-editors:'white-space'-3" href=https://triple-underscore.github.io/css-text-ja.html#white-space-property data-x-internal="'white-space'">'white-space'</a>のデフォルト値（'normal'）のための場所での編集規則ともに、結果のマークアップは、"<samp>yellow&amp;nbsp;&nbsp;ball</samp>"または"<samp>yellow&nbsp;&amp;nbsp;ball</samp>"のいずれかで構成される。すなわち、2つの単語間の非開票スペースに加えて、通常スペースが存在する。<a id="best-practices-for-in-page-editors:'white-space'-4" href=https://triple-underscore.github.io/css-text-ja.html#white-space-property data-x-internal="'white-space'">'white-space'</a>に対する'normal'値は共に相殺するために隣接する通常スペースを必要とするため、これは必要である。</p>

   <p>前者の場合において、たとえ行の末尾で"<samp>yellow</samp>"単独で一致するとしても、"<samp>yellow⍽</samp>"は次の行（"⍽"は非改行スペースを表すためにここで使用されている）に折り返す。後者の場合において、行の先頭に包まれる場合、"<samp>⍽ball</samp>"は非改行スペース由来の可視インデントを持つだろう。</p>

   <p>しかし、<a id="best-practices-for-in-page-editors:'white-space'-5" href=https://triple-underscore.github.io/css-text-ja.html#white-space-property data-x-internal="'white-space'">'white-space'</a>が'pre-wrap'に設定される場合、編集規則は、代わりに単に単語間に2つの通常のスペースを置き、2つの単語が行末で分割されるべきであり、スペースはレンダリングから削除されてきれいになる。</p>

  </div>



  <h4 id=editing-apis>6.6.4 編集API</h4>

  <p>用語<dfn id=active-range><a href=https://w3c.github.io/editing/execCommand.html#active-range>アクティブ範囲</a></dfn>、<dfn id=editing-host><a href=https://w3c.github.io/editing/execCommand.html#editing-host>編集ホスト</a></dfn>、および<dfn id=editable><a href=https://w3c.github.io/editing/execCommand.html#editable>編集可能</a></dfn>の定義、<a href=https://w3c.github.io/editing/execCommand.html#editing-host id=editing-apis:editing-host data-x-internal=editing-host>編集ホスト</a>または<a id=editing-apis:editable href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>編集可能</a>である要素のユーザーインターフェイス要件、<dfn id=execCommand><a href=https://w3c.github.io/editing/execCommand.html#execcommand%28%29><code>execCommand()</code></a></dfn>、<dfn id=dom-document-querycommandenabled><a href=https://w3c.github.io/editing/execCommand.html#querycommandenabled%28%29><code>queryCommandEnabled()</code></a></dfn>、<dfn id=dom-document-querycommandindeterm><a href=https://w3c.github.io/editing/execCommand.html#querycommandindeterm%28%29><code>queryCommandIndeterm()</code></a></dfn>、<dfn id=dom-document-querycommandstate><a href=https://w3c.github.io/editing/execCommand.html#querycommandstate%28%29><code>queryCommandState()</code></a></dfn>、<dfn id=dom-document-querycommandstate><a href=https://w3c.github.io/editing/execCommand.html#querycommandstate%28%29><code>queryCommandState()</code></a></dfn>、 <dfn id=dom-document-querycommandsupported><a href=https://w3c.github.io/editing/execCommand.html#querycommandsupported%28%29><code>queryCommandSupported()</code></a></dfn>、および<dfn id=dom-document-querycommandvalue><a href=https://w3c.github.io/editing/execCommand.html#querycommandvalue%28%29><code>queryCommandValue()</code></a></dfn>メソッド、テキスト選択、および<dfn id=delete-the-selection><a href=https://w3c.github.io/editing/execCommand.html#delete-the-selection>選択削除</a></dfn>アルゴリズムは、<cite>execCommand</cite>で定義される。<a href=references.html#refsEXECCOMMAND>[EXECCOMMAND]</a></p>



  <h4 id=spelling-and-grammar-checking>6.6.5 スペルと文法チェック</h4><div class=status><input onclick=toggleStatus(this) value=⋰ type=button><p class=support><strong>Support:</strong> <span class="chrome yes"><span>Chrome</span> <span>9+</span></span><span class="and_chr partial"><span><span>Chrome for Android</span> (limited) </span><span>51+</span></span><span class="ios_saf partial"><span><span>iOS Safari</span> (limited) </span><span>3.2+</span></span><span class="and_uc partial"><span><span>UC Browser for Android</span> (limited) </span><span>9.9+</span></span><span class="firefox yes"><span>Firefox</span> <span>2+</span></span><span class="ie yes"><span>IE</span> <span>10+</span></span><span class="op_mini partial"><span><span>Opera Mini</span> (limited) </span><span>all+</span></span><span class="samsung partial"><span><span>Samsung Internet</span> (limited) </span><span>4+</span></span><span class="android partial"><span><span>Android Browser</span> (limited) </span><span>2.1+</span></span><span class="safari yes"><span>Safari</span> <span>5.1+</span></span><span class="edge yes"><span>Edge</span> <span>12+</span></span><span class="opera yes"><span>Opera</span> <span>10.5+</span></span><p class=caniuse>Source: <a href="http://caniuse.com/#feat=spellcheck-attribute">caniuse.com</a></div>

  

  <p>User agents can support the checking of spelling and grammar of editable text, either in form
  controls (such as the value of <code id=spelling-and-grammar-checking:the-textarea-element><a href=forms.html#the-textarea-element>textarea</a></code> elements), or in elements in an <a id=spelling-and-grammar-checking:editing-host href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing
  host</a> (e.g. using <code id=spelling-and-grammar-checking:attr-contenteditable><a href=#attr-contenteditable>contenteditable</a></code>).</p>

  <p>For each element, user agents must establish a <dfn id=concept-spellcheck-default>default
  behaviour</dfn>, either through defaults or through preferences expressed by the user. There are
  three possible default behaviours for each element:</p>

  <dl><dt><dfn id=concept-spellcheck-default-true>true-by-default</dfn>

   <dd>The element will be checked for spelling and grammar if its contents are editable and
   spellchecking is not explicitly disabled through the <code id=spelling-and-grammar-checking:attr-spellcheck><a href=#attr-spellcheck>spellcheck</a></code> attribute.

   

   <dt><dfn id=concept-spellcheck-default-false>false-by-default</dfn>

   <dd>The element will never be checked for spelling and grammar unless spellchecking is
   explicitly enabled through the <code id=spelling-and-grammar-checking:attr-spellcheck-2><a href=#attr-spellcheck>spellcheck</a></code> attribute.

   

   <dt><dfn id=concept-spellcheck-default-inherit>inherit-by-default</dfn>

   <dd>The element's default behaviour is the same as its parent element's. Elements that have no
   parent element cannot have this as their default behaviour.

  

  </dl>

  <hr>

  

  <p><dfn id=attr-spellcheck><code>spellcheck</code></dfn>属性は、キーワードが空文字列、<code>true</code>および<code>false</code>となる<a id=spelling-and-grammar-checking:enumerated-attribute href=infrastructure.html#enumerated-attribute>列挙属性</a>である。空の文字列および<i>true</i>キーワードは、<code>true</code>状態に対応する。<i>false</i>キーワードは、<code>false</code>状態に対応する。さらに、<i>default</i>状態という第3の状態が存在する。これは<i id=spelling-and-grammar-checking:missing-value-default><a href=infrastructure.html#missing-value-default>欠損値のデフォルト</a></i>（および<i id=spelling-and-grammar-checking:invalid-value-default><a href=infrastructure.html#invalid-value-default>不正な値のデフォルト</a></i>）である。</p>

  <p class=note><i>true</i>状態は、要素がそのスペルおよび文法チェックを持つことを示す。<i>default</i>状態は、以下で定義されるように、親要素の独自の<code id=spelling-and-grammar-checking:attr-spellcheck-3><a href=#attr-spellcheck>spellcheck</a></code>状態におそらく基づいて、デフォルトの動作に応じて動作する要素であることを示す。<i>false</i>状態は、要素がチェックされないことを示す。</p>

  

  <hr>

  

  <dl class=domintro><dt><var>element</var> . <code id=spelling-and-grammar-checking:dom-spellcheck><a href=#dom-spellcheck>spellcheck</a></code> [ = <var>value</var> ]<dd>

    <p>要素がスペルや文法チェックを持つ場合はtrueを返す。そうでなければfalseを返す。</p>

    <p>デフォルトを上書きして<code id=spelling-and-grammar-checking:attr-spellcheck-4><a href=#attr-spellcheck>spellcheck</a></code>コンテンツ属性を設定するための、設定が可能である。</p>

   <dt><var>element</var> . <code id=spelling-and-grammar-checking:dom-forcespellcheck><a href=#dom-forcespellcheck>forceSpellCheck</a></code>()<dd>

    <p>ユーザーが要素にフォーカスを当てたことがない場合でも、（チェックが有効である場合）要素のスペルと文法エラーを報告することをユーザーエージェントに強制する。（メソッドが呼び出されない場合、ユーザーエージェントは、単にユーザーによって入力されなかったテキストのエラーを非表示にできる。）</p>

   </dl>

  

  <p>The <dfn id=dom-spellcheck><code>spellcheck</code></dfn> IDL attribute, on getting, must
  return true if the element's <code id=spelling-and-grammar-checking:attr-spellcheck-5><a href=#attr-spellcheck>spellcheck</a></code> content attribute is
  in the <i>true</i> state, or if the element's <code id=spelling-and-grammar-checking:attr-spellcheck-6><a href=#attr-spellcheck>spellcheck</a></code>
  content attribute is in the <i>default</i> state and the element's <a href=#concept-spellcheck-default id=spelling-and-grammar-checking:concept-spellcheck-default>default behaviour</a> is <a href=#concept-spellcheck-default-true id=spelling-and-grammar-checking:concept-spellcheck-default-true>true-by-default</a>, or if the element's <code id=spelling-and-grammar-checking:attr-spellcheck-7><a href=#attr-spellcheck>spellcheck</a></code> content attribute is in the <i>default</i> state and the
  element's <a href=#concept-spellcheck-default id=spelling-and-grammar-checking:concept-spellcheck-default-2>default behaviour</a> is <a href=#concept-spellcheck-default-inherit id=spelling-and-grammar-checking:concept-spellcheck-default-inherit>inherit-by-default</a> and the element's parent
  element's <code id=spelling-and-grammar-checking:dom-spellcheck-2><a href=#dom-spellcheck>spellcheck</a></code> IDL attribute would return true;
  otherwise, if none of those conditions applies, then the attribute must instead return false.</p>

  <p class=note>The <code id=spelling-and-grammar-checking:dom-spellcheck-3><a href=#dom-spellcheck>spellcheck</a></code> IDL attribute is not affected
  by user preferences that override the <code id=spelling-and-grammar-checking:attr-spellcheck-8><a href=#attr-spellcheck>spellcheck</a></code> content
  attribute, and therefore might not reflect the actual spellchecking state.</p>

  <p>On setting, if the new value is true, then the element's <code id=spelling-and-grammar-checking:attr-spellcheck-9><a href=#attr-spellcheck>spellcheck</a></code> content attribute must be set to the literal string
  "<code>true</code>", otherwise it must be set to the literal string "<code>false</code>".

  

  <hr>

  <p>User agents must only consider the following pieces of text as checkable for the purposes of
  this feature:</p>

  <ul><li>The <a href=forms.html#concept-fe-value id=spelling-and-grammar-checking:concept-fe-value>value</a> of <code id=spelling-and-grammar-checking:the-input-element><a href=forms.html#the-input-element>input</a></code> elements whose <code id=spelling-and-grammar-checking:attr-input-type><a href=forms.html#attr-input-type>type</a></code> attributes are in the <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="spelling-and-grammar-checking:text-(type=text)-state-and-search-state-(type=search)">Text</a>, <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="spelling-and-grammar-checking:text-(type=text)-state-and-search-state-(type=search)-2">Search</a>,
   <a href="forms.html#url-state-(type=url)" id="spelling-and-grammar-checking:url-state-(type=url)">URL</a>, or <a href="forms.html#e-mail-state-(type=email)" id="spelling-and-grammar-checking:e-mail-state-(type=email)">E-mail</a> states and that are <i id=spelling-and-grammar-checking:concept-fe-mutable><a href=forms.html#concept-fe-mutable>mutable</a></i> (i.e. that do not have the <code id=spelling-and-grammar-checking:attr-input-readonly><a href=forms.html#attr-input-readonly>readonly</a></code> attribute specified and that are not <a href=forms.html#concept-fe-disabled id=spelling-and-grammar-checking:concept-fe-disabled>disabled</a>).</li><li>The <a href=forms.html#concept-fe-value id=spelling-and-grammar-checking:concept-fe-value-2>value</a> of <code id=spelling-and-grammar-checking:the-textarea-element-2><a href=forms.html#the-textarea-element>textarea</a></code> elements that do not
   have a <code id=spelling-and-grammar-checking:attr-textarea-readonly><a href=forms.html#attr-textarea-readonly>readonly</a></code> attribute and that are not <a href=forms.html#concept-fe-disabled id=spelling-and-grammar-checking:concept-fe-disabled-2>disabled</a>.</li><li>Text in <code id=spelling-and-grammar-checking:text><a data-x-internal=text href=https://triple-underscore.github.io/DOM4-ja.html#interface-text>Text</a></code> nodes that are children of <a href=https://w3c.github.io/editing/execCommand.html#editing-host id=spelling-and-grammar-checking:editing-host-2 data-x-internal=editing-host>editing
   hosts</a> or <a id=spelling-and-grammar-checking:editable href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> elements.</li><li>Text in attributes of <a id=spelling-and-grammar-checking:editable-2 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> elements.</li></ul>

  <p>For text that is part of a <code id=spelling-and-grammar-checking:text-2><a data-x-internal=text href=https://triple-underscore.github.io/DOM4-ja.html#interface-text>Text</a></code> node, the element with which the text is
  associated is the element that is the immediate parent of the first character of the word,
  sentence, or other piece of text. For text in attributes, it is the attribute's element. For the
  values of <code id=spelling-and-grammar-checking:the-input-element-2><a href=forms.html#the-input-element>input</a></code> and <code id=spelling-and-grammar-checking:the-textarea-element-3><a href=forms.html#the-textarea-element>textarea</a></code> elements, it is the element itself.</p>

  <p>To determine if a word, sentence, or other piece of text in an applicable element (as defined
  above) is to have spelling- and grammar-checking enabled, the UA must use the following
  algorithm:</p>

  <ol><li>If the user has disabled the checking for this text, then the checking is disabled.</li><li>Otherwise, if the user has forced the checking for this text to always be enabled, then the
   checking is enabled.</li><li>Otherwise, if the element with which the text is associated has a <code id=spelling-and-grammar-checking:attr-spellcheck-10><a href=#attr-spellcheck>spellcheck</a></code> content attribute, then: if that attribute is in the
   <i>true</i> state, then checking is enabled; otherwise, if that attribute is in the <i>false</i>
   state, then checking is disabled.</li><li>Otherwise, if there is an ancestor element with a <code id=spelling-and-grammar-checking:attr-spellcheck-11><a href=#attr-spellcheck>spellcheck</a></code> content attribute that is not in the <i>default</i>
   state, then: if the nearest such ancestor's <code id=spelling-and-grammar-checking:attr-spellcheck-12><a href=#attr-spellcheck>spellcheck</a></code>
   content attribute is in the <i>true</i> state, then checking is enabled; otherwise, checking is
   disabled.</li><li>Otherwise, if the element's <a href=#concept-spellcheck-default id=spelling-and-grammar-checking:concept-spellcheck-default-3>default behaviour</a>
   is <a href=#concept-spellcheck-default-true id=spelling-and-grammar-checking:concept-spellcheck-default-true-2>true-by-default</a>, then checking is
   enabled.</li><li>Otherwise, if the element's <a href=#concept-spellcheck-default id=spelling-and-grammar-checking:concept-spellcheck-default-4>default behaviour</a>
   is <a href=#concept-spellcheck-default-false id=spelling-and-grammar-checking:concept-spellcheck-default-false>false-by-default</a>, then checking is
   disabled.</li><li>Otherwise, if the element's parent element has <em>its</em> checking enabled, then checking
   is enabled.</li><li>Otherwise, checking is disabled.</li></ol>

  <p>If the checking is enabled for a word/sentence/text, the user agent should indicate spelling
  and grammar errors in that text. User agents should take into account the other semantics given in
  the document when suggesting spelling and grammar corrections. User agents may use the language of
  the element to determine what spelling and grammar rules to use, or may use the user's preferred
  language settings. UAs should use <code id=spelling-and-grammar-checking:the-input-element-3><a href=forms.html#the-input-element>input</a></code> element attributes such as <code id=spelling-and-grammar-checking:attr-input-pattern><a href=forms.html#attr-input-pattern>pattern</a></code> to ensure that the resulting value is valid, where
  possible.</p>

  <p>If checking is disabled, the user agent should not indicate spelling or grammar errors for that
  text.</p>

  <p>Even when checking is enabled, user agents may opt to not report spelling or grammar errors in
  text that the user agent deems the user has no interest in having checked (e.g. text that was
  already present when the page was loaded, or that the user did not type, or text in controls that
  the user has not focused, or in parts of e-mail addresses that the user agent is not confident
  were misspelt). The <dfn id=dom-forcespellcheck><code>forceSpellCheck()</code></dfn> method,
  when invoked on an element, must override this behaviour, forcing the user agent to consider all
  spelling and grammar errors in text in that element for which checking is enabled to be of
  interest to the user.</p>

  <div class=example>

   <p>The element with ID "a" in the following example would be the one used to determine if the
   word "Hello" is checked for spelling errors. In this example, it would not be.</p>

   <pre>&lt;div contenteditable="true"&gt;
 &lt;span spellcheck="false" id="a"&gt;Hell&lt;/span&gt;&lt;em&gt;o!&lt;/em&gt;
&lt;/div&gt;</pre>

   <p>The element with ID "b" in the following example would have checking enabled (the leading
   space character in the attribute's value on the <code id=spelling-and-grammar-checking:the-input-element-4><a href=forms.html#the-input-element>input</a></code> element causes the attribute
   to be ignored, so the ancestor's value is used instead, regardless of the default).</p>

   <pre class=bad>&lt;p spellcheck="true"&gt;
 &lt;label&gt;Name: &lt;input spellcheck=" false" id="b"&gt;&lt;/label&gt;
&lt;/p&gt;</pre>

  </div>

  

  <p class=note>この仕様は、スペルや文法チェッカーに対するユーザーインターフェイスを定義しない。ユーザーエージェントはオンデマンドチェックを提供するかもしれず、チェックが有効である間に連続的なチェックを実行するかもしれず、または他のインターフェイスを使用するかもしれない。</p>


  <h3 id=dnd>6.7 <dfn>ドラッグアンドドロップ</dfn></h3><div class=status><input onclick=toggleStatus(this) value=⋰ type=button><p class=support><strong>Support:</strong> <span class="chrome yes"><span>Chrome</span> <span>4+</span></span><span class="and_chr no"><span>Chrome for Android</span> <span>None</span></span><span class="ios_saf no"><span>iOS Safari</span> <span>None</span></span><span class="and_uc no"><span>UC Browser for Android</span> <span>None</span></span><span class="firefox yes"><span>Firefox</span> <span>3.5+</span></span><span class="ie partial"><span><span>IE</span> (limited) </span><span>5.5+</span></span><span class="op_mini no"><span>Opera Mini</span> <span>None</span></span><span class="samsung no"><span>Samsung Internet</span> <span>None</span></span><span class="android no"><span>Android Browser</span> <span>None</span></span><span class="safari yes"><span>Safari</span> <span>3.1+</span></span><span class="edge partial"><span><span>Edge</span> (limited) </span><span>12+</span></span><span class="opera yes"><span>Opera</span> <span>12+</span></span><p class=caniuse>Source: <a href="http://caniuse.com/#feat=dragndrop">caniuse.com</a></div>



  <p>このセクションは、イベントベースのドラッグアンドドロップのメカニズムを定義する。</p>

  <p>この仕様は、<em>ドラッグアンドドロップ操作</em>が実際に何であるかを正確に定義しない。</p>

  <p>ポインティングデバイスをもつ視覚メディア上に、ドラッグ操作は一連の<code id=dnd:event-mousemove><a data-x-internal=event-mousemove href=https://w3c.github.io/uievents/#event-type-mousemove>mousemove</a></code>イベントが続く<code id=dnd:event-mousedown><a data-x-internal=event-mousedown href=https://w3c.github.io/uievents/#event-type-mousedown>mousedown</a></code>イベントのデフォルトアクションであるかもしれず、ドロップは解放されているマウスによって引き起こされるかもしれない。</p>

  <p>ポインティングデバイス以外の入力モダリティを使用する場合、ユーザーはおそらくドラッグアンドドロップ操作を実行するために明示的に意思表示する必要があり、それらがドラッグを望み、ドロップを望む場所を、それぞれ主張する。</p>

  

  <p>However it is implemented, drag-and-drop operations must have a starting point (e.g. where the
  mouse was clicked, or the start of the selection or element that was selected for the drag), may
  have any number of intermediate steps (elements that the mouse moves over during a drag, or
  elements that the user picks as possible drop points as they cycle through possibilities), and must
  either have an end point (the element above which the mouse button was released, or the element
  that was finally selected), or be canceled. The end point must be the last element selected as a
  possible drop point before the drop occurs (so if the operation is not canceled, there must be at
  least one element in the middle step).</p>

  


  <h4 id=event-drag>6.7.1 導入</h4>

  <p><i>この節は非規範的である。</i></p>

  <p>要素をドラッグ可能にすることは簡単である：要素に<code id=event-drag:the-draggable-attribute><a href=#the-draggable-attribute>draggable</a></code>属性を与え、ドラッグされているデータを格納する<code id=event-drag:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code>ドラッグに対してイベントリスナーを設定する。</p>

  <p>イベントハンドラーは典型的に、それがドラッグされているテキスト選択でないことをチェックする必要があり、次に<code id=event-drag:datatransfer><a href=#datatransfer>DataTransfer</a></code>オブジェクトにデータを格納し、許可される効果（コピー、移動、リンク、またはいくつかの組み合わせ）を設定する必要がある。</p>

  <p>たとえば：</p>

  <pre>&lt;p&gt;What fruits do you like?&lt;/p&gt;
&lt;ol ondragstart="dragStartHandler(event)"&gt;
 &lt;li draggable="true" data-value="fruit-apple"&gt;Apples&lt;/li&gt;
 &lt;li draggable="true" data-value="fruit-orange"&gt;Oranges&lt;/li&gt;
 &lt;li draggable="true" data-value="fruit-pear"&gt;Pears&lt;/li&gt;
&lt;/ol&gt;
&lt;script&gt;
  var internalDNDType = 'text/x-example'; // set this to something specific to your site
  function dragStartHandler(event) {
    if (event.target instanceof HTMLLIElement) {
      // use the element's data-value="" attribute as the value to be moving:
      event.dataTransfer.setData(internalDNDType, event.target.dataset.value);
      event.dataTransfer.effectAllowed = 'move'; // only allow moves
    } else {
      event.preventDefault(); // don't allow selection to be dragged
    }
  }
&lt;/script&gt;</pre>

  <hr>

  <p>ドロップを受け入れるために、ドロップターゲットが<code id=event-drag:the-dropzone-attribute><a href=#the-dropzone-attribute>dropzone</a></code>属性を持ち、かつ<code id=event-drag:event-dnd-drop><a href=#event-dnd-drop>drop</a></code>イベントをリッスンする必要がある。</p>

  <p><code id=event-drag:the-dropzone-attribute-2><a href=#the-dropzone-attribute>dropzone</a></code>属性値は、どのデータの種類を受け入れるか（たとえば任意のテキスト文字列を受け入れる"<code>string:text/plain</code>"、またはPNG画像ファイルを受け入れる"<code>file:image/png</code>"など）およびどのフィードバックの種類を与えるかを指定する（たとえばデータが移動されることを示すために"<code>move</code>"など）。</p>

  <p class=note><code id=event-drag:the-dropzone-attribute-3><a href=#the-dropzone-attribute>dropzone</a></code>属性を使用する代わりに、ドロップターゲットは、<code id=event-drag:event-dnd-dragenter><a href=#event-dnd-dragenter>dragenter</a></code>イベント（ドロップターゲットがドロップを受け入れるかどうかを報告する）および<code id=event-drag:event-dnd-dragover><a href=#event-dnd-dragover>dragover</a></code>イベント（フィードバックがユーザーに表示されるかを指定する）を処理できる。</p>

  <p><code id=event-drag:event-dnd-drop-2><a href=#event-dnd-drop>drop</a></code>イベントは実際のドロップを許可する。このイベントは、<code id=event-drag:dom-datatransfer-dropeffect><a href=#dom-datatransfer-dropeffect>dropEffect</a></code>属性値がソースで使用できるので、キャンセルする必要がある（そうでなければリセットである）。</p>

  <p>たとえば：</p>

  <pre>&lt;p&gt;Drop your favorite fruits below:&lt;/p&gt;
&lt;ol dropzone="move string:text/x-example" ondrop="dropHandler(event)"&gt;
 &lt;!-- don't forget to change the "text/x-example" type to something
 specific to your site --&gt;
&lt;/ol&gt;
&lt;script&gt;
  var internalDNDType = 'text/x-example'; // set this to something specific to your site
  function dropHandler(event) {
    var li = document.createElement('li');
    var data = event.dataTransfer.getData(internalDNDType);
    if (data == 'fruit-apple') {
      li.textContent = 'Apples';
    } else if (data == 'fruit-orange') {
      li.textContent = 'Oranges';
    } else if (data == 'fruit-pear') {
      li.textContent = 'Pears';
    } else {
      li.textContent = 'Unknown Fruit';
    }
    event.target.appendChild(li);
  }
&lt;/script&gt;</pre>

  <hr>

  <p>ディスプレイからオリジナルの要素（ドラッグされたもの）を削除するために、<code id=event-drag:event-dnd-dragend><a href=#event-dnd-dragend>dragend</a></code>イベントを使用できる。</p>

  <p>ここで私たちの例のために、それはそのイベントを処理するために元のマークアップを更新することを意味する：</p>

  <pre>&lt;p&gt;What fruits do you like?&lt;/p&gt;
&lt;ol ondragstart="dragStartHandler(event)" ondragend="dragEndHandler(event)"&gt;
 <em>...as before...</em>
&lt;/ol&gt;
&lt;script&gt;
  function dragStartHandler(event) {
    // <em>...as before...</em>
  }
  function dragEndHandler(event) {
    if (event.dataTransfer.dropEffect == 'move') {
      // remove the dragged element
      event.target.parentNode.removeChild(event.target);
    }
  }
&lt;/script&gt;</pre>



  <h4 id=the-drag-data-store>6.7.2 ドラッグデータストア</h4>

  <p><dfn id=drag-data-store>ドラッグデータストア</dfn>として知られる、ドラッグアンドドロップ操作を支えるデータは次の情報で構成される：</p>

  <ul><li><p>ドラッグされたデータを表すアイテムのリストである<dfn id=drag-data-store-item-list>ドラッグデータストアアイテムリスト</dfn>は、次の情報で構成される：</p>

    <dl><dt><dfn id=the-drag-data-item-kind>ドラッグデータアイテムの種類</dfn><dd>

      <p>データの種類：</p>

      <dl><dt><i>プレーンUnicode文字列</i><dd>
        <p>テキスト。</p>
       <dt><i>File</i><dd>
        <p>ファイル名をもつバイナリーデータ。</p>
       </dl>

     <dt><dfn id=the-drag-data-item-type-string>ドラッグデータ項目型文字列</dfn><dd>

      <p>一般に<a id=the-drag-data-store:mime-type href=infrastructure.html#mime-type>MIMEタイプ</a>で指定される、データ型やフォーマットを与えるユニコード文字列。<a href=infrastructure.html#mime-type id=the-drag-data-store:mime-type-2>MIMEタイプ</a>でない一部の値は、レガシー理由により特別扱いされる。APIは<a href=infrastructure.html#mime-type id=the-drag-data-store:mime-type-3>MIMEタイプ</a>の使用を強制しない。他の値も同様に使用できる。しかし、すべての場合において値は、APIによってすべて<a id=the-drag-data-store:converted-to-ascii-lowercase href=infrastructure.html#converted-to-ascii-lowercase>ASCII小文字に変換される</a>。</p>

      <p class=note><a href=infrastructure.html#space-character id=the-drag-data-store:space-character>空白文字</a>を含む文字列は、<code id=the-drag-data-store:the-dropzone-attribute><a href=#the-dropzone-attribute>dropzone</a></code>属性とともに使用できないので、著者は<a href=infrastructure.html#mime-type id=the-drag-data-store:mime-type-4>MIMEタイプ</a>のみまたは（スペースなしの）カスタム文字列を使用するよう推奨される。</p>

      <p><a href=#the-drag-data-item-type-string id=the-drag-data-store:the-drag-data-item-type-string>項目型文字列</a>ごとに1つの<i>プレーンUnicode文字列</i>の制限が存在する。</p> 

     <dt>実際のデータ<dd><p>ファイル名（それ自体Unicode文字列）をもつ一部の場合において、<a href=#the-drag-data-item-kind id=the-drag-data-store:the-drag-data-item-kind>ドラッグデータアイテムの種類</a>ごとのように、Unicodeまたはバイナリー文字列。</dl>

    <p><a href=#drag-data-store-item-list id=the-drag-data-store:drag-data-store-item-list>ドラッグデータストア項目リスト</a>は、項目がリストに追加された順序で並べられ、最近では最後に追加された。</p>

   </li><li>

    <p>ドラッグ中のUIフィードバックを生成するために使用される、以下の情報：</p>

    <ul><li><dfn id=drag-data-store-default-feedback>ドラッグデータストアのデフォルトフィードバック</dfn>として知られる、ユーザーエージェント定義のデフォルトフィードバック情報。</li><li>任意で、<dfn id=drag-data-store-bitmap>ドラッグデータストアビットマップ</dfn>および<dfn id=drag-data-store-hot-spot-coordinate>ドラッグデータストアホットスポット座標</dfn>として知られる、そのイメージ内にあるビットマップ画像とポイント座標。</li></ul>

   </li><li>

    <p>次のいずれかである<dfn id=drag-data-store-mode>ドラッグデータストアモード</dfn>：</p>

    <dl><dt><dfn id=concept-dnd-rw>読み書きモード</dfn><dd>

      <p><code id=the-drag-data-store:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code>イベントに対して。新しいデータは<a href=#drag-data-store id=the-drag-data-store:drag-data-store>ドラッグデータストア</a>に追加できる。</p>

     <dt><dfn id=concept-dnd-ro>読み取り専用モード</dfn><dd>

      <p><code id=the-drag-data-store:event-dnd-drop><a href=#event-dnd-drop>drop</a></code>イベントに対して。ドラッグされたデータを表す項目のリストは、データも含めて、読み取り可能である。新たなデータは追加できない。</p>

     <dt><dfn id=concept-dnd-p>保護モード</dfn><dd>

      <p>他のすべてのイベントに対して。ドラッグされたデータを表す項目の<a href=#drag-data-store id=the-drag-data-store:drag-data-store-2>ドラッグデータストア</a>リストで形式および種類は列挙されるが、データ自体が使用できず、新たなデータは追加できない。</p>

     </dl>

   </li><li>

    <p>文字列である、<dfn id=drag-data-store-allowed-effects-state>ドラッグデータストアの許可された効果の状態</dfn>。</p>

   </li></ul>

  <p><a href=#drag-data-store id=the-drag-data-store:drag-data-store-3>ドラッグデータストア</a>が<dfn id=create-a-drag-data-store>作成</dfn>された場合、それはその<a href=#drag-data-store-item-list id=the-drag-data-store:drag-data-store-item-list-2>ドラッグデータストアアイテムリスト</a>が空であるように初期化されなければならず、それは<a href=#drag-data-store-default-feedback id=the-drag-data-store:drag-data-store-default-feedback>ドラッグデータストアのデフォルトフィードバック</a>を持たず、<a href=#drag-data-store-bitmap id=the-drag-data-store:drag-data-store-bitmap>ドラッグデータストアのビットマップ</a>および<a href=#drag-data-store-hot-spot-coordinate id=the-drag-data-store:drag-data-store-hot-spot-coordinate>ドラッグデータストアのホットスポット座標</a>を持たず、その<a href=#drag-data-store-mode id=the-drag-data-store:drag-data-store-mode>ドラッグデータストアモード</a>は<a href=#concept-dnd-p id=the-drag-data-store:concept-dnd-p>保護モード</a>であり、その<a href=#drag-data-store-allowed-effects-state id=the-drag-data-store:drag-data-store-allowed-effects-state>ドラッグデータストアの許可された効果の状態</a>は文字列"<code id=the-drag-data-store:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>"である。</p>


  <h4 id=the-datatransfer-interface>6.7.3 <code id=the-datatransfer-interface:datatransfer><a href=#datatransfer>DataTransfer</a></code>インターフェイス</h4>

  <p><code id=the-datatransfer-interface:datatransfer-2><a href=#datatransfer>DataTransfer</a></code>オブジェクトは、ドラッグアンドドロップ操作を支える<a href=#drag-data-store id=the-datatransfer-interface:drag-data-store>ドラッグデータストア</a>を公開するために使用される。</p>

  <pre class=idl>interface <dfn id=datatransfer>DataTransfer</dfn> {
  attribute DOMString <a href=#dom-datatransfer-dropeffect id=the-datatransfer-interface:dom-datatransfer-dropeffect>dropEffect</a>;
  attribute DOMString <a href=#dom-datatransfer-effectallowed id=the-datatransfer-interface:dom-datatransfer-effectallowed>effectAllowed</a>;

  [SameObject] readonly attribute <a href=#datatransferitemlist id=the-datatransfer-interface:datatransferitemlist>DataTransferItemList</a> <a href=#dom-datatransfer-items id=the-datatransfer-interface:dom-datatransfer-items>items</a>;

  void <a href=#dom-datatransfer-setdragimage id=the-datatransfer-interface:dom-datatransfer-setdragimage>setDragImage</a>(Element image, long x, long y);

  /* old interface */
  [SameObject] readonly attribute DOMString[] <a href=#dom-datatransfer-types id=the-datatransfer-interface:dom-datatransfer-types>types</a>;
  DOMString <a href=#dom-datatransfer-getdata id=the-datatransfer-interface:dom-datatransfer-getdata>getData</a>(DOMString format);
  void <a href=#dom-datatransfer-setdata id=the-datatransfer-interface:dom-datatransfer-setdata>setData</a>(DOMString format, DOMString data);
  void <a href=#dom-datatransfer-cleardata id=the-datatransfer-interface:dom-datatransfer-cleardata>clearData</a>(optional DOMString format);
  [SameObject] readonly attribute <a id=the-datatransfer-interface:filelist href=https://triple-underscore.github.io/File_API-ja.html#filelist-section data-x-internal=filelist>FileList</a> <a href=#dom-datatransfer-files id=the-datatransfer-interface:dom-datatransfer-files>files</a>;
};</pre>

  <dl class=domintro><dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-dropeffect-2><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> [ = <var>value</var> ]<dd>

    <p>現在選択されている操作の種類を返す。操作の種類が<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-2><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code>属性によって許可されるものの1つでない場合、操作は失敗する。</p>

    <p>選択した操作を変更す設定が可能である。</p>

    <p>可能な値は、"<code id=the-datatransfer-interface:dom-datatransfer-dropeffect-none><a href=#dom-datatransfer-dropeffect-none>none</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-dropeffect-copy><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-dropeffect-link><a href=#dom-datatransfer-dropeffect-link>link</a></code>"、および"<code id=the-datatransfer-interface:dom-datatransfer-dropeffect-move><a href=#dom-datatransfer-dropeffect-move>move</a></code>"である。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-effectallowed-3><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> [ = <var>value</var> ]<dd>

    <p>許可される操作の種類を返す。</p>

    <p>許可される操作を変更するために、（<code id=the-datatransfer-interface:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code>イベント中に）設定可能である。</p>

    <p>可能な値は、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-none><a href=#dom-datatransfer-effectallowed-none>none</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-copy><a href=#dom-datatransfer-effectallowed-copy>copy</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-copylink><a href=#dom-datatransfer-effectallowed-copylink>copyLink</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-copymove><a href=#dom-datatransfer-effectallowed-copymove>copyMove</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-link><a href=#dom-datatransfer-effectallowed-link>link</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-linkmove><a href=#dom-datatransfer-effectallowed-linkmove>linkMove</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-move><a href=#dom-datatransfer-effectallowed-move>move</a></code>"、"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-all><a href=#dom-datatransfer-effectallowed-all>all</a></code>"、および"<code id=the-datatransfer-interface:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>"である。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-items-2><a href=#dom-datatransfer-items>items</a></code><dd>

    <p>ドラッグデータとともに、<code id=the-datatransfer-interface:datatransferitemlist-2><a href=#datatransferitemlist>DataTransferItemList</a></code>オブジェクトを返す。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-setdragimage-2><a href=#dom-datatransfer-setdragimage>setDragImage</a></code>(<var>element</var>, <var>x</var>, <var>y</var>)<dd>

    <p>以前に指定されたフィードバックを置換し、ドラッグフィードバックを更新するために指定された要素を使用する。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-types-2><a href=#dom-datatransfer-types>types</a></code><dd>

    <p><code id=the-datatransfer-interface:event-dnd-dragstart-2><a href=#event-dnd-dragstart>dragstart</a></code>イベントで設定されたフォーマットを列挙する配列を返す。さらに、任意のファイルがドラッグされている場合、型の1つは文字列"<code>Files</code>"となる。</p>

   <dt><var>data</var> = <var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-getdata-2><a href=#dom-datatransfer-getdata>getData</a></code>(<var>format</var>)<dd>

    <p>指定されたデータを返す。そのようなデータが存在しない場合、空の文字列を返す。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-setdata-2><a href=#dom-datatransfer-setdata>setData</a></code>(<var>format</var>, <var>data</var>)<dd>

    <p>指定されたデータを追加する。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-cleardata-2><a href=#dom-datatransfer-cleardata>clearData</a></code>( [ <var>format</var> ] )<dd>

    <p>指定した書式のデータを削除する。引数が省略された場合、すべてのデータを削除する。</p>

   <dt><var>dataTransfer</var> . <code id=the-datatransfer-interface:dom-datatransfer-files-2><a href=#dom-datatransfer-files>files</a></code><dd>

    <p>もしあれば、ドラッグされているファイルの<code id=the-datatransfer-interface:filelist-2><a data-x-internal=filelist href=https://triple-underscore.github.io/File_API-ja.html#filelist-section>FileList</a></code>を返す。</p>

   </dl>

  <p><code id=the-datatransfer-interface:datatransfer-3><a href=#datatransfer>DataTransfer</a></code>オブジェクトは<a href=#dndevents>ドラッグアンドドロップイベント</a>の間に使用され、それらのイベントが発生している間のみ有効である。</p>

  

  <p>A <code id=the-datatransfer-interface:datatransfer-4><a href=#datatransfer>DataTransfer</a></code> object is associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-2>drag data store</a> while it
  is valid.</p>

  <p>The <dfn id=dom-datatransfer-dropeffect><code>dropEffect</code></dfn> attribute controls
  the drag-and-drop feedback that the user is given during a drag-and-drop operation. When the
  <code id=the-datatransfer-interface:datatransfer-5><a href=#datatransfer>DataTransfer</a></code> object is created, the <code id=the-datatransfer-interface:dom-datatransfer-dropeffect-3><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attribute is set to a string value. On
  getting, it must return its current value. On setting, if the new value is one of "<dfn id=dom-datatransfer-dropeffect-none><code>none</code></dfn>", "<dfn id=dom-datatransfer-dropeffect-copy><code>copy</code></dfn>", "<dfn id=dom-datatransfer-dropeffect-link><code>link</code></dfn>", or "<dfn id=dom-datatransfer-dropeffect-move><code>move</code></dfn>", then the attribute's current value must be
  set to the new value. Other values must be ignored.</p>

  <p>The <dfn id=dom-datatransfer-effectallowed><code>effectAllowed</code></dfn> attribute is
  used in the drag-and-drop processing model to initialise the <code id=the-datatransfer-interface:dom-datatransfer-dropeffect-4><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attribute during the <code id=the-datatransfer-interface:event-dnd-dragenter><a href=#event-dnd-dragenter>dragenter</a></code> and <code id=the-datatransfer-interface:event-dnd-dragover><a href=#event-dnd-dragover>dragover</a></code> events. When the <code id=the-datatransfer-interface:datatransfer-6><a href=#datatransfer>DataTransfer</a></code> object is
  created, the <code id=the-datatransfer-interface:dom-datatransfer-effectallowed-4><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> attribute is set
  to a string value. On getting, it must return its current value. On setting, if <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-3>drag data
  store</a>'s <a href=#drag-data-store-mode id=the-datatransfer-interface:drag-data-store-mode>mode</a> is the <a href=#concept-dnd-rw id=the-datatransfer-interface:concept-dnd-rw>read/write mode</a> and the new value is one of "<dfn id=dom-datatransfer-effectallowed-none><code>none</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-copy><code>copy</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-copylink><code>copyLink</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-copymove><code>copyMove</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-link><code>link</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-linkmove><code>linkMove</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-move><code>move</code></dfn>", "<dfn id=dom-datatransfer-effectallowed-all><code>all</code></dfn>", or "<dfn id=dom-datatransfer-effectallowed-uninitialized><code>uninitialized</code></dfn>", then the attribute's
  current value must be set to the new value. Otherwise it must be left unchanged.</p>

  <p>The <dfn id=dom-datatransfer-items><code>items</code></dfn> attribute must return a
  <code id=the-datatransfer-interface:datatransferitemlist-3><a href=#datatransferitemlist>DataTransferItemList</a></code> object associated with the <code id=the-datatransfer-interface:datatransfer-7><a href=#datatransfer>DataTransfer</a></code> object.</p>

  <p>The <dfn id=dom-datatransfer-setdragimage><code>setDragImage(<var>element</var>,
  <var>x</var>, <var>y</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the <code id=the-datatransfer-interface:datatransfer-8><a href=#datatransfer>DataTransfer</a></code> object is no longer associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-4>drag data
   store</a>, abort these steps. Nothing happens.</li><li><p>If the <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-5>drag data store</a>'s <a href=#drag-data-store-mode id=the-datatransfer-interface:drag-data-store-mode-2>mode</a> is
   not the <a href=#concept-dnd-rw id=the-datatransfer-interface:concept-dnd-rw-2>read/write mode</a>, abort these steps. Nothing
   happens.</li><li><p>If the <var>element</var> argument is an <code id=the-datatransfer-interface:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element, then set the <a href=#drag-data-store-bitmap id=the-datatransfer-interface:drag-data-store-bitmap>drag
   data store bitmap</a> to the element's image (at its
   <a href=https://momdo.github.io/css2/conform.html#intrinsic id=the-datatransfer-interface:intrinsic-dimensions data-x-internal=intrinsic-dimensions>intrinsic size</a>); otherwise, set the
   <a href=#drag-data-store-bitmap id=the-datatransfer-interface:drag-data-store-bitmap-2>drag data store bitmap</a> to an image generated from the given element (the exact
   mechanism for doing so is not currently specified).</li><li><p>Set the <a href=#drag-data-store-hot-spot-coordinate id=the-datatransfer-interface:drag-data-store-hot-spot-coordinate>drag data store hot spot coordinate</a> to the given <var>x</var>,
   <var>y</var> coordinate.</li></ol>

  <p>The <dfn id=dom-datatransfer-types><code>types</code></dfn> attribute must return a
  <a id=the-datatransfer-interface:live href=infrastructure.html#live>live</a> <a href=infrastructure.html#dfn-read-only-array id=the-datatransfer-interface:dfn-read-only-array>read only</a> array giving the strings
  that the following steps would produce.</p>

  <ol><li><p>Start with an empty list <var>L</var>.</li><li><p>If the <code id=the-datatransfer-interface:datatransfer-9><a href=#datatransfer>DataTransfer</a></code> object is no longer associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-6>drag data
   store</a>, the array is empty. Abort these steps; return the empty list <var>L</var>.</li><li><p>For each item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list>drag data store item list</a> 
   whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind>kind</a> is <i>Plain Unicode string</i>, add an
   entry to the list <var>L</var> consisting of the item's <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string>type string</a>.</li><li><p>If there are any items in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-2>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-2>kind</a> is <i>File</i>, then add an entry to the list
   <var>L</var> consisting of the string "<code>Files</code>". (This value can be
   distinguished from the other values because it is not lowercase.)</li><li><p>The strings produced by these steps are those in the list <var>L</var>.</li></ol>

  <p>The <dfn id=dom-datatransfer-getdata><code>getData(<var>format</var>)</code></dfn> method
  must run the following steps:</p>

  <ol><li><p>If the <code id=the-datatransfer-interface:datatransfer-10><a href=#datatransfer>DataTransfer</a></code> object is no longer associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-7>drag data
   store</a>, return the empty string and abort these steps.</li><li><p>If the <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-8>drag data store</a>'s <a href=#drag-data-store-mode id=the-datatransfer-interface:drag-data-store-mode-3>mode</a> is
   the <a href=#concept-dnd-p id=the-datatransfer-interface:concept-dnd-p>protected mode</a>, return the empty string and abort these
   steps.</li><li><p>Let <var>format</var> be the first argument, <a id=the-datatransfer-interface:converted-to-ascii-lowercase href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII
   lowercase</a>.</li><li><p>Let <var>convert-to-URL</var> be false.</li><li><p>If <var>format</var> equals "<code>text</code>", change it to "<code>text/plain</code>".</li><li><p>If <var>format</var> equals "<code>url</code>", change it to "<code>text/uri-list</code>" and set <var>convert-to-URL</var> to true.</li><li><p>If there is no item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-3>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-3>kind</a> is <i>Plain Unicode string</i> and whose <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string-2>type string</a> is equal to <var>format</var>, return the empty string
   and abort these steps.</li><li><p>Let <var>result</var> be the data of the item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-4>drag data store item
   list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-4>kind</a> is <i>Plain Unicode
   string</i> and whose <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string-3>type string</a> is equal to
   <var>format</var>.</li><li><p>If <var>convert-to-URL</var> is true, then parse <var>result</var> as appropriate for
   <code>text/uri-list</code> data, and then set <var>result</var> to the first URL from
   the list, if any, or the empty string otherwise. <a href=references.html#refsRFC2483>[RFC2483]</a></li><li><p>Return <var>result</var>.</li></ol>

  <p>The <dfn id=dom-datatransfer-setdata><code>setData(<var>format</var>,
  <var>data</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the <code id=the-datatransfer-interface:datatransfer-11><a href=#datatransfer>DataTransfer</a></code> object is no longer associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-9>drag data
   store</a>, abort these steps. Nothing happens.</li><li><p>If the <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-10>drag data store</a>'s <a href=#drag-data-store-mode id=the-datatransfer-interface:drag-data-store-mode-4>mode</a> is
   not the <a href=#concept-dnd-rw id=the-datatransfer-interface:concept-dnd-rw-3>read/write mode</a>, abort these steps. Nothing
   happens.</li><li><p>Let <var>format</var> be the first argument, <a id=the-datatransfer-interface:converted-to-ascii-lowercase-2 href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII
   lowercase</a>.</li><li>

    <p>If <var>format</var> equals "<code>text</code>", change it to "<code>text/plain</code>".</p>

    <p>If <var>format</var> equals "<code>url</code>", change it to "<code>text/uri-list</code>".</p>

   </li><li><p>Remove the item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-5>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-5>kind</a> is <i>Plain Unicode string</i> and whose <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string-4>type string</a> is equal to <var>format</var>, if there is
   one.</li><li><p>Add an item to the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-6>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-6>kind</a> is <i>Plain Unicode string</i>, whose <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string-5>type string</a> is equal to <var>format</var>, and whose data is the string
   given by the method's second argument.</li></ol>

  <p>The <dfn id=dom-datatransfer-cleardata><code>clearData()</code></dfn> method must run the
  following steps:</p>

  <ol><li><p>If the <code id=the-datatransfer-interface:datatransfer-12><a href=#datatransfer>DataTransfer</a></code> object is no longer associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-11>drag data
   store</a>, abort these steps. Nothing happens.</li><li><p>If the <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-12>drag data store</a>'s <a href=#drag-data-store-mode id=the-datatransfer-interface:drag-data-store-mode-5>mode</a> is
   not the <a href=#concept-dnd-rw id=the-datatransfer-interface:concept-dnd-rw-4>read/write mode</a>, abort these steps. Nothing
   happens.</li><li><p>If the method was called with no arguments, remove each item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-7>drag data store
   item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-7>kind</a> is <i>Plain Unicode
   string</i>, and abort these steps.</li><li><p>Let <var>format</var> be the first argument, <a id=the-datatransfer-interface:converted-to-ascii-lowercase-3 href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII
   lowercase</a>.</li><li>

    <p>If <var>format</var> equals "<code>text</code>", change it to "<code>text/plain</code>".</p>

    <p>If <var>format</var> equals "<code>url</code>", change it to "<code>text/uri-list</code>".</p>

   </li><li><p>Remove the item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-8>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-8>kind</a> is <i>Plain Unicode string</i> and whose <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string-6>type string</a> is equal to <var>format</var>, if there is
   one.</li></ol>

  <p class=note>The <code id=the-datatransfer-interface:dom-datatransfer-cleardata-3><a href=#dom-datatransfer-cleardata>clearData()</a></code> method does not
  affect whether any files were included in the drag, so the <code id=the-datatransfer-interface:dom-datatransfer-types-3><a href=#dom-datatransfer-types>types</a></code> attribute's list might still not be empty after
  calling <code id=the-datatransfer-interface:dom-datatransfer-cleardata-4><a href=#dom-datatransfer-cleardata>clearData()</a></code> (it would still contain the
  "<code>Files</code>" string if any files were included in the drag).</p>

  <p>The <dfn id=dom-datatransfer-files><code>files</code></dfn> attribute must return a
  <a id=the-datatransfer-interface:live-2 href=infrastructure.html#live>live</a> <code id=the-datatransfer-interface:filelist-3><a data-x-internal=filelist href=https://triple-underscore.github.io/File_API-ja.html#filelist-section>FileList</a></code> sequence consisting of <code id=the-datatransfer-interface:file><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code> objects
  representing the files found by the following steps.
  Furthermore, for a given <code id=the-datatransfer-interface:filelist-4><a data-x-internal=filelist href=https://triple-underscore.github.io/File_API-ja.html#filelist-section>FileList</a></code> object and a given underlying file, the same
  <code id=the-datatransfer-interface:file-2><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code> object must be used each time.</p>

  <ol><li><p>Start with an empty list <var>L</var>.</li><li><p>If the <code id=the-datatransfer-interface:datatransfer-13><a href=#datatransfer>DataTransfer</a></code> object is no longer associated with a <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-13>drag data
   store</a>, the <code id=the-datatransfer-interface:filelist-5><a data-x-internal=filelist href=https://triple-underscore.github.io/File_API-ja.html#filelist-section>FileList</a></code> is empty. Abort these steps; return the empty list <var>L</var>.</li><li><p>If the <a href=#drag-data-store id=the-datatransfer-interface:drag-data-store-14>drag data store</a>'s <a href=#drag-data-store-mode id=the-datatransfer-interface:drag-data-store-mode-6>mode</a> is
   the <a href=#concept-dnd-p id=the-datatransfer-interface:concept-dnd-p-2>protected mode</a>, abort these steps; return the empty list
   <var>L</var>.</li><li><p>For each item in the <a href=#drag-data-store-item-list id=the-datatransfer-interface:drag-data-store-item-list-9>drag data store item list</a> 
   whose <a href=#the-drag-data-item-kind id=the-datatransfer-interface:the-drag-data-item-kind-9>kind</a> is <i>File</i> , add the item's data (the file, in particular its name and contents, as well as
   its <a href=#the-drag-data-item-type-string id=the-datatransfer-interface:the-drag-data-item-type-string-7>type</a>) to the list <var>L</var>.</li><li><p>The files found by these steps are those in the list <var>L</var>.</li></ol>

  <p class=note>This version of the API does not expose the types of the files during the
  drag.</p>

  


  <h5 id=the-datatransferitemlist-interface>6.7.3.1 <code id=the-datatransferitemlist-interface:datatransferitemlist><a href=#datatransferitemlist>DataTransferItemList</a></code>インターフェイス</h5>

  <p>各<code id=the-datatransferitemlist-interface:datatransfer><a href=#datatransfer>DataTransfer</a></code>オブジェクトは<code id=the-datatransferitemlist-interface:datatransferitemlist-2><a href=#datatransferitemlist>DataTransferItemList</a></code>オブジェクトに関連付けられる。</p>

  <pre class=idl>interface <dfn id=datatransferitemlist>DataTransferItemList</dfn> {
  readonly attribute unsigned long <a href=#dom-datatransferitemlist-length id=the-datatransferitemlist-interface:dom-datatransferitemlist-length>length</a>;
  <a href=#dom-datatransferitemlist-item>getter</a> <a href=#datatransferitem id=the-datatransferitemlist-interface:datatransferitem>DataTransferItem</a> (unsigned long index);
  <a href=#datatransferitem id=the-datatransferitemlist-interface:datatransferitem-2>DataTransferItem</a>? <a href=#dom-datatransferitemlist-add id=the-datatransferitemlist-interface:dom-datatransferitemlist-add>add</a>(DOMString data, DOMString type);
  <a href=#datatransferitem id=the-datatransferitemlist-interface:datatransferitem-3>DataTransferItem</a>? <a href=#dom-datatransferitemlist-add id=the-datatransferitemlist-interface:dom-datatransferitemlist-add-2>add</a>(<a id=the-datatransferitemlist-interface:file href=https://triple-underscore.github.io/File_API-ja.html#file data-x-internal=file>File</a> data);
  void <a href=#dom-datatransferitemlist-remove id=the-datatransferitemlist-interface:dom-datatransferitemlist-remove>remove</a>(unsigned long index);
  void <a href=#dom-datatransferitemlist-clear id=the-datatransferitemlist-interface:dom-datatransferitemlist-clear>clear</a>();
};</pre>

  <dl class=domintro><dt><var>items</var> . <code id=the-datatransferitemlist-interface:dom-datatransferitemlist-length-2><a href=#dom-datatransferitemlist-length>length</a></code><dd><p><a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store>ドラッグデータストア</a>内のアイテムの数を返す。<dt><var>items</var>[<var>index</var>]<dd>

    <p><a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-2>ドラッグデータストア</a>内の<var>index</var>番目のエントリを表す<code id=the-datatransferitemlist-interface:datatransferitem-4><a href=#datatransferitem>DataTransferItem</a></code>オブジェクトを返す。</p>

   <dt><var>items</var> . <code id=the-datatransferitemlist-interface:dom-datatransferitemlist-remove-2><a href=#dom-datatransferitemlist-remove>remove</a></code>(<var>index</var>)<dd>

    <p><a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-3>ドラッグデータストア</a>内の<var>index</var>番目のエントリを削除する。</p>

   <dt><var>items</var> . <code id=the-datatransferitemlist-interface:dom-datatransferitemlist-clear-2><a href=#dom-datatransferitemlist-clear>clear</a></code>()<dd>

    <p><a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-4>ドラッグデータストア</a>内のすべてのエントリを削除する。</p>

   <dt><var>items</var> . <code id=the-datatransferitemlist-interface:dom-datatransferitemlist-add-3><a href=#dom-datatransferitemlist-add>add</a></code>(<var>data</var>)<dt><var>items</var> . <code id=the-datatransferitemlist-interface:dom-datatransferitemlist-add-4><a href=#dom-datatransferitemlist-add>add</a></code>(<var>data</var>, <var>type</var>)<dd>

    <p><a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-5>ドラッグデータストア</a>に指定されたデータに対する新しいエントリを追加する。データがプレーンテキストである場合、<var>type</var>文字列も提供される必要がある。</p>

   </dl>

  

  <p>While the <code id=the-datatransferitemlist-interface:datatransferitemlist-3><a href=#datatransferitemlist>DataTransferItemList</a></code> object's <code id=the-datatransferitemlist-interface:datatransfer-2><a href=#datatransfer>DataTransfer</a></code> object is
  associated with a <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-6>drag data store</a>, the <code id=the-datatransferitemlist-interface:datatransferitemlist-4><a href=#datatransferitemlist>DataTransferItemList</a></code> object's
  <i>mode</i> is the same as the <a href=#drag-data-store-mode id=the-datatransferitemlist-interface:drag-data-store-mode>drag data store mode</a>. When the
  <code id=the-datatransferitemlist-interface:datatransferitemlist-5><a href=#datatransferitemlist>DataTransferItemList</a></code> object's <code id=the-datatransferitemlist-interface:datatransfer-3><a href=#datatransfer>DataTransfer</a></code> object is <em>not</em>
  associated with a <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-7>drag data store</a>, the <code id=the-datatransferitemlist-interface:datatransferitemlist-6><a href=#datatransferitemlist>DataTransferItemList</a></code> object's
  <i>mode</i> is the <i>disabled mode</i>. The <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-8>drag data store</a> referenced in this
  section (which is used only when the <code id=the-datatransferitemlist-interface:datatransferitemlist-7><a href=#datatransferitemlist>DataTransferItemList</a></code> object is not in the
  <i>disabled mode</i>) is the <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-9>drag data store</a> with which the
  <code id=the-datatransferitemlist-interface:datatransferitemlist-8><a href=#datatransferitemlist>DataTransferItemList</a></code> object's <code id=the-datatransferitemlist-interface:datatransfer-4><a href=#datatransfer>DataTransfer</a></code> object is associated.</p>

  <p>The <dfn id=dom-datatransferitemlist-length><code>length</code></dfn> attribute must
  return zero if the object is in the <i>disabled mode</i>; otherwise it must return the number of
  items in the <a href=#drag-data-store-item-list id=the-datatransferitemlist-interface:drag-data-store-item-list>drag data store item list</a>.</p>

  <p>When a <code id=the-datatransferitemlist-interface:datatransferitemlist-9><a href=#datatransferitemlist>DataTransferItemList</a></code> object is not in the <i>disabled mode</i>, its
  <a id=the-datatransferitemlist-interface:supported-property-indices href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-supported-property-indices data-x-internal=supported-property-indices>supported property indices</a> are the numbers in the range

    <span>0 .. <var>n</var>-1</span>,

  where <var>n</var> is the number of items in the <a href=#drag-data-store-item-list id=the-datatransferitemlist-interface:drag-data-store-item-list-2>drag data store item
  list</a>.</p>

  <p id=dom-datatransferitemlist-item>To <a id=the-datatransferitemlist-interface:determine-the-value-of-an-indexed-property href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-determine-the-value-of-an-indexed-property data-x-internal=determine-the-value-of-an-indexed-property>determine the value of an indexed property</a>
  <var>i</var> of a <code id=the-datatransferitemlist-interface:datatransferitemlist-10><a href=#datatransferitemlist>DataTransferItemList</a></code> object, the user agent must return a
  <code id=the-datatransferitemlist-interface:datatransferitem-5><a href=#datatransferitem>DataTransferItem</a></code> object representing the <var>i</var>th item in the
  <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-10>drag data store</a>. The same object must be returned each time a particular item is
  obtained from this <code id=the-datatransferitemlist-interface:datatransferitemlist-11><a href=#datatransferitemlist>DataTransferItemList</a></code> object. The <code id=the-datatransferitemlist-interface:datatransferitem-6><a href=#datatransferitem>DataTransferItem</a></code>
  object must be associated with the same <code id=the-datatransferitemlist-interface:datatransfer-5><a href=#datatransfer>DataTransfer</a></code> object as the
  <code id=the-datatransferitemlist-interface:datatransferitemlist-12><a href=#datatransferitemlist>DataTransferItemList</a></code> object when it is first created.</p>

  <p>The <dfn id=dom-datatransferitemlist-add><code>add()</code></dfn> method must run the
  following steps:</p>

  <ol><li><p>If the <code id=the-datatransferitemlist-interface:datatransferitemlist-13><a href=#datatransferitemlist>DataTransferItemList</a></code> object is not in the <i id=the-datatransferitemlist-interface:concept-dnd-rw><a href=#concept-dnd-rw>read/write mode</a></i>, return null and abort these steps.</li><li>

    <p>Jump to the appropriate set of steps from the following list:</p>

    <dl class=switch><dt>If the first argument to the method is a string<dd>

      <p>If there is already an item in the <a href=#drag-data-store-item-list id=the-datatransferitemlist-interface:drag-data-store-item-list-3>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransferitemlist-interface:the-drag-data-item-kind>kind</a> is <i>Plain Unicode string</i> and whose <a href=#the-drag-data-item-type-string id=the-datatransferitemlist-interface:the-drag-data-item-type-string>type string</a> is equal to the value of the
      method's second argument, <a id=the-datatransferitemlist-interface:converted-to-ascii-lowercase href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII lowercase</a>, then throw a
      <a id=the-datatransferitemlist-interface:notsupportederror href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a> <code id=the-datatransferitemlist-interface:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code> and abort these
      steps.</p>

      <p>Otherwise, add an item to the <a href=#drag-data-store-item-list id=the-datatransferitemlist-interface:drag-data-store-item-list-4>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransferitemlist-interface:the-drag-data-item-kind-2>kind</a> is <i>Plain Unicode string</i>, whose <a href=#the-drag-data-item-type-string id=the-datatransferitemlist-interface:the-drag-data-item-type-string-2>type string</a> is equal to the value of the method's second
      argument, <a id=the-datatransferitemlist-interface:converted-to-ascii-lowercase-2 href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII lowercase</a>, and whose data is the string given by the
      method's first argument.</p>

     <dt>If the first argument to the method is a <code id=the-datatransferitemlist-interface:file-2><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code><dd>

      <p>Add an item to the <a href=#drag-data-store-item-list id=the-datatransferitemlist-interface:drag-data-store-item-list-5>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-datatransferitemlist-interface:the-drag-data-item-kind-3>kind</a> is <i>File</i>, whose <a href=#the-drag-data-item-type-string id=the-datatransferitemlist-interface:the-drag-data-item-type-string-3>type
      string</a> is the <code id=the-datatransferitemlist-interface:dom-blob-type><a data-x-internal=dom-blob-type href=https://triple-underscore.github.io/File_API-ja.html#dfn-type>type</a></code> of the <code id=the-datatransferitemlist-interface:file-3><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code>,
      <a id=the-datatransferitemlist-interface:converted-to-ascii-lowercase-3 href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII lowercase</a>, and whose data is the same as the
      <code id=the-datatransferitemlist-interface:file-4><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code>'s data.</p>

     </dl>

   </li><li><p><a href=#dom-datatransferitemlist-item>Determine the value of the indexed property</a>
   corresponding to the newly added item, and return that value (a newly created
   <code id=the-datatransferitemlist-interface:datatransferitem-7><a href=#datatransferitem>DataTransferItem</a></code> object).</li></ol>

  <p>The <dfn id=dom-datatransferitemlist-remove><code>remove()</code></dfn> method, when
  invoked with the argument <var>i</var>, must run these steps:</p>

  <ol><li><p>If the <code id=the-datatransferitemlist-interface:datatransferitemlist-14><a href=#datatransferitemlist>DataTransferItemList</a></code> object is not in the <i id=the-datatransferitemlist-interface:concept-dnd-rw-2><a href=#concept-dnd-rw>read/write mode</a></i>, throw an
   <a id=the-datatransferitemlist-interface:invalidstateerror href=https://triple-underscore.github.io/WebIDL-ja.html#invalidstateerror data-x-internal=invalidstateerror>"<code>InvalidStateError</code>"</a> <code id=the-datatransferitemlist-interface:domexception-2><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code> and abort these
   steps.</li><li><p>Remove the <var>i</var>th item from the <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-11>drag data store</a>.</li></ol>

  <p>The <dfn id=dom-datatransferitemlist-clear><code>clear</code></dfn> method, if the
  <code id=the-datatransferitemlist-interface:datatransferitemlist-15><a href=#datatransferitemlist>DataTransferItemList</a></code> object is in the <i id=the-datatransferitemlist-interface:concept-dnd-rw-3><a href=#concept-dnd-rw>read/write mode</a></i>,
  must remove all the items from the <a href=#drag-data-store id=the-datatransferitemlist-interface:drag-data-store-12>drag data store</a>. Otherwise, it must do
  nothing.</p>

  


  <h5 id=the-datatransferitem-interface>6.7.3.2 <code id=the-datatransferitem-interface:datatransferitem>DataTransferItem</code>インターフェイス</h5>

  <p>各<code id=the-datatransferitem-interface:datatransferitem-2><a href=#datatransferitem>DataTransferItem</a></code>オブジェクトは<code id=the-datatransferitem-interface:datatransfer><a href=#datatransfer>DataTransfer</a></code>オブジェクトに関連付けられる。</p>

  <pre class=idl>interface <dfn id=datatransferitem>DataTransferItem</dfn> {
  readonly attribute DOMString <a href=#dom-datatransferitem-kind id=the-datatransferitem-interface:dom-datatransferitem-kind>kind</a>;
  readonly attribute DOMString <a href=#dom-datatransferitem-type id=the-datatransferitem-interface:dom-datatransferitem-type>type</a>;
  void <a href=#dom-datatransferitem-getasstring id=the-datatransferitem-interface:dom-datatransferitem-getasstring>getAsString</a>(<a href=#functionstringcallback id=the-datatransferitem-interface:functionstringcallback>FunctionStringCallback</a>? _callback);
  <a id=the-datatransferitem-interface:file href=https://triple-underscore.github.io/File_API-ja.html#file data-x-internal=file>File</a>? <a href=#dom-datatransferitem-getasfile id=the-datatransferitem-interface:dom-datatransferitem-getasfile>getAsFile</a>();
};

callback <dfn id=functionstringcallback>FunctionStringCallback</dfn> = void (DOMString data);</pre>

  <dl class=domintro><dt><var>item</var> . <code id=the-datatransferitem-interface:dom-datatransferitem-kind-2><a href=#dom-datatransferitem-kind>kind</a></code><dd>

    <p><a href=#the-drag-data-item-kind id=the-datatransferitem-interface:the-drag-data-item-kind>ドラッグデータ項目の種類</a>、"string"、"file"のいずれかを返す。</p>

   <dt><var>item</var> . <code id=the-datatransferitem-interface:dom-datatransferitem-type-2><a href=#dom-datatransferitem-type>type</a></code><dd>

    <p><a href=#the-drag-data-item-type-string id=the-datatransferitem-interface:the-drag-data-item-type-string>ドラッグデータ項目型文字列</a>を返す。</p>

   <dt><var>item</var> . <code id=the-datatransferitem-interface:dom-datatransferitem-getasstring-2><a href=#dom-datatransferitem-getasstring>getAsString</a></code>(<var>callback</var>)<dd>

    <p><a href=#the-drag-data-item-kind id=the-datatransferitem-interface:the-drag-data-item-kind-2>ドラッグデータ項目の種類</a>が<i>プレーンUnicode文字列</i>である場合、引数として文字列データをもつコールバックを呼び出す。</p>

   <dt><var>file</var> = <var>item</var> . <code id=the-datatransferitem-interface:dom-datatransferitem-getasfile-2><a href=#dom-datatransferitem-getasfile>getAsFile</a></code>()<dd>

    <p><a href=#the-drag-data-item-kind id=the-datatransferitem-interface:the-drag-data-item-kind-3>ドラッグデータアイテムの種類</a>が<i>File</i>である場合、<code id=the-datatransferitem-interface:file-2><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code>オブジェクトを返す。</p>

   </dl>

  

  <p>While the <code id=the-datatransferitem-interface:datatransferitem-3><a href=#datatransferitem>DataTransferItem</a></code> object's <code id=the-datatransferitem-interface:datatransfer-2><a href=#datatransfer>DataTransfer</a></code> object is associated
  with a <a href=#drag-data-store id=the-datatransferitem-interface:drag-data-store>drag data store</a> and that <a href=#drag-data-store id=the-datatransferitem-interface:drag-data-store-2>drag data store</a>'s <a href=#drag-data-store-item-list id=the-datatransferitem-interface:drag-data-store-item-list>drag data store
  item list</a> still contains the item that the <code id=the-datatransferitem-interface:datatransferitem-4><a href=#datatransferitem>DataTransferItem</a></code> object represents,
  the <code id=the-datatransferitem-interface:datatransferitem-5><a href=#datatransferitem>DataTransferItem</a></code> object's <i>mode</i> is the same as the <a href=#drag-data-store-mode id=the-datatransferitem-interface:drag-data-store-mode>drag data store
  mode</a>. When the <code id=the-datatransferitem-interface:datatransferitem-6><a href=#datatransferitem>DataTransferItem</a></code> object's <code id=the-datatransferitem-interface:datatransfer-3><a href=#datatransfer>DataTransfer</a></code> object is
  <em>not</em> associated with a <a href=#drag-data-store id=the-datatransferitem-interface:drag-data-store-3>drag data store</a>, or if the item that the
  <code id=the-datatransferitem-interface:datatransferitem-7><a href=#datatransferitem>DataTransferItem</a></code> object represents has been removed from the relevant <a href=#drag-data-store-item-list id=the-datatransferitem-interface:drag-data-store-item-list-2>drag data
  store item list</a>, the <code id=the-datatransferitem-interface:datatransferitem-8><a href=#datatransferitem>DataTransferItem</a></code> object's <i>mode</i> is the <i>disabled
  mode</i>. The <a href=#drag-data-store id=the-datatransferitem-interface:drag-data-store-4>drag data store</a> referenced in this section (which is used only when the
  <code id=the-datatransferitem-interface:datatransferitem-9><a href=#datatransferitem>DataTransferItem</a></code> object is not in the <i>disabled mode</i>) is the <a href=#drag-data-store id=the-datatransferitem-interface:drag-data-store-5>drag data
  store</a> with which the <code id=the-datatransferitem-interface:datatransferitem-10><a href=#datatransferitem>DataTransferItem</a></code> object's <code id=the-datatransferitem-interface:datatransfer-4><a href=#datatransfer>DataTransfer</a></code>
  object is associated.</p>

  <p>The <dfn id=dom-datatransferitem-kind><code>kind</code></dfn> attribute must return the
  empty string if the <code id=the-datatransferitem-interface:datatransferitem-11><a href=#datatransferitem>DataTransferItem</a></code> object is in the <i>disabled mode</i>; otherwise
  it must return the string given in the cell from the second column of the following table from the
  row whose cell in the first column contains <a href=#the-drag-data-item-kind id=the-datatransferitem-interface:the-drag-data-item-kind-4>the drag data item kind</a> of the item
  represented by the <code id=the-datatransferitem-interface:datatransferitem-12><a href=#datatransferitem>DataTransferItem</a></code> object:</p>

  <table><thead><tr><th>  Kind  </th><th>  String
   
   <tbody></th></tr><tr><td> <i>プレーンUnicode文字列</i> </td><td>  "<code>string</code>"

    

    </td></tr><tr><td> <i>File</i> </td><td>  "<code>file</code>"

  

  </td></tr></table>

  <p>The <dfn id=dom-datatransferitem-type><code>type</code></dfn> attribute must return the
  empty string if the <code id=the-datatransferitem-interface:datatransferitem-13><a href=#datatransferitem>DataTransferItem</a></code> object is in the <i>disabled mode</i>; otherwise
  it must return <a href=#the-drag-data-item-type-string id=the-datatransferitem-interface:the-drag-data-item-type-string-2>the drag data item type string</a> of the item represented by the
  <code id=the-datatransferitem-interface:datatransferitem-14><a href=#datatransferitem>DataTransferItem</a></code> object.</p>

  <p>The <dfn id=dom-datatransferitem-getasstring><code>getAsString(<var>callback</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the <var>callback</var> is null, abort these steps.</li><li><p>If the <code id=the-datatransferitem-interface:datatransferitem-15><a href=#datatransferitem>DataTransferItem</a></code> object is not in the <i id=the-datatransferitem-interface:concept-dnd-rw><a href=#concept-dnd-rw>read/write mode</a></i> or the <i id=the-datatransferitem-interface:concept-dnd-ro><a href=#concept-dnd-ro>read-only mode</a></i>,
   abort these steps. The callback is never invoked.</li><li><p>If <a href=#the-drag-data-item-kind id=the-datatransferitem-interface:the-drag-data-item-kind-5>the drag data item kind</a> is not <i>Plain Unicode string</i>, abort these
   steps. The callback is never invoked.</li><li><p>Otherwise, <a id=the-datatransferitem-interface:queue-a-task href=webappapis.html#queue-a-task>queue a task</a> to invoke <var>callback</var>, passing the
   actual data of the item represented by the <code id=the-datatransferitem-interface:datatransferitem-16><a href=#datatransferitem>DataTransferItem</a></code> object as the
   argument.</li></ol>



  <p>The <dfn id=dom-datatransferitem-getasfile><code>getAsFile()</code></dfn>
  method must run the following steps:</p>

  <ol><li><p>If the <code id=the-datatransferitem-interface:datatransferitem-17><a href=#datatransferitem>DataTransferItem</a></code> object is not in the <i id=the-datatransferitem-interface:concept-dnd-rw-2><a href=#concept-dnd-rw>read/write mode</a></i> or the <i id=the-datatransferitem-interface:concept-dnd-ro-2><a href=#concept-dnd-ro>read-only mode</a></i>,
   return null and abort these steps.</li><li><p>If <a href=#the-drag-data-item-kind id=the-datatransferitem-interface:the-drag-data-item-kind-6>the drag data item kind</a> is not <i>File</i>, then return null and abort
   these steps.</li><li><p>Return a new <code id=the-datatransferitem-interface:file-3><a data-x-internal=file href=https://triple-underscore.github.io/File_API-ja.html#file>File</a></code> object representing the actual data of the item represented
   by the <code id=the-datatransferitem-interface:datatransferitem-18><a href=#datatransferitem>DataTransferItem</a></code> object.</p>

  </li></ol>



  



  <h4 id=the-dragevent-interface>6.7.4 <code id=the-dragevent-interface:dragevent><a href=#dragevent>DragEvent</a></code>インターフェイス</h4>

  <p>ドラッグアンドドロップ処理モデルは、複数のイベントを含む。これらはすべて<code id=the-dragevent-interface:dragevent-2><a href=#dragevent>DragEvent</a></code>インターフェイスを使用する。</p>

  <pre class=idl>[Constructor(DOMString type, optional <a href=#drageventinit id=the-dragevent-interface:drageventinit>DragEventInit</a> eventInitDict)]
interface <dfn id=dragevent>DragEvent</dfn> : <a id=the-dragevent-interface:mouseevent href=https://w3c.github.io/uievents/#interface-MouseEvent data-x-internal=mouseevent>MouseEvent</a> {
  readonly attribute <a href=#datatransfer id=the-dragevent-interface:datatransfer>DataTransfer</a>? <a href=#dom-dragevent-datatransfer id=the-dragevent-interface:dom-dragevent-datatransfer>dataTransfer</a>;
};

dictionary <dfn id=drageventinit>DragEventInit</dfn> : <a id=the-dragevent-interface:mouseeventinit href=https://w3c.github.io/uievents/#idl-def-MouseEventInit data-x-internal=mouseeventinit>MouseEventInit</a> {
  <a href=#datatransfer id=the-dragevent-interface:datatransfer-2>DataTransfer</a>? dataTransfer = null;
};</pre>

  <dl class=domintro><dt><var>event</var> . <code id=the-dragevent-interface:dom-dragevent-datatransfer-2><a href=#dom-dragevent-datatransfer>dataTransfer</a></code><dd>

    <p>イベントの<code id=the-dragevent-interface:datatransfer-3><a href=#datatransfer>DataTransfer</a></code>オブジェクトを返す。</p>

   </dl>

  <p class=note>他のイベントインターフェイスとの整合性を保つため、<code id=the-dragevent-interface:dragevent-3><a href=#dragevent>DragEvent</a></code>インターフェイスはコンストラクタを持つけれども、特に有用ではない。<code id=the-dragevent-interface:datatransfer-5><a href=#datatransfer>DataTransfer</a></code>オブジェクトは、ドラッグアンドドロップの間にブラウザーによって調整される処理およびセキュリティーモデルを持つので、特に、スクリプトから有用な<code id=the-dragevent-interface:datatransfer-4><a href=#datatransfer>DataTransfer</a></code>オブジェクトを作成する方法はない。</p>

  

  <p>The <dfn id=dom-dragevent-datatransfer><code>dataTransfer</code></dfn> attribute of the
  <code id=the-dragevent-interface:dragevent-4><a href=#dragevent>DragEvent</a></code> interface must return the value it was initialised to. It represents the
  context information for the event.</p>

  

  

  <p>When a user agent is required to <dfn id=fire-a-dnd-event>fire a DND event</dfn> named <var>e</var> at an element,
  using a particular <a href=#drag-data-store id=the-dragevent-interface:drag-data-store>drag data store</a>, and optionally with a specific <var>related
  target</var>, the user agent must run the following steps:</p>

  <ol><li><p>If no specific <var>related target</var> was provided, set <var>related target</var> to
   null.</li><li><p>Let <var>window</var> be the <code id=the-dragevent-interface:window><a href=browsers.html#window>Window</a></code> object of the <code id=the-dragevent-interface:document><a href=dom.html#document>Document</a></code>
   object of the specified target element.</li><li>

    <p>If <var>e</var> is <code id=the-dragevent-interface:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code>, set the <a href=#drag-data-store-mode id=the-dragevent-interface:drag-data-store-mode>drag
    data store mode</a> to the <a href=#concept-dnd-rw id=the-dragevent-interface:concept-dnd-rw>read/write mode</a>.</p>

    <p>If <var>e</var> is <code id=the-dragevent-interface:event-dnd-drop><a href=#event-dnd-drop>drop</a></code>, set the <a href=#drag-data-store-mode id=the-dragevent-interface:drag-data-store-mode-2>drag data store
    mode</a> to the <a href=#concept-dnd-ro id=the-dragevent-interface:concept-dnd-ro>read-only mode</a>.</p>

   </li><li><p>Let <var>dataTransfer</var> be a newly created <code id=the-dragevent-interface:datatransfer-6><a href=#datatransfer>DataTransfer</a></code> object
   associated with the given <a href=#drag-data-store id=the-dragevent-interface:drag-data-store-2>drag data store</a>.</li><li><p id=effectAllowed-initialisation>Set the <code id=the-dragevent-interface:dom-datatransfer-effectallowed><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> attribute to the <a href=#drag-data-store id=the-dragevent-interface:drag-data-store-3>drag data
   store</a>'s <a href=#drag-data-store-allowed-effects-state id=the-dragevent-interface:drag-data-store-allowed-effects-state>drag data store allowed effects state</a>.</li><li>

    <p id=dropEffect-initialisation>Set the <code id=the-dragevent-interface:dom-datatransfer-dropeffect><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attribute to "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-none><a href=#dom-datatransfer-dropeffect-none>none</a></code>" if <var>e</var> is <code id=the-dragevent-interface:event-dnd-dragstart-2><a href=#event-dnd-dragstart>dragstart</a></code>, <code id=the-dragevent-interface:event-dnd-drag><a href=#event-dnd-drag>drag</a></code>, <code id=the-dragevent-interface:event-dnd-dragexit><a href=#event-dnd-dragexit>dragexit</a></code>, or <code id=the-dragevent-interface:event-dnd-dragleave><a href=#event-dnd-dragleave>dragleave</a></code>; to the value corresponding to the <a href=#current-drag-operation id=the-dragevent-interface:current-drag-operation>current
    drag operation</a> if <var>e</var> is <code id=the-dragevent-interface:event-dnd-drop-2><a href=#event-dnd-drop>drop</a></code> or
    <code id=the-dragevent-interface:event-dnd-dragend><a href=#event-dnd-dragend>dragend</a></code>; and to a value based on the <code id=the-dragevent-interface:dom-datatransfer-effectallowed-2><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> attribute's value and the
    drag-and-drop source, as given by the following table, otherwise (i.e. if <var>e</var>
    is <code id=the-dragevent-interface:event-dnd-dragenter><a href=#event-dnd-dragenter>dragenter</a></code> or <code id=the-dragevent-interface:event-dnd-dragover><a href=#event-dnd-dragover>dragover</a></code>):</p>

    <table><thead><tr><th><code id=the-dragevent-interface:dom-datatransfer-effectallowed-3><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code></th><th><code id=the-dragevent-interface:dom-datatransfer-dropeffect-2><a href=#dom-datatransfer-dropeffect>dropEffect</a></code><tbody></th></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-none><a href=#dom-datatransfer-effectallowed-none>none</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-none-2><a href=#dom-datatransfer-dropeffect-none>none</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-copy><a href=#dom-datatransfer-effectallowed-copy>copy</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-copylink><a href=#dom-datatransfer-effectallowed-copylink>copyLink</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-2><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override>if appropriate</a>, "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link><a href=#dom-datatransfer-dropeffect-link>link</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-copymove><a href=#dom-datatransfer-effectallowed-copymove>copyMove</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-3><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-2>if appropriate</a>, "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-all><a href=#dom-datatransfer-effectallowed-all>all</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-4><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-3>if appropriate</a>, either "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-2><a href=#dom-datatransfer-dropeffect-link>link</a></code>" or "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-2><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-link><a href=#dom-datatransfer-effectallowed-link>link</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-3><a href=#dom-datatransfer-dropeffect-link>link</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-linkmove><a href=#dom-datatransfer-effectallowed-linkmove>linkMove</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-4><a href=#dom-datatransfer-dropeffect-link>link</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-4>if appropriate</a>, "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-3><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-move><a href=#dom-datatransfer-effectallowed-move>move</a></code>"</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-4><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>" when what is being dragged is a selection from a text field</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-5><a href=#dom-datatransfer-dropeffect-move>move</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-5>if appropriate</a>, either "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-5><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>" or "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-5><a href=#dom-datatransfer-dropeffect-link>link</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-uninitialized-2><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>" when what is being dragged is a selection</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-6><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-6>if appropriate</a>, either "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-6><a href=#dom-datatransfer-dropeffect-link>link</a></code>" or "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-6><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr><tr><td>"<code id=the-dragevent-interface:dom-datatransfer-effectallowed-uninitialized-3><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>" when what is being dragged is an <code id=the-dragevent-interface:the-a-element><a href=semantics.html#the-a-element>a</a></code> element with an <code id=the-dragevent-interface:attr-hyperlink-href><a href=semantics.html#attr-hyperlink-href>href</a></code> attribute</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-7><a href=#dom-datatransfer-dropeffect-link>link</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-7>if appropriate</a>, either "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-7><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>" or "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-7><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr><tr><td>Any other case</td><td>"<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-8><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>", or, <a href=#concept-platform-dropeffect-override id=the-dragevent-interface:concept-platform-dropeffect-override-8>if appropriate</a>, either "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-8><a href=#dom-datatransfer-dropeffect-link>link</a></code>" or "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-8><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td></tr></table>

    <p>Where the table above provides <dfn id=concept-platform-dropeffect-override>possibly
    appropriate alternatives</dfn>, user agents may instead use the listed alternative values if
    platform conventions dictate that the user has requested those alternate effects.</p>

    <p class=example>For example, Windows platform conventions are such that dragging while
    holding the "alt" key indicates a preference for linking the data, rather than moving or copying
    it. Therefore, on a Windows system, if "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-link-9><a href=#dom-datatransfer-dropeffect-link>link</a></code>" is an option according to
    the table above while the "alt" key is depressed, the user agent could select that instead of
    "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-copy-9><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>" or "<code id=the-dragevent-interface:dom-datatransfer-dropeffect-move-9><a href=#dom-datatransfer-dropeffect-move>move</a></code>".</p>

   </li><li>

    <p>Create a <a href=infrastructure.html#concept-events-trusted id=the-dragevent-interface:concept-events-trusted>trusted</a> <code id=the-dragevent-interface:dragevent-5><a href=#dragevent>DragEvent</a></code> object
    and initialise it to have the given name <var>e</var>, to bubble, to be cancelable unless
    <var>e</var> is <code id=the-dragevent-interface:event-dnd-dragexit-2><a href=#event-dnd-dragexit>dragexit</a></code>, <code id=the-dragevent-interface:event-dnd-dragleave-2><a href=#event-dnd-dragleave>dragleave</a></code>, or <code id=the-dragevent-interface:event-dnd-dragend-2><a href=#event-dnd-dragend>dragend</a></code>, and to have the <code id=the-dragevent-interface:dom-uievent-view><a data-x-internal=dom-uievent-view href=https://w3c.github.io/uievents/#widl-UIEvent-view>view</a></code> attribute initialised to <var>window</var>, the <code id=the-dragevent-interface:dom-uievent-detail><a data-x-internal=dom-uievent-detail href=https://w3c.github.io/uievents/#widl-UIEvent-detail>detail</a></code> attribute initialised to zero, the mouse and key
    attributes initialised according to the state of the input devices as they would be for user
    interaction events, the <code id=the-dragevent-interface:dom-mouseevent-relatedtarget><a data-x-internal=dom-mouseevent-relatedtarget href=https://w3c.github.io/uievents/#widl-MouseEvent-relatedTarget>relatedTarget</a></code>
    attribute initialised to <var>related target</var>, and the <code id=the-dragevent-interface:dom-dragevent-datatransfer-3><a href=#dom-dragevent-datatransfer>dataTransfer</a></code> attribute initialised to
    <var>dataTransfer</var>, the <code id=the-dragevent-interface:datatransfer-7><a href=#datatransfer>DataTransfer</a></code> object created above.</p>

    

    <p>If there is no relevant pointing device, the object must have its <code>screenX</code>, <code>screenY</code>, <code>clientX</code>, <code>clientY</code>, and <code>button</code> attributes set to 0.</p>

   </li><li><p><a href=infrastructure.html#concept-event-dispatch id=the-dragevent-interface:concept-event-dispatch>Dispatch</a> the newly created
   <code id=the-dragevent-interface:dragevent-6><a href=#dragevent>DragEvent</a></code> object at the specified target element.</li><li><p>Set the <a href=#drag-data-store-allowed-effects-state id=the-dragevent-interface:drag-data-store-allowed-effects-state-2>drag data store allowed effects state</a> to the current value of
   <var>dataTransfer</var>'s <code id=the-dragevent-interface:dom-datatransfer-effectallowed-4><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code>
   attribute. (It can only have changed value if <var>e</var> is <code id=the-dragevent-interface:event-dnd-dragstart-3><a href=#event-dnd-dragstart>dragstart</a></code>.)</li><li><p>Set the <a href=#drag-data-store-mode id=the-dragevent-interface:drag-data-store-mode-3>drag data store mode</a> back to the <a href=#concept-dnd-p id=the-dragevent-interface:concept-dnd-p>protected mode</a> if it was changed in the first step.</li><li><p>Break the association between <var>dataTransfer</var> and the <a href=#drag-data-store id=the-dragevent-interface:drag-data-store-4>drag data
   store</a>.</li></ol>

  


  

  <h4 id=drag-and-drop-processing-model>6.7.5 処理モデル</h4>

  <p>When the user attempts to begin a drag operation, the user agent must run the following steps.
  User agents must act as if these steps were run even if the drag actually started in another
  document or application and the user agent was not aware that the drag was occurring until it
  intersected with a document under the user agent's purview.</p>

  <ol><li>

    <p>Determine what is being dragged, as follows:</p>

    <p>If the drag operation was invoked on a selection, then it is the selection that is being
    dragged.</p>

    <p>Otherwise, if the drag operation was invoked on a <code id=drag-and-drop-processing-model:document><a href=dom.html#document>Document</a></code>, it is the first
    element, going up the ancestor chain, starting at the node that the user tried to drag, that has
    the IDL attribute <code id=drag-and-drop-processing-model:dom-draggable><a href=#dom-draggable>draggable</a></code> set to true. If there is no such
    element, then nothing is being dragged; abort these steps, the drag-and-drop operation is never
    started.</p>

    <p>Otherwise, the drag operation was invoked outside the user agent's purview. What is being
    dragged is defined by the document or application where the drag was started.</p>

    <p class=note><code id=drag-and-drop-processing-model:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> elements and <code id=drag-and-drop-processing-model:the-a-element><a href=semantics.html#the-a-element>a</a></code> elements with an <code id=drag-and-drop-processing-model:attr-hyperlink-href><a href=semantics.html#attr-hyperlink-href>href</a></code> attribute have their <code id=drag-and-drop-processing-model:dom-draggable-2><a href=#dom-draggable>draggable</a></code> attribute set to true by default.</p>

   </li><li><p><a href=#create-a-drag-data-store id=drag-and-drop-processing-model:create-a-drag-data-store>Create a drag data store</a>. All the DND events fired subsequently by the steps
   in this section must use this <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store>drag data store</a>.</li><li>

    <p>Establish which DOM node is the <dfn id=source-node>source node</dfn>, as follows:</p>

    <p>If it is a selection that is being dragged, then the <a href=#source-node id=drag-and-drop-processing-model:source-node>source node</a> is the
    <code id=drag-and-drop-processing-model:text><a data-x-internal=text href=https://triple-underscore.github.io/DOM4-ja.html#interface-text>Text</a></code> node that the user started the drag on (typically the <code id=drag-and-drop-processing-model:text-2><a data-x-internal=text href=https://triple-underscore.github.io/DOM4-ja.html#interface-text>Text</a></code> node
    that the user originally clicked). If the user did not specify a particular node, for example if
    the user just told the user agent to begin a drag of "the selection", then the <a href=#source-node id=drag-and-drop-processing-model:source-node-2>source
    node</a> is the first <code id=drag-and-drop-processing-model:text-3><a data-x-internal=text href=https://triple-underscore.github.io/DOM4-ja.html#interface-text>Text</a></code> node containing a part of the selection.</p>

    <p>Otherwise, if it is an element that is being dragged, then the <a href=#source-node id=drag-and-drop-processing-model:source-node-3>source node</a> is
    the element that is being dragged.</p>

    <p>Otherwise, the <a href=#source-node id=drag-and-drop-processing-model:source-node-4>source node</a> is part of another document or application. When this
    specification requires that an event be dispatched at the <a href=#source-node id=drag-and-drop-processing-model:source-node-5>source node</a> in this case,
    the user agent must instead follow the platform-specific conventions relevant to that
    situation.</p>

    <p class=note>Multiple events are fired on the <a href=#source-node id=drag-and-drop-processing-model:source-node-6>source node</a> during the course of
    the drag-and-drop operation.</p>

   </li><li>

    <p>Determine the <dfn id=list-of-dragged-nodes>list of dragged nodes</dfn>, as follows:</p>

    <p>If it is a selection that is being dragged, then the <a href=#list-of-dragged-nodes id=drag-and-drop-processing-model:list-of-dragged-nodes>list of dragged nodes</a>
    contains, in <a id=drag-and-drop-processing-model:tree-order href=https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order data-x-internal=tree-order>tree order</a>, every node that is partially or completely included in the
    selection (including all their ancestors).</p>

    <p>Otherwise, the <a href=#list-of-dragged-nodes id=drag-and-drop-processing-model:list-of-dragged-nodes-2>list of dragged nodes</a> contains only the <a href=#source-node id=drag-and-drop-processing-model:source-node-7>source node</a>,
    if any.</p>

   </li><li>

    <p>If it is a selection that is being dragged, then add an item to the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list>drag data store
    item list</a>, with its properties set as follows:</p>

    <dl><dt><a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string>ドラッグデータ項目型文字列</a>
     <dd>"<code id=drag-and-drop-processing-model:text/plain><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>"<dt><a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind>ドラッグデータアイテムの種類</a>
     <dd><i>プレーンUnicode文字列</i><dt>実際のデータ<dd>The text of the selection</dl>

    <p>Otherwise, if any files are being dragged, then add one item per file to the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-2>drag data
    store item list</a>, with their properties set as follows:</p>

    <dl><dt><a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-2>ドラッグデータ項目型文字列</a>
     <dd>The MIME type of the file, if known, or "<code id=drag-and-drop-processing-model:application/octet-stream><a data-x-internal=application/octet-stream href=https://tools.ietf.org/html/rfc2046#section-4.5.1>application/octet-stream</a></code>" otherwise.<dt><a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-2>ドラッグデータアイテムの種類</a>
     <dd><i>File</i><dt>実際のデータ<dd>The file's contents and name.</dl>

    <p class=note>Dragging files can currently only happen from outside a <a id=drag-and-drop-processing-model:browsing-context href=browsers.html#browsing-context>browsing
    context</a>, for example from a file system manager application.</p>

    <p>If the drag initiated outside of the application, the user agent must add items to the
    <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-3>drag data store item list</a> as appropriate for the data being dragged, honoring
    platform conventions where appropriate; however, if the platform conventions do not use <a href=infrastructure.html#mime-type id=drag-and-drop-processing-model:mime-type>MIME types</a> to label dragged data, the user agent must make a
    best-effort attempt to map the types to MIME types, and, in any case, all the <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-3>drag data item type strings</a> must be <a id=drag-and-drop-processing-model:converted-to-ascii-lowercase href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII
    lowercase</a>.</p>

    <p>User agents may also add one or more items representing the selection or dragged element(s)
    in other forms, e.g. as HTML.</p>

   </li><li>

    <p>If the <a href=#list-of-dragged-nodes id=drag-and-drop-processing-model:list-of-dragged-nodes-3>list of dragged nodes</a> is not empty, then <a href=microdata.html#extracting-json id=drag-and-drop-processing-model:extracting-json>extract the microdata from those nodes into a JSON form</a>, and add one item to the
    <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-4>drag data store item list</a>, with its properties set as follows:</p>

    <dl><dt><a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-4>ドラッグデータ項目型文字列</a>
     <dd><code id=drag-and-drop-processing-model:application/microdata+json><a href=iana.html#application/microdata+json>application/microdata+json</a></code><dt><a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-3>ドラッグデータアイテムの種類</a>
     <dd><i>プレーンUnicode文字列</i><dt>実際のデータ<dd>The resulting JSON string.</dl>

   </li><li>

    <p>次のサブ手順を実行する：</p>

    <ol><li><p>Let <var>urls</var> be an empty list of <a href=https://triple-underscore.github.io/URL-ja.html#syntax-url-absolute id=drag-and-drop-processing-model:absolute-url data-x-internal=absolute-url>absolute
     URLs</a>.</li><li>

      <p>For each <var>node</var> in the <a href=#list-of-dragged-nodes id=drag-and-drop-processing-model:list-of-dragged-nodes-4>list of dragged nodes</a>:</p>

      <dl><dt>If the node is an <code id=drag-and-drop-processing-model:the-a-element-2><a href=semantics.html#the-a-element>a</a></code> element with an <code id=drag-and-drop-processing-model:attr-hyperlink-href-2><a href=semantics.html#attr-hyperlink-href>href</a></code> attribute<dd>Add to <var>urls</var> the result of <a href=infrastructure.html#parse-a-url id=drag-and-drop-processing-model:parse-a-url>parsing</a> the
       element's <code id=drag-and-drop-processing-model:attr-hyperlink-href-3><a href=semantics.html#attr-hyperlink-href>href</a></code> content attribute relative to the
       element's <a id=drag-and-drop-processing-model:node-document href=https://triple-underscore.github.io/DOM4-ja.html#concept-node-document data-x-internal=node-document>node document</a>.<dt>If the node is an <code id=drag-and-drop-processing-model:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element with a <code id=drag-and-drop-processing-model:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code>
       attribute<dd>Add to <var>urls</var> the result of <a href=infrastructure.html#parse-a-url id=drag-and-drop-processing-model:parse-a-url-2>parsing</a> the
       element's <code id=drag-and-drop-processing-model:attr-img-src-2><a href=embedded-content.html#attr-img-src>src</a></code> content attribute relative to the
       element's <a id=drag-and-drop-processing-model:node-document-2 href=https://triple-underscore.github.io/DOM4-ja.html#concept-node-document data-x-internal=node-document>node document</a>.</dl>

     </li><li><p>If <var>urls</var> is still empty, abort these substeps.</li><li><p>Let <var>url string</var> be the result of concatenating the strings in <var>urls</var>,
     in the order they were added, separated by a U+000D CARRIAGE RETURN U+000A LINE FEED character
     pair (CRLF).</li><li><p>Add one item to the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-5>drag data store item list</a>, with its properties set as
     follows:</p>

      <dl><dt><a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-5>ドラッグデータ項目型文字列</a>
       <dd><code id=drag-and-drop-processing-model:text/uri-list><a href=indices.html#text/uri-list>text/uri-list</a></code><dt><a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-4>ドラッグデータアイテムの種類</a>
       <dd><i>プレーンUnicode文字列</i><dt>実際のデータ<dd><var>url string</var></dl>

     </li></ol>

   </li><li>

    <p>Update the <a href=#drag-data-store-default-feedback id=drag-and-drop-processing-model:drag-data-store-default-feedback>drag data store default feedback</a> as appropriate for the user agent
    (if the user is dragging the selection, then the selection would likely be the basis for this
    feedback; if the user is dragging an element, then that element's rendering would be used; if
    the drag began outside the user agent, then the platform conventions for determining the drag
    feedback should be used).</p>

   </li><li>

    <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code> at the
    <a href=#source-node id=drag-and-drop-processing-model:source-node-8>source node</a>.</p>

    <p>If the event is canceled, then the drag-and-drop operation should not occur; abort these
    steps.</p> 

    <p class=note>Since events with no event listeners registered are, almost by definition, never
    canceled, drag-and-drop is always available to the user if the author does not specifically
    prevent it.</p>

   </li><li>

    <p><a href=#initiate-the-drag-and-drop-operation id=drag-and-drop-processing-model:initiate-the-drag-and-drop-operation>Initiate the drag-and-drop operation</a> in a manner consistent with platform
    conventions, and as described below.</p>

    <p id=base-dnd-feedback>The drag-and-drop feedback must be generated from the first of the
    following sources that is available:</p>

    <ol><li>The <a href=#drag-data-store-bitmap id=drag-and-drop-processing-model:drag-data-store-bitmap>drag data store bitmap</a>, if any. In this case, the <a href=#drag-data-store-hot-spot-coordinate id=drag-and-drop-processing-model:drag-data-store-hot-spot-coordinate>drag data store
     hot spot coordinate</a> should be used as hints for where to put the cursor relative to the
     resulting image. The values are expressed as distances in <a href=https://momdo.github.io/css3-values/#px id="drag-and-drop-processing-model:'px'" data-x-internal="'px'">CSS pixels</a>
     from the left side and from the top side of the image respectively. <a href=references.html#refsCSS>[CSS]</a></li><li>The <a href=#drag-data-store-default-feedback id=drag-and-drop-processing-model:drag-data-store-default-feedback-2>drag data store default feedback</a>.</li></ol>

   </li></ol>

  <p>From the moment that the user agent is to <dfn id=initiate-the-drag-and-drop-operation>initiate the drag-and-drop operation</dfn>,
  until the end of the drag-and-drop operation, device input events (e.g. mouse and keyboard events)
  must be suppressed.</p>

  <p>During the drag operation, the element directly indicated by the user as the drop target is
  called the <dfn id=immediate-user-selection>immediate user selection</dfn>. (Only elements can be selected by the user; other
  nodes must not be made available as drop targets.) However, the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection>immediate user
  selection</a> is not necessarily the <dfn id=current-target-element>current target element</dfn>, which is the element
  currently selected for the drop part of the drag-and-drop operation.</p>

  <p>The <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-2>immediate user selection</a> changes as the user selects different elements
  (either by pointing at them with a pointing device, or by selecting them in some other way). The
  <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element>current target element</a> changes when the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-3>immediate user selection</a>
  changes, based on the results of event listeners in the document, as described below.</p>

  <p>Both the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-2>current target element</a> and the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-4>immediate user selection</a> can
  be null, which means no target element is selected. They can also both be elements in other
  (DOM-based) documents, or other (non-Web) programs altogether. (For example, a user could drag
  text to a word-processor.) The <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-3>current target element</a> is initially null.</p>

  <p>In addition, there is also a <dfn id=current-drag-operation>current drag operation</dfn>, which can take on the values
  "<dfn id=concept-current-drag-operation-none><code>none</code></dfn>", "<dfn id=concept-current-drag-operation-copy><code>copy</code></dfn>", "<dfn id=concept-current-drag-operation-link><code>link</code></dfn>", and "<dfn id=concept-current-drag-operation-move><code>move</code></dfn>". Initially, it has the value
  "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none><a href=#concept-current-drag-operation-none>none</a></code>". It is updated by the user agent
  as described in the steps below.</p>

  <p>User agents must, as soon as the drag operation is <a href=#initiate-the-drag-and-drop-operation id=drag-and-drop-processing-model:initiate-the-drag-and-drop-operation-2>initiated</a> and every 350ms (±200ms) thereafter for as long as the drag
  operation is ongoing, <a id=drag-and-drop-processing-model:queue-a-task href=webappapis.html#queue-a-task>queue a task</a> to perform the following steps in sequence:</p>

  <ol><li>

    <p>If the user agent is still performing the previous iteration of the sequence (if any) when
    the next iteration becomes due, abort these steps for this iteration (effectively "skipping
    missed frames" of the drag-and-drop operation).</p>

   </li><li>

    <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-2>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-drag><a href=#event-dnd-drag>drag</a></code> at the
    <a href=#source-node id=drag-and-drop-processing-model:source-node-9>source node</a>. If this event is canceled, the user agent must set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation>current
    drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-2><a href=#concept-current-drag-operation-none>none</a></code>" (no
    drag operation).</p>

   </li><li>

    <p>If the <code id=drag-and-drop-processing-model:event-dnd-drag-2><a href=#event-dnd-drag>drag</a></code> event was not canceled and the user has not
    ended the drag-and-drop operation, check the state of the drag-and-drop operation, as
    follows:</p>

    <ol><li>

      <p>If the user is indicating a different <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-5>immediate user selection</a> than during the
      last iteration (or if this is the first iteration), and if this <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-6>immediate user
      selection</a> is not the same as the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-4>current target element</a>, then <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-3>fire a
      DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragexit><a href=#event-dnd-dragexit>dragexit</a></code> at the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-5>current
      target element</a>, and then update the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-6>current target element</a> as follows:</p>

      <dl class=switch><dt>If the new <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-7>immediate user selection</a> is null<dd><p>Set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-7>current target element</a> to null also.<dt>If the new <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-8>immediate user selection</a> is in a non-DOM document or
       application<dd><p>Set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-8>current target element</a> to the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-9>immediate user
       selection</a>.<dt>そうでなければ<dd>

        <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-4>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragenter><a href=#event-dnd-dragenter>dragenter</a></code>
        at the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-10>immediate user selection</a>.</p>

        <p>If the event is canceled, then set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-9>current target element</a> to the
        <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-11>immediate user selection</a>.</p>

        <p>Otherwise, run the appropriate step from the following list:</p>

        <dl class=switch><dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-12>immediate user selection</a> is a text field (e.g.
         <code id=drag-and-drop-processing-model:the-textarea-element><a href=forms.html#the-textarea-element>textarea</a></code>, or an <code id=drag-and-drop-processing-model:the-input-element><a href=forms.html#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type><a href=forms.html#attr-input-type>type</a></code> attribute is in the <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)">Text</a> state) or an <a id=drag-and-drop-processing-model:editing-host href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or
         <a id=drag-and-drop-processing-model:editable href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element, and the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-6>drag data store item list</a> has an item
         with <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-6>the drag data item type string</a> "<code id=drag-and-drop-processing-model:text/plain-2><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-5>the
         drag data item kind</a> <i>Plain Unicode string</i><dd><p>Set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-10>current target element</a> to the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-13>immediate user
         selection</a> anyway.<dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-14>immediate user selection</a> is an element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-2>drag data store</a><dd><p>Set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-11>current target element</a> to the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-15>immediate user
         selection</a> anyway.<dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-16>immediate user selection</a> is an element that itself has an ancestor
         element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute-2><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match-2>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-3>drag data store</a><dd>

          <p>Let <var>new target</var> be the nearest (deepest) such ancestor element.</p>

          <p>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-17>immediate user selection</a> is <var>new target</var>, then leave the
          <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-12>current target element</a> unchanged.</p>

          <p>Otherwise, <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-5>fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragenter-2><a href=#event-dnd-dragenter>dragenter</a></code> at <var>new target</var>, with the current
          <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-13>current target element</a> as the specific <var>related target</var>. Then, set
          the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-14>current target element</a> to <var>new target</var>, regardless of whether
          that event was canceled or not.</p>

         <dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-18>immediate user selection</a> is <a id=drag-and-drop-processing-model:the-body-element-2 href=dom.html#the-body-element-2>the body element</a><dd><p>Leave the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-15>current target element</a> unchanged.<dt>そうでなければ<dd>

          <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-6>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragenter-3><a href=#event-dnd-dragenter>dragenter</a></code>
          at <a id=drag-and-drop-processing-model:the-body-element-2-2 href=dom.html#the-body-element-2>the body element</a>, if there is one, or at the <code id=drag-and-drop-processing-model:document-2><a href=dom.html#document>Document</a></code> object,
          if not. Then, set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-16>current target element</a> to <a id=drag-and-drop-processing-model:the-body-element-2-3 href=dom.html#the-body-element-2>the body
          element</a>, regardless of whether that event was canceled or not.</p>

         </dl>

       </dl>

     </li><li>

      <p>If the previous step caused the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-17>current target element</a> to change, and if the
      previous target element was not null or a part of a non-DOM document, then <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-7>fire a DND
      event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragleave><a href=#event-dnd-dragleave>dragleave</a></code> at the previous target
      element, with the new <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-18>current target element</a> as the specific <var>related
      target</var>.</p>

     </li><li>

      <p>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-19>current target element</a> is a DOM element, then <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-8>fire a DND
      event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragover><a href=#event-dnd-dragover>dragover</a></code> at this <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-20>current
      target element</a>.</p>

      <p>If the <code id=drag-and-drop-processing-model:event-dnd-dragover-2><a href=#event-dnd-dragover>dragover</a></code> event is not canceled, run the
      appropriate step from the following list:</p>

      <dl class=switch><dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-21>current target element</a> is a text field (e.g. <code id=drag-and-drop-processing-model:the-textarea-element-2><a href=forms.html#the-textarea-element>textarea</a></code>,
       or an <code id=drag-and-drop-processing-model:the-input-element-2><a href=forms.html#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type-2><a href=forms.html#attr-input-type>type</a></code> attribute
       is in the <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-2">Text</a> state) or an <a id=drag-and-drop-processing-model:editing-host-2 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing
       host</a> or <a id=drag-and-drop-processing-model:editable-2 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element, and the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-7>drag data store item list</a>
       has an item with <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-7>the drag data item type string</a> "<code id=drag-and-drop-processing-model:text/plain-3><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and
       <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-6>the drag data item kind</a> <i>Plain Unicode string</i><dd><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-2>current drag operation</a> to either "<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy><a href=#concept-current-drag-operation-copy>copy</a></code>" or "<code id=drag-and-drop-processing-model:concept-current-drag-operation-move><a href=#concept-current-drag-operation-move>move</a></code>", as appropriate given the platform
       conventions.<dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-22>current target element</a> is an element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute-3><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match-3>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-4>drag data store</a> and <a href=#concept-dropzone-operation id=drag-and-drop-processing-model:concept-dropzone-operation>specifies an operation</a><dd><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-3>current drag operation</a> to the operation <a href=#concept-dropzone-operation id=drag-and-drop-processing-model:concept-dropzone-operation-2>specified</a> by the <code id=drag-and-drop-processing-model:the-dropzone-attribute-4><a href=#the-dropzone-attribute>dropzone</a></code> attribute of the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-23>current target
       element</a>.</p>


       <dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-24>current target element</a> is an element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute-5><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match-4>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-5>drag data store</a> and does not
       <a href=#concept-dropzone-operation id=drag-and-drop-processing-model:concept-dropzone-operation-3>specify an operation</a><dd><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-4>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy-2><a href=#concept-current-drag-operation-copy>copy</a></code>".</p>


       <dt>そうでなければ<dd><p>Reset the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-5>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-3><a href=#concept-current-drag-operation-none>none</a></code>".</dl>

      <p>Otherwise (if the <code id=drag-and-drop-processing-model:event-dnd-dragover-3><a href=#event-dnd-dragover>dragover</a></code> event <em>is</em>
      canceled), set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-6>current drag operation</a> based on the values of the <code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> and <code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attributes of the
      <code id=drag-and-drop-processing-model:dragevent><a href=#dragevent>DragEvent</a></code> object's <code id=drag-and-drop-processing-model:dom-dragevent-datatransfer><a href=#dom-dragevent-datatransfer>dataTransfer</a></code>
      object as they stood after the event <a href=infrastructure.html#concept-event-dispatch id=drag-and-drop-processing-model:concept-event-dispatch>dispatch</a>
      finished, as per the following table:</p>

      <table><thead><tr><th><code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-2><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code></th><th><code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-2><a href=#dom-datatransfer-dropeffect>dropEffect</a></code></th><th>Drag operation<tbody></th></tr><tr><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copy><a href=#dom-datatransfer-effectallowed-copy>copy</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copylink><a href=#dom-datatransfer-effectallowed-copylink>copyLink</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copymove><a href=#dom-datatransfer-effectallowed-copymove>copyMove</a></code>", or "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-all><a href=#dom-datatransfer-effectallowed-all>all</a></code>"</td><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-copy><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>"</td><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy-3><a href=#concept-current-drag-operation-copy>copy</a></code>"</td></tr><tr><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-uninitialized-2><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-link><a href=#dom-datatransfer-effectallowed-link>link</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copylink-2><a href=#dom-datatransfer-effectallowed-copylink>copyLink</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-linkmove><a href=#dom-datatransfer-effectallowed-linkmove>linkMove</a></code>", or "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-all-2><a href=#dom-datatransfer-effectallowed-all>all</a></code>"</td><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-link><a href=#dom-datatransfer-dropeffect-link>link</a></code>"</td><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-link><a href=#concept-current-drag-operation-link>link</a></code>"</td></tr><tr><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-uninitialized-3><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-move><a href=#dom-datatransfer-effectallowed-move>move</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copymove-2><a href=#dom-datatransfer-effectallowed-copymove>copyMove</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-linkmove-2><a href=#dom-datatransfer-effectallowed-linkmove>linkMove</a></code>", or "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-all-3><a href=#dom-datatransfer-effectallowed-all>all</a></code>"</td><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-move><a href=#dom-datatransfer-dropeffect-move>move</a></code>"</td><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-2><a href=#concept-current-drag-operation-move>move</a></code>"</td></tr><tr><td colspan=2>Any other case</td><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-4><a href=#concept-current-drag-operation-none>none</a></code>"</td></tr></table>

     </li><li>

      <p>Otherwise, if the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-25>current target element</a> is not a DOM element, use
      platform-specific mechanisms to determine what drag operation is being performed (none, copy,
      link, or move), and set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-7>current drag operation</a> accordingly.</p>

     </li><li>

      <p>Update the drag feedback (e.g. the mouse cursor) to match the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-8>current drag
      operation</a>, as follows:</p>

      <table><thead><tr><th>Drag operation</th><th>Feedback<tbody></th></tr><tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy-4><a href=#concept-current-drag-operation-copy>copy</a></code>"</td><td>Data will be copied if dropped here.</td></tr><tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-link-2><a href=#concept-current-drag-operation-link>link</a></code>"</td><td>Data will be linked if dropped here.</td></tr><tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-3><a href=#concept-current-drag-operation-move>move</a></code>"</td><td>Data will be moved if dropped here.</td></tr><tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-5><a href=#concept-current-drag-operation-none>none</a></code>"</td><td>No operation allowed, dropping here will cancel the drag-and-drop operation.</td></tr></table>

     </li></ol>

   </li><li>

    <p>Otherwise, if the user ended the drag-and-drop operation (e.g. by releasing the mouse button
    in a mouse-driven drag-and-drop interface), or if the <code id=drag-and-drop-processing-model:event-dnd-drag-3><a href=#event-dnd-drag>drag</a></code>
    event was canceled, then this will be the last iteration. Run the following steps, then stop the
    drag-and-drop operation:</p>

    <ol><li>

      <p>If the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-9>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-6><a href=#concept-current-drag-operation-none>none</a></code>" (no drag operation), or, if the user
      ended the drag-and-drop operation by canceling it (e.g. by hitting the <kbd>Escape</kbd> key),
      or if the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-26>current target element</a> is null, then the drag operation failed. Run
      these substeps:</p>

      <ol><li><p>Let <var>dropped</var> be false.</li><li><p>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-27>current target element</a> is a DOM element, <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-9>fire a DND
       event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragleave-2><a href=#event-dnd-dragleave>dragleave</a></code> at it; otherwise, if
       it is not null, use platform-specific conventions for drag cancelation.</li><li><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-10>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-7><a href=#concept-current-drag-operation-none>none</a></code>".</li></ol>

      <p>Otherwise, the drag operation might be a success; run these substeps:</p>

      <ol><li><p>Let <var>dropped</var> be true.</li><li><p>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-28>current target element</a> is a DOM element, <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-10>fire a DND
       event</a> named <code id=drag-and-drop-processing-model:event-dnd-drop><a href=#event-dnd-drop>drop</a></code> at it; otherwise, use
       platform-specific conventions for indicating a drop.</li><li>

        <p>If the event is canceled, set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-11>current drag operation</a> to the value of the
        <code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-3><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attribute of the
        <code id=drag-and-drop-processing-model:dragevent-2><a href=#dragevent>DragEvent</a></code> object's <code id=drag-and-drop-processing-model:dom-dragevent-datatransfer-2><a href=#dom-dragevent-datatransfer>dataTransfer</a></code>
        object as it stood after the event <a href=infrastructure.html#concept-event-dispatch id=drag-and-drop-processing-model:concept-event-dispatch-2>dispatch</a>
        finished.</p>

        <p>Otherwise, the event is not canceled; perform the event's default action, which depends
        on the exact target as follows:</p>

        <dl class=switch><dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-29>current target element</a> is a text field (e.g. <code id=drag-and-drop-processing-model:the-textarea-element-3><a href=forms.html#the-textarea-element>textarea</a></code>,
         or an <code id=drag-and-drop-processing-model:the-input-element-3><a href=forms.html#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type-3><a href=forms.html#attr-input-type>type</a></code> attribute
         is in the <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-3">Text</a> state) or an <a id=drag-and-drop-processing-model:editing-host-3 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing
         host</a> or <a id=drag-and-drop-processing-model:editable-3 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element, and the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-8>drag data store item
         list</a> has an item with <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-8>the drag data item type string</a>
         "<code id=drag-and-drop-processing-model:text/plain-4><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-7>the drag data item kind</a> <i>Plain Unicode
         string</i><dd><p>Insert the actual data of the first item in the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-9>drag data store item
         list</a> to have <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-9>a drag data item type
         string</a> of "<code id=drag-and-drop-processing-model:text/plain-5><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-8>a drag
         data item kind</a> that is <i>Plain Unicode string</i> into the text field or
         <a id=drag-and-drop-processing-model:editing-host-4 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or <a id=drag-and-drop-processing-model:editable-4 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element in a manner consistent with
         platform-specific conventions (e.g. inserting it at the current mouse cursor position, or
         inserting it at the end of the field).<dt>そうでなければ<dd><p>Reset the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-12>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-8><a href=#concept-current-drag-operation-none>none</a></code>".</dl>

       </li></ol>

     </li><li>

      <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-11>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragend><a href=#event-dnd-dragend>dragend</a></code> at the
      <a href=#source-node id=drag-and-drop-processing-model:source-node-10>source node</a>.</p>

     </li><li>

      <p>Run the appropriate steps from the following list as the default action of the <code id=drag-and-drop-processing-model:event-dnd-dragend-2><a href=#event-dnd-dragend>dragend</a></code> event:</p>

      <dl class=switch><dt>If <var>dropped</var> is true, the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-30>current target element</a> is a <i>text
       field</i> (see below), the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-13>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-4><a href=#concept-current-drag-operation-move>move</a></code>", and the source of the
       drag-and-drop operation is a selection in the DOM that is entirely contained within an
       <a id=drag-and-drop-processing-model:editing-host-5 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a><dd><p><a id=drag-and-drop-processing-model:delete-the-selection href=https://w3c.github.io/editing/execCommand.html#delete-the-selection data-x-internal=delete-the-selection>Delete the selection</a>.<dt>If <var>dropped</var> is true, the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-31>current target element</a> is a <i>text
       field</i> (see below), the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-14>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-5><a href=#concept-current-drag-operation-move>move</a></code>", and the source of the
       drag-and-drop operation is a selection in a text field<dd><p>The user agent should delete the dragged selection from the relevant text
       field.<dt>If <var>dropped</var> is false or if the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-15>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-9><a href=#concept-current-drag-operation-none>none</a></code>"<dd><p>The drag was canceled. If the platform conventions dictate that this be represented to
       the user (e.g. by animating the dragged selection going back to the source of the
       drag-and-drop operation), then do so.<dt>そうでなければ<dd><p>The event has no default action.</dl>

      <p>For the purposes of this step, a <i>text field</i> is a <code id=drag-and-drop-processing-model:the-textarea-element-4><a href=forms.html#the-textarea-element>textarea</a></code> element or an
      <code id=drag-and-drop-processing-model:the-input-element-4><a href=forms.html#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type-4><a href=forms.html#attr-input-type>type</a></code> attribute is in
      one of the
      <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-4">Text</a>,
      <a href="forms.html#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-5">Search</a>,
      <a href="forms.html#telephone-state-(type=tel)" id="drag-and-drop-processing-model:telephone-state-(type=tel)">Tel</a>,
      <a href="forms.html#url-state-(type=url)" id="drag-and-drop-processing-model:url-state-(type=url)">URL</a>,
      <a href="forms.html#e-mail-state-(type=email)" id="drag-and-drop-processing-model:e-mail-state-(type=email)">E-mail</a>,
      <a href="forms.html#password-state-(type=password)" id="drag-and-drop-processing-model:password-state-(type=password)">Password</a>, or
      <a href="forms.html#number-state-(type=number)" id="drag-and-drop-processing-model:number-state-(type=number)">Number</a>
      states.</p>


     </li></ol>

   </li></ol>

  <p class=note>User agents are encouraged to consider how to react to drags near the edge of
  scrollable regions. For example, if a user drags a link to the bottom of the <a id=drag-and-drop-processing-model:viewport href=https://momdo.github.io/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>
  on a long page, it might make sense to scroll the page so that the user can drop the link lower on
  the page.</p>

  <p class=note>This model is independent of which <code id=drag-and-drop-processing-model:document-3><a href=dom.html#document>Document</a></code> object the nodes involved
  are from; the events are fired as described above and the rest of the processing model runs as
  described above, irrespective of how many documents are involved in the operation.</p>

  


  <h4 id=dndevents>6.7.6 イベントの概要</h4>

  <p><i>この節は非規範的である。</i></p>

  <p>次のイベントは、ドラッグアンドドロップモデルに関与する。</p>

  <table><thead><tr><th> イベント名 </th><th> ターゲット </th><th> 取消可能か？ </th><th> <a href=#drag-data-store-mode id=dndevents:drag-data-store-mode>ドラッグデータストアモード</a> </th><th> <code id=dndevents:dom-datatransfer-dropeffect><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> </th><th> デフォルトの動作 <tbody></th></tr><tr><td><dfn id=event-dnd-dragstart><code>dragstart</code></dfn></td><td><a href=#source-node id=dndevents:source-node>ソースノード</a></td><td>✓取消可能</td><td><a href=#concept-dnd-rw id=dndevents:concept-dnd-rw>読み書きモード</a>
     
     </td><td>"<code id=dndevents:dom-datatransfer-dropeffect-none><a href=#dom-datatransfer-dropeffect-none>none</a></code>"</td><td>ドラッグアンドドロップ操作を開始する</td></tr><tr><td><dfn id=event-dnd-drag><code>drag</code></dfn></td><td><a href=#source-node id=dndevents:source-node-2>ソースノード</a></td><td>✓取消可能</td><td><a href=#concept-dnd-p id=dndevents:concept-dnd-p>保護モード</a>
     
     </td><td>"<code id=dndevents:dom-datatransfer-dropeffect-none-2><a href=#dom-datatransfer-dropeffect-none>none</a></code>"</td><td>ドラッグアンドドロップ操作を続行する</td></tr><tr><td><dfn id=event-dnd-dragenter><code>dragenter</code></dfn></td><td><a href=#immediate-user-selection id=dndevents:immediate-user-selection>イミディエイトユーザーセレクション</a>または<a id=dndevents:the-body-element-2 href=dom.html#the-body-element-2>body要素</a></td><td>✓取消可能</td><td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-2>保護モード</a>
     
     </td><td><a href=#dropEffect-initialisation><code>effectAllowed</code>値をベースにする</a></td><td>潜在的な<a href=#current-target-element id=dndevents:current-target-element>ターゲット要素</a>として<a href=#immediate-user-selection id=dndevents:immediate-user-selection-2>即時のユーザーの選択</a>を拒絶する</td></tr><tr><td><dfn id=event-dnd-dragexit><code>dragexit</code></dfn></td><td><a href=#current-target-element id=dndevents:current-target-element-2>前のターゲット要素</a></td><td>—</td><td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-3>保護モード</a>
     
     </td><td>"<code id=dndevents:dom-datatransfer-dropeffect-none-3><a href=#dom-datatransfer-dropeffect-none>none</a></code>"</td><td>なし</td></tr><tr><td><dfn id=event-dnd-dragleave><code>dragleave</code></dfn></td><td><a href=#current-target-element id=dndevents:current-target-element-3>前のターゲット要素</a></td><td>—</td><td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-4>保護モード</a>
     
     </td><td>"<code id=dndevents:dom-datatransfer-dropeffect-none-4><a href=#dom-datatransfer-dropeffect-none>none</a></code>"</td><td>なし</td></tr><tr><td><dfn id=event-dnd-dragover><code>dragover</code></dfn></td><td><a href=#current-target-element id=dndevents:current-target-element-4>現在のターゲット要素</a></td><td>✓取消可能</td><td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-5>保護モード</a>
     
     </td><td><a href=#dropEffect-initialisation><code>effectAllowed</code>値をベースにする</a></td><td>"none"<a href=#current-drag-operation id=dndevents:current-drag-operation>現在のドラッグ操作</a>リセットする</td></tr><tr><td><dfn id=event-dnd-drop><code>drop</code></dfn></td><td><a href=#current-target-element id=dndevents:current-target-element-5>現在のターゲット要素</a></td><td>✓取消可能</td><td><a href=#concept-dnd-ro id=dndevents:concept-dnd-ro>読み取り専用モード</a>
     
     </td><td><a href=#current-drag-operation id=dndevents:current-drag-operation-2>現在のドラッグ操作</a></td><td>変化する</td></tr><tr><td><dfn id=event-dnd-dragend><code>dragend</code></dfn></td><td><a href=#source-node id=dndevents:source-node-3>ソースノード</a></td><td>—</td><td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-6>保護モード</a>
     
     </td><td><a href=#current-drag-operation id=dndevents:current-drag-operation-3>現在のドラッグ操作</a></td><td>変化する</td></tr></table>

  <p>Not shown in the above table: all these events bubble, are composed, and the <code id=dndevents:dom-datatransfer-effectallowed><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> attribute always has the value it had
  after the <code id=dndevents:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code> event, defaulting to "<code id=dndevents:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>" in the <code id=dndevents:event-dnd-dragstart-2><a href=#event-dnd-dragstart>dragstart</a></code> event.</p>



  <h4 id=the-draggable-attribute>6.7.7 <dfn><code>draggable</code></dfn>属性</h4><div class=status><input onclick=toggleStatus(this) value=⋰ type=button><p class=bugs><strong>Spec bugs:</strong> <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=26024" title="Drag and drop &lt;img&gt; should give the rendered image's URL">26024</a></div>

  <p>すべての<a id=the-draggable-attribute:html-elements href=infrastructure.html#html-elements>HTML要素</a>は<code id=the-draggable-attribute:the-draggable-attribute><a href=#the-draggable-attribute>draggable</a></code>コンテンツ属性設定を持ってもよい。<code id=the-draggable-attribute:the-draggable-attribute-2><a href=#the-draggable-attribute>draggable</a></code>属性は、<a id=the-draggable-attribute:enumerated-attribute href=infrastructure.html#enumerated-attribute>列挙属性</a>である。それは3つの状態を持つ。1番目の状態は<i>true</i>であり、それはキーワード<code>true</code>を持つ。2番目の状態は<i>false</i>であり、それはキーワード<code>false</code>を持つ。3番目の状態は<i>auto</i>である。それは、キーワードを持たない、<i id=the-draggable-attribute:missing-value-default><a href=infrastructure.html#missing-value-default>欠損値がデフォルト</a></i>である。</p>

  <p><i>true</i>状態は要素がドラッグ可能であることを意味し、<i>false</i>状態はそうでないことを意味する。<i>auto</i>状態はユーザーエージェントのデフォルト動作を使用する。</p>

  <p><code id=the-draggable-attribute:the-draggable-attribute-3><a href=#the-draggable-attribute>draggable</a></code>属性を持つ要素はまた、非視覚的な相互作用の目的のために要素を名付ける<code id=the-draggable-attribute:attr-title><a href=dom.html#attr-title>title</a></code>属性を持つべきである。 </p>

  <dl class=domintro><dt><var>element</var> . <code id=the-draggable-attribute:dom-draggable><a href=#dom-draggable>draggable</a></code> [ = <var>value</var> ]<dd>

    <p>要素がドラッグ可能である場合にtrueを返す。そうでなければfalseを返す。</p>

    <p>デフォルトを上書きし<code id=the-draggable-attribute:the-draggable-attribute-4><a href=#the-draggable-attribute>draggable</a></code>コンテンツの属性を設定するための、設定が可能である。</p>

   </dl>

  

  <p>The <dfn id=dom-draggable><code>draggable</code></dfn> IDL attribute, whose value depends
  on the content attribute's in the way described below, controls whether or not the element is
  draggable. Generally, only text selections are draggable, but elements whose <code id=the-draggable-attribute:dom-draggable-2><a href=#dom-draggable>draggable</a></code> IDL attribute is true become draggable as well.</p>

  <p>If an element's <code id=the-draggable-attribute:the-draggable-attribute-5><a href=#the-draggable-attribute>draggable</a></code> content attribute has the state
  <i>true</i>, the <code id=the-draggable-attribute:dom-draggable-3><a href=#dom-draggable>draggable</a></code> IDL attribute must return true.</p>

  <p>Otherwise, if the element's <code id=the-draggable-attribute:the-draggable-attribute-6><a href=#the-draggable-attribute>draggable</a></code> content attribute has
  the state <i>false</i>, the <code id=the-draggable-attribute:dom-draggable-4><a href=#dom-draggable>draggable</a></code> IDL attribute must return
  false.</p>

  <p>Otherwise, the element's <code id=the-draggable-attribute:the-draggable-attribute-7><a href=#the-draggable-attribute>draggable</a></code> content attribute has
  the state <i>auto</i>. If the element is an <code id=the-draggable-attribute:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element, an <code id=the-draggable-attribute:the-object-element><a href=embedded-content.html#the-object-element>object</a></code>
  element that <a id=the-draggable-attribute:represents href=dom.html#represents>represents</a> an image, or an <code id=the-draggable-attribute:the-a-element><a href=semantics.html#the-a-element>a</a></code> element with an <code id=the-draggable-attribute:attr-hyperlink-href><a href=semantics.html#attr-hyperlink-href>href</a></code> content attribute, the <code id=the-draggable-attribute:dom-draggable-5><a href=#dom-draggable>draggable</a></code> IDL attribute must return true; otherwise, the <code id=the-draggable-attribute:dom-draggable-6><a href=#dom-draggable>draggable</a></code> IDL attribute must return false.</p>

  <p>If the <code id=the-draggable-attribute:dom-draggable-7><a href=#dom-draggable>draggable</a></code> IDL attribute is set to the value false,
  the <code id=the-draggable-attribute:the-draggable-attribute-8><a href=#the-draggable-attribute>draggable</a></code> content attribute must be set to the literal
  value "<code>false</code>". If the <code id=the-draggable-attribute:dom-draggable-8><a href=#dom-draggable>draggable</a></code> IDL
  attribute is set to the value true, the <code id=the-draggable-attribute:the-draggable-attribute-9><a href=#the-draggable-attribute>draggable</a></code> content
  attribute must be set to the literal value "<code>true</code>".</p>

  


  <h4 id=the-dropzone-attribute>6.7.8 <dfn><code>dropzone</code></dfn>属性</h4>

  <p>すべての<a id=the-dropzone-attribute:html-elements href=infrastructure.html#html-elements>HTML要素</a>は、<code id=the-dropzone-attribute:the-dropzone-attribute><a href=#the-dropzone-attribute>dropzone</a></code>コンテンツ属性設定をもってもよい。指定された場合、その値は<a id=the-dropzone-attribute:ascii-case-insensitive href=infrastructure.html#ascii-case-insensitive>ASCII大文字・小文字不区別</a>で<a id=the-dropzone-attribute:unordered-set-of-unique-space-separated-tokens href=infrastructure.html#unordered-set-of-unique-space-separated-tokens>一意なスペース区切りトークンの順不同の集合</a>でなければならない。許可される値は次のとおり：</p>

  <dl><dt><dfn id=attr-dropzone-copy><code>copy</code></dfn><dd><p>要素で受け入れられるアイテムのドロップが、ドラッグしたデータのコピーになることを示す。</p>


   <dt><dfn id=attr-dropzone-move><code>move</code></dfn><dd><p>要素で受け入れられるアイテムのドロップが、新しい場所に移動されてドラッグされたデータになることを示す。</p>


   <dt><dfn id=attr-dropzone-link><code>link</code></dfn><dd><p>要素で受け入れられるアイテムのドロップが、元のデータへのリンクになることを示す。</p>


   <dt><a id=the-dropzone-attribute:ascii-case-insensitive-2 href=infrastructure.html#ascii-case-insensitive>大文字・小文字不区別</a>で文字列"<code>string:</code>"にマッチするもので始まる、8文字以上を持つ任意のキーワード。<dd><p><a href=#the-drag-data-item-kind id=the-dropzone-attribute:the-drag-data-item-kind>ドラッグデータ項目の種類</a><i>プレーンUnicode文字列</i>および<a href=#the-drag-data-item-type-string id=the-dropzone-attribute:the-drag-data-item-type-string>ドラッグデータ項目の種類の文字列</a>をもつ項目が受け入れられるキーワードの残りの部分と一致する値に設定することを示す。<dt><a id=the-dropzone-attribute:ascii-case-insensitive-3 href=infrastructure.html#ascii-case-insensitive>大文字・小文字不区別</a>で文字列"<code>file:</code>"にマッチするもので始まる、6文字以上を持つ任意のキーワード。<dd><p><a href=#the-drag-data-item-kind id=the-dropzone-attribute:the-drag-data-item-kind-2>ドラッグデータ項目の種類</a>の<i>File</i>および<a href=#the-drag-data-item-type-string id=the-dropzone-attribute:the-drag-data-item-type-string-2>ドラッグデータ項目の種類の文字列</a>をもつ項目が、受け入れられるキーワードの残りの部分と一致する値に設定することを示す。</dl>

  <p><code id=the-dropzone-attribute:the-dropzone-attribute-2><a href=#the-dropzone-attribute>dropzone</a></code>コンテンツ属性の値は、指定された3つのフィードバック値のいずれか（<code id=the-dropzone-attribute:attr-dropzone-copy><a href=#attr-dropzone-copy>copy</a></code>、<code id=the-dropzone-attribute:attr-dropzone-move><a href=#attr-dropzone-move>move</a></code>、および<code id=the-dropzone-attribute:attr-dropzone-link><a href=#attr-dropzone-link>link</a></code>）より多くを持ってはならない。何も指定されない場合、<code id=the-dropzone-attribute:attr-dropzone-copy-2><a href=#attr-dropzone-copy>copy</a></code>値が暗黙的に指定される。</p>

  <p><code id=the-dropzone-attribute:the-dropzone-attribute-3><a href=#the-dropzone-attribute>dropzone</a></code>属性を持つ要素はまた、非視覚的な相互作用の目的のために要素を名付ける<code id=the-dropzone-attribute:attr-title><a href=dom.html#attr-title>title</a></code>属性を持つべきである。 </p>

  

  <p>A <code id=the-dropzone-attribute:the-dropzone-attribute-4><a href=#the-dropzone-attribute>dropzone</a></code> attribute <dfn id=concept-dropzone-match>matches a drag data store</dfn> if the <a href=#dropzone-processing-steps id=the-dropzone-attribute:dropzone-processing-steps><code>dropzone</code> processing steps</a> result in a match.</p>

  <p>A <code id=the-dropzone-attribute:the-dropzone-attribute-5><a href=#the-dropzone-attribute>dropzone</a></code> attribute <dfn id=concept-dropzone-operation>specifies an operation</dfn> if the <a href=#dropzone-processing-steps id=the-dropzone-attribute:dropzone-processing-steps-2><code>dropzone</code> processing steps</a> result in a specified operation. The
  specified operation is as given by those steps.</p>

  <p>The <dfn id=dropzone-processing-steps><code>dropzone</code> processing steps</dfn> are as follows.
  They either result in a match or not, and separate from this result either in a specified
  operation or not, as defined below.</p>

  <ol><li><p>Let <var>value</var> be the value of the <code id=the-dropzone-attribute:the-dropzone-attribute-6><a href=#the-dropzone-attribute>dropzone</a></code> attribute.</li><li><p>Let <var>keywords</var> be the result of <a href=infrastructure.html#split-a-string-on-spaces id=the-dropzone-attribute:split-a-string-on-spaces>splitting <var>value</var> on spaces</a>.</li><li><p>Let <var>matched</var> be false.</li><li><p>Let <var>operation</var> be unspecified.</li><li>

    <p>For each value in <var>keywords</var>, if any, in the order that they were found in
    <var>value</var>, run the following steps.</p>

    <ol><li><p>Let <var>keyword</var> be the keyword.</li><li>

      <p>If <var>keyword</var> is one of "<code id=the-dropzone-attribute:attr-dropzone-copy-3><a href=#attr-dropzone-copy>copy</a></code>",
      "<code id=the-dropzone-attribute:attr-dropzone-move-2><a href=#attr-dropzone-move>move</a></code>", or "<code id=the-dropzone-attribute:attr-dropzone-link-2><a href=#attr-dropzone-link>link</a></code>", then: run the following substeps:</p>

      <ol><li><p>If <var>operation</var> is still unspecified, then let <var>operation</var> be the string given by <var>keyword</var>.</li><li><p>Skip to the step labeled <i>end of keyword</i> below.</li></ol>

     </li><li><p>If <var>keyword</var> does not contain a U+003A COLON character (:), or if the
     first such character in <var>keyword</var> is either the first character or the last
     character in the string, then skip to the step labeled <i>end of keyword</i> below.</li><li><p>Let <var>kind code</var> be the substring of <var>keyword</var> from
     the first character in the string to the last character in the string that is before the first
     U+003A COLON character (:) in the string, <a id=the-dropzone-attribute:converted-to-ascii-lowercase href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII lowercase</a>.</p>

     </li><li>

      <p>Jump to the appropriate step from the list below, based on the value of <var>kind
      code</var>:</p>

      <dl class=switch><dt>If <var>kind code</var> is the string "<code>string</code>"<dd>

        <p>Let <var>kind</var> be <i>Plain Unicode string</i>.</p>

       <dt>If <var>kind code</var> is the string "<code>file</code>"<dd>

        <p>Let <var>kind</var> be <i>File</i>.</p>

       <dt>そうでなければ<dd>

        <p>Skip to the step labeled <i>end of keyword</i> below.</p>

       </dl>

     </li><li><p>Let <var>type</var> be the substring of <var>keyword</var> from the
     first character after the first U+003A COLON character (:) in the string, to the last character
     in the string, <a id=the-dropzone-attribute:converted-to-ascii-lowercase-2 href=infrastructure.html#converted-to-ascii-lowercase>converted to ASCII lowercase</a>.</li><li><p>If there exist any items in the <a href=#drag-data-store-item-list id=the-dropzone-attribute:drag-data-store-item-list>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-dropzone-attribute:the-drag-data-item-kind-3>drag data item kind</a> is  the
     kind given in <var>kind</var> and
     whose <a href=#the-drag-data-item-type-string id=the-dropzone-attribute:the-drag-data-item-type-string-3>drag data item type string</a> is <var>type</var>, then let <var>matched</var> be true.</li><li><p><i>End of keyword</i>: Go on to the next keyword, if any, or the next step in the
     overall algorithm, if there are no more.</li></ol>

   </li><li>

    <p>The algorithm results in a match if <var>matched</var> is true, and does not
    otherwise.</p>

    <p>The algorithm results in a specified operation if <var>operation</var> is not
    unspecified. The specified operation, if one is specified, is the one given by <var>operation</var>.</p>

   </li></ol>

  <p>The <dfn id=dom-dropzone><code>dropzone</code></dfn> IDL attribute must
  <a id=the-dropzone-attribute:reflect href=infrastructure.html#reflect>reflect</a> the content attribute of the same name.</p>

  <p>The <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-supported-tokens id=the-dropzone-attribute:concept-supported-tokens data-x-internal=concept-supported-tokens>supported tokens</a> for
  <code id=the-dropzone-attribute:the-dropzone-attribute-7><a href=#the-dropzone-attribute>dropzone</a></code> are the allowed values defined for the
  <code id=the-dropzone-attribute:the-dropzone-attribute-8><a href=#the-dropzone-attribute>dropzone</a></code> attribute that are supported by the user agent.</p>

  

  <div class=example>

   <p>この例において、<code id=the-dropzone-attribute:the-div-element><a href=semantics.html#the-div-element>div</a></code>要素は<code id=the-dropzone-attribute:the-dropzone-attribute-9><a href=#the-dropzone-attribute>dropzone</a></code>属性を使用する画像ファイルに対してドロップターゲットとなる。ターゲットにドロップされた画像が表示される。</p>

   <pre>&lt;div dropzone="copy file:image/png file:image/gif file:image/jpeg" ondrop="receive(event, this)"&gt;
 &lt;p&gt;Drop an image here to have it displayed.&lt;/p&gt;
&lt;/div&gt;
&lt;script&gt;
 function receive(event, element) {
   var data = event.dataTransfer.items;
   for (var i = 0; i &lt; data.length; i += 1) {
     if ((data[i].kind == 'file') &amp;&amp; (data[i].type.match('^image/'))) {
       var img = new Image();
       img.src = window.createObjectURL(data[i].getAsFile());
       element.appendChild(img);
     }
   }
 }
&lt;/script&gt;</pre>

  </div>






  

  <h4 id=security-risks-in-the-drag-and-drop-model>6.7.9 Security risks in the drag-and-drop model</h4>

  <p>User agents must not make the data added to the <code id=security-risks-in-the-drag-and-drop-model:datatransfer><a href=#datatransfer>DataTransfer</a></code> object during the
  <code id=security-risks-in-the-drag-and-drop-model:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code> event available to scripts until the <code id=security-risks-in-the-drag-and-drop-model:event-dnd-drop><a href=#event-dnd-drop>drop</a></code> event, because otherwise, if a user were to drag sensitive
  information from one document to a second document, crossing a hostile third document in the
  process, the hostile document could intercept the data.</p>

  <p>For the same reason, user agents must consider a drop to be successful only if the user
  specifically ended the drag operation — if any scripts end the drag operation, it must be
  considered unsuccessful (canceled) and the <code id=security-risks-in-the-drag-and-drop-model:event-dnd-drop-2><a href=#event-dnd-drop>drop</a></code> event must not be
  fired.</p>

  <p>User agents should take care to not start drag-and-drop operations in response to script
  actions. For example, in a mouse-and-window environment, if a script moves a window while the user
  has their mouse button depressed, the UA would not consider that to start a drag. This is important
  because otherwise UAs could cause data to be dragged from sensitive sources and dropped into
  hostile documents without the user's consent.</p>

  <p>User agents should filter potentially active (scripted) content (e.g. HTML) when it is dragged
  and when it is dropped, using a safelist of known-safe features. Similarly, <a href=https://triple-underscore.github.io/URL-ja.html#syntax-url-relative id=security-risks-in-the-drag-and-drop-model:relative-url data-x-internal=relative-url>relative URLs</a> should be turned into absolute URLs to avoid references changing in
  unexpected ways. This specification does not specify how this is performed.</p>

  <div class=example>

   <p>Consider a hostile page providing some content and getting the user to select and drag and
   drop (or indeed, copy and paste) that content to a victim page's <code id=security-risks-in-the-drag-and-drop-model:attr-contenteditable><a href=#attr-contenteditable>contenteditable</a></code> region. If the browser does not ensure that
   only safe content is dragged, potentially unsafe content such as scripts and event handlers in
   the selection, once dropped (or pasted) into the victim site, get the privileges of the victim
   site. This would thus enable a cross-site scripting attack.</p>

  </div>

  




  <nav><a href=microdata.html>← 5 Microdata</a> — <a href=index.html>目次</a> — <a href=browsers.html>7 ウェブページの読み込み →</a></nav>
</body></html>